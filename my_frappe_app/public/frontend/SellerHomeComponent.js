var ut=Object.defineProperty;var Qe=Object.getOwnPropertySymbols;var xt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Je=(m,H,k)=>H in m?ut(m,H,{enumerable:!0,configurable:!0,writable:!0,value:k}):m[H]=k,Fe=(m,H)=>{for(var k in H||(H={}))xt.call(H,k)&&Je(m,k,H[k]);if(Qe)for(var k of Qe(H))pt.call(H,k)&&Je(m,k,H[k]);return m};var fe=(m,H,k)=>new Promise((A,N)=>{var O=u=>{try{o(k.next(u))}catch(h){N(h)}},w=u=>{try{o(k.throw(u))}catch(h){N(h)}},o=u=>u.done?A(u.value):Promise.resolve(u.value).then(O,w);o((k=k.apply(m,H)).next())});import{c as te,d as Ce,o as t,a,b as e,n as $,t as l,e as d,u as n,C as Ne,f as mt,_ as He,g as b,F as U,r as E,h as T,w as q,i as ee,j as de,k as P,l as Ue,m as Re,p as R,q as le,s as gt,v as ce,x as pe,y as st,U as at,z as I,M as bt,A as Se,B as je,X as _e,D as ft,E as We,T as Pe,G as we,H as ye,I as Xe,S as Ve,J as yt}from"./index.js";import{N as De,C as Me,T as Oe,P as Ye,a as lt,S as ze,_ as nt,b as $e,F as ot,D as rt,R as se,c as ue,d as Ie,e as vt,f as Ke,g as ht}from"./truck.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=te("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=te("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=te("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=te("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=te("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=te("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=te("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=te("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=te("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=te("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=te("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=te("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=te("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=te("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=te("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=te("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=te("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=te("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=te("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),St={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3 md:gap-4"},Dt={class:"min-w-0"},Ft={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-green-100 shadow-sm flex items-center justify-between"},jt={class:"min-w-0"},Pt={class:"text-2xl sm:text-3xl font-black text-gray-900"},Tt={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-green-50 flex items-center justify-center text-green-600 flex-shrink-0 ml-2"},Ot={class:"min-w-0"},At={class:"min-w-0"},Nt={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-emerald-100 shadow-sm flex items-center justify-between col-span-2 sm:col-span-1"},It={class:"min-w-0"},Lt={class:"text-2xl sm:text-3xl font-black text-gray-900"},Ut={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-600 flex-shrink-0 ml-2"},Rt=Ce({__name:"SellerStatsCards",props:{stats:{},activeFilter:{}},emits:["update:activeFilter"],setup(m,{emit:H}){const k=m,A=H,N=O=>{A("update:activeFilter",k.activeFilter===O?"all":O)};return(O,w)=>(t(),a("div",St,[e("button",{onClick:w[0]||(w[0]=o=>N("subscription_pending")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="subscription_pending"?"bg-amber-500 border-amber-500":"bg-white border-amber-100 hover:border-amber-300"])},[e("div",Dt,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="subscription_pending"?"text-amber-100":"text-amber-400"])}," Sub Pending ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",m.activeFilter==="subscription_pending"?"text-white":"text-gray-900"])},l(m.stats.subPending),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="subscription_pending"?"bg-amber-400 text-white":"bg-amber-50 text-amber-500 hover:bg-amber-500 hover:text-white"])},[d(n(De),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",Ft,[e("div",jt,[w[3]||(w[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1 truncate"}," Sub Active ",-1)),e("p",Pt,l(m.stats.subActive),1)]),e("div",Tt,[d(n(Ne),{class:"w-4 h-4 sm:w-5 sm:h-5"})])]),e("button",{onClick:w[1]||(w[1]=o=>N("normal")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="normal"?"bg-orange-500 border-orange-500":"bg-white border-orange-100 hover:border-orange-300"])},[e("div",Ot,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="normal"?"text-orange-100":"text-orange-400"])}," To Accept ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",m.activeFilter==="normal"?"text-white":"text-gray-900"])},l(m.stats.orderPending),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="normal"?"bg-orange-400 text-white":"bg-orange-50 text-orange-500 hover:bg-orange-500 hover:text-white"])},[d(n(Me),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("button",{onClick:w[2]||(w[2]=o=>N("daily")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="daily"?"bg-blue-600 border-blue-600":"bg-white border-blue-100 hover:border-blue-300"])},[e("div",At,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="daily"?"text-blue-200":"text-blue-400"])}," Daily Orders ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",m.activeFilter==="daily"?"text-white":"text-gray-900"])},l(m.stats.toDeliver),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="daily"?"bg-blue-500 text-white":"bg-blue-50 text-blue-500 hover:bg-blue-600 hover:text-white"])},[d(n(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",Nt,[e("div",It,[w[4]||(w[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-emerald-500 uppercase tracking-widest mb-1 truncate"}," Completed ",-1)),e("p",Lt,l(m.stats.completed),1)]),e("div",Ut,[d(n(Ne),{class:"w-4 h-4 sm:w-5 sm:h-5"})])])]))}}),Mt={class:"w-full min-w-0"},Vt={class:"min-h-[300px] sm:min-h-[400px]"},zt={key:0,class:"flex flex-col items-center justify-center py-20 sm:py-32"},qt={key:1,class:"flex flex-col items-center justify-center py-20 sm:py-32 px-4 text-center"},Bt={key:2,class:"divide-y divide-gray-50"},Et={class:"flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2"},Ht={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},Wt={class:"min-w-0 flex-1"},Yt={class:"flex items-center gap-1.5 flex-wrap"},Gt={class:"font-black text-gray-900 font-mono text-xs sm:text-sm"},Qt={class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-amber-200"},Jt={class:"text-[10px] sm:text-xs text-gray-500 mt-0.5 flex flex-wrap gap-x-1"},Xt={class:"font-semibold text-gray-700 truncate max-w-[140px] sm:max-w-none"},Kt={class:"text-gray-400 text-[9px] sm:text-[10px]"},Zt={class:"text-[9px] sm:text-[10px] text-gray-400 mt-0.5 truncate"},es={class:"font-semibold text-gray-600"},ts={class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap"},ss={class:"flex items-center gap-1 bg-green-100 border border-green-200 rounded-lg px-2 py-1"},as=["onClick"],ls={key:0,class:"px-3 sm:px-5 pb-4 pt-0 border-t border-amber-100/80 bg-white/50 space-y-3"},ns={key:0,class:"mt-3 flex items-start gap-2 bg-amber-50 border border-amber-200 rounded-xl px-3 py-2.5"},os={class:"flex items-center justify-between px-3 sm:px-4 py-2 bg-white border-b border-gray-100"},rs={class:"text-[11px] sm:text-xs font-bold text-gray-800 truncate mr-2"},is={key:0,class:"text-[8px] sm:text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded font-bold flex-shrink-0"},ds={class:"p-2 sm:p-3 flex gap-1.5 flex-wrap"},cs={class:"text-[8px] sm:text-[9px] uppercase tracking-wide"},us={key:0,class:"text-xs sm:text-sm font-black leading-tight mt-0.5"},xs={key:1,class:"text-[9px] opacity-30 mt-0.5"},ps=["onClick"],ms={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},gs={class:"min-w-0 flex-1"},bs={class:"flex items-center gap-1.5 flex-wrap"},fs={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-blue-200"},ys={key:1,class:"inline-flex items-center gap-1 bg-gray-100 text-gray-500 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-gray-200"},vs={class:"text-[10px] sm:text-xs text-gray-400 mt-0.5 flex items-center gap-1 flex-wrap"},hs={key:0,class:"truncate max-w-[120px] sm:max-w-none"},_s={key:0,class:"text-[9px] sm:text-[10px] text-blue-400 font-mono mt-0.5 truncate"},ws={class:"font-black text-gray-800 font-mono text-xs sm:text-sm whitespace-nowrap"},ks={key:3,class:"text-[9px] sm:text-[10px] text-blue-500 font-semibold bg-blue-50 border border-blue-100 px-1.5 py-1 rounded-lg whitespace-nowrap"},$s=Ce({__name:"SalesOrder",props:{combinedRows:{},loading:{type:Boolean},activeFilter:{},expandedSubId:{},processingSubId:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["toggle-sub-expand","sub-action","open-order-detail","order-action","show-all"],setup(m,{emit:H}){const k=H,A=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],N={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},O={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(w,o)=>(t(),a("div",Mt,[o[21]||(o[21]=mt('<div class="flex flex-wrap gap-1.5 px-3 sm:px-5 pt-3 pb-2 overflow-x-auto [scrollbar-width:none] [&amp;::-webkit-scrollbar]:hidden"><div class="flex items-center gap-1.5 bg-amber-50 border border-amber-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-amber-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-amber-700 whitespace-nowrap">Subscription â€” Accept to start daily delivery</span></div><div class="flex items-center gap-1.5 bg-blue-50 border border-blue-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-blue-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-blue-700 whitespace-nowrap">Daily Auto-Order â€” DN auto-created</span></div><div class="flex items-center gap-1.5 bg-gray-50 border border-gray-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-gray-300 flex-shrink-0"></div><span class="text-[10px] font-semibold text-gray-500 whitespace-nowrap">Normal Order</span></div></div>',1)),e("div",Vt,[m.loading?(t(),a("div",zt,[d(n(He),{class:"w-7 h-7 sm:w-8 sm:h-8 mb-4 text-blue-600"}),o[2]||(o[2]=e("p",{class:"text-gray-400 font-medium text-sm animate-pulse"},"Loading...",-1))])):m.combinedRows.length===0?(t(),a("div",qt,[d(n(Ye),{class:"w-10 h-10 sm:w-12 sm:h-12 text-gray-200 mb-4"}),o[3]||(o[3]=e("p",{class:"text-gray-400 font-medium text-sm"},"Nothing to show",-1)),m.activeFilter!=="all"?(t(),a("button",{key:0,onClick:o[0]||(o[0]=u=>k("show-all")),class:"mt-3 text-sm text-blue-600 hover:underline"}," Show all ")):b("",!0)])):(t(),a("div",Bt,[(t(!0),a(U,null,E(m.combinedRows,u=>(t(),a(U,{key:u.row_type+"-"+u.name},[u.row_type==="subscription"?(t(),a("div",{key:0,class:$(["border-l-4 transition-all",u.status==="Accept Pending"?"border-l-amber-400 bg-amber-50/50":"border-l-green-400 bg-green-50/20"])},[e("div",Et,[e("div",Ht,[e("div",{class:$(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 mt-0.5 sm:mt-0",u.status==="Accept Pending"?"bg-amber-100 text-amber-600":"bg-green-100 text-green-600"])},[d(n(De),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2),e("div",Wt,[e("div",Yt,[e("span",Gt,l(u.name),1),e("span",Qt,[d(n(tt),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),o[4]||(o[4]=T(" Subscription Request ",-1))]),e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border",u.status==="Accept Pending"?"bg-amber-50 text-amber-600 border-amber-200":u.status==="Active"?"bg-green-50 text-green-600 border-green-200":"bg-gray-50 text-gray-500 border-gray-200"])},l(u.status),3)]),e("p",Jt,[o[5]||(o[5]=e("span",null,"Customer:",-1)),e("span",Xt,l(u.customer_name),1),o[6]||(o[6]=e("span",{class:"hidden sm:inline"},"Â·",-1)),e("span",Kt,l(u.formatted_start)+" â†’ "+l(u.formatted_end),1)]),e("p",Zt,[o[7]||(o[7]=T(" Primary: ",-1)),e("span",es,l(u.primary_item_name),1)])])]),e("div",ts,[u.status==="Accept Pending"?(t(),a(U,{key:0},[d(n(de),{variant:"solid",class:"!bg-green-600 hover:!bg-green-700 !text-white text-xs",size:"sm",loading:m.processingSubId===u.name,onClick:ee(h=>k("sub-action",u.name,"accept"),["stop"])},{prefix:q(()=>[d(n(Ne),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:q(()=>[o[8]||(o[8]=e("span",{class:"hidden sm:inline"},"Accept Plan",-1)),o[9]||(o[9]=e("span",{class:"sm:hidden"},"Accept",-1))]),_:1},8,["loading","onClick"]),d(n(de),{variant:"subtle",theme:"red",size:"sm",loading:m.processingSubId===u.name,class:"text-xs",onClick:ee(h=>k("sub-action",u.name,"reject"),["stop"])},{default:q(()=>[...o[10]||(o[10]=[T("Reject",-1)])]),_:1},8,["loading","onClick"])],64)):u.status==="Active"?(t(),a(U,{key:1},[e("div",ss,[d(n(Ee),{class:"w-3 h-3 text-green-600 flex-shrink-0"}),o[11]||(o[11]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-green-700"},"Auto-running",-1))]),d(n(de),{variant:"subtle",theme:"red",size:"sm",loading:m.processingSubId===u.name,class:"text-xs",onClick:ee(h=>k("sub-action",u.name,"reject"),["stop"])},{default:q(()=>[...o[12]||(o[12]=[e("span",{class:"hidden sm:inline"},"Cancel Plan",-1),e("span",{class:"sm:hidden"},"Cancel",-1)])]),_:1},8,["loading","onClick"])],64)):b("",!0),e("button",{onClick:h=>k("toggle-sub-expand",u.name),class:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all flex-shrink-0"},[m.expandedSubId===u.name?(t(),P(n(lt),{key:0,class:"w-4 h-4"})):(t(),P(n(Ue),{key:1,class:"w-4 h-4"}))],8,as)])]),m.expandedSubId===u.name?(t(),a("div",ls,[u.status==="Accept Pending"?(t(),a("div",ns,[d(n(tt),{class:"w-3.5 h-3.5 text-amber-500 mt-0.5 flex-shrink-0"}),o[13]||(o[13]=e("p",{class:"text-[10px] sm:text-xs text-amber-800"},[e("span",{class:"font-bold"},"Accept this plan"),T(" to activate daily delivery. From "),e("strong",null,"next day"),T(", system auto-generates Sales Orders + Delivery Notes. You only handle "),e("strong",null,"invoicing"),T(". ")],-1))])):b("",!0),(t(!0),a(U,null,E(u.schedule_items,h=>(t(),a("div",{key:h.item_code,class:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden"},[e("div",os,[e("span",rs,l(h.item_name),1),h.is_primary_item?(t(),a("span",is,"Primary")):b("",!0)]),e("div",ds,[(t(),a(U,null,E(A,v=>e("div",{key:v,class:$(["flex flex-col items-center px-2 sm:px-3 py-1.5 rounded-xl font-bold min-w-[34px] sm:min-w-[44px] text-center",(h[O[v]]||0)>0?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-400"])},[e("span",cs,l(N[v]),1),(h[O[v]]||0)>0?(t(),a("span",us,l(h[O[v]]),1)):(t(),a("span",xs,"â€”"))],2)),64))])]))),128))])):b("",!0)],2)):(t(),a("div",{key:1,class:$(["flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2 cursor-pointer group transition-all border-l-4",u.custom_subscription_refereance?"border-l-blue-300 bg-blue-50/20 hover:bg-blue-50/50 active:bg-blue-50/70":"border-l-transparent hover:bg-gray-50/70 active:bg-gray-100/50"]),onClick:h=>k("open-order-detail",u)},[e("div",ms,[e("div",{class:$(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 transition-colors mt-0.5 sm:mt-0",u.custom_subscription_refereance?"bg-blue-100 text-blue-600 group-hover:bg-blue-500 group-hover:text-white":"bg-gray-100 text-gray-500 group-hover:bg-blue-100 group-hover:text-blue-600"])},[u.custom_subscription_refereance?(t(),P(n(De),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),P(n(ze),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",gs,[e("div",bs,[e("span",{class:$(["font-bold font-mono text-xs sm:text-sm transition-colors",u.custom_subscription_refereance?"text-blue-700":"text-gray-900 group-hover:text-blue-600"])},l(u.name),3),u.custom_subscription_refereance?(t(),a("span",fs,[d(n(Ee),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),o[14]||(o[14]=e("span",{class:"hidden xs:inline"},"Daily Sub-Auto-Order",-1)),o[15]||(o[15]=e("span",{class:"xs:hidden"},"Sub",-1))])):(t(),a("span",ys,[d(n(ze),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),o[16]||(o[16]=e("span",{class:"hidden xs:inline"},"Normal Order",-1)),o[17]||(o[17]=e("span",{class:"xs:hidden"},"Normal",-1))])),d(n(nt),{theme:m.getStatusTheme(u.status),variant:"subtle",label:u.status,size:"sm"},null,8,["theme","label"])]),e("p",vs,[d(n($e),{class:"w-3 h-3 flex-shrink-0"}),e("span",null,l(u.transaction_date),1),u.customer_name?(t(),a("span",hs,"Â· "+l(u.customer_name),1)):b("",!0)]),u.custom_subscription_refereance?(t(),a("p",_s," ðŸ“‹ "+l(u.custom_subscription_refereance),1)):b("",!0)])]),e("div",{class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap",onClick:o[1]||(o[1]=ee(()=>{},["stop"]))},[e("span",ws,l(m.formatCurrency(u.grand_total,u.currency)),1),u.docstatus===0?(t(),P(n(de),{key:0,variant:"solid",theme:"blue",size:"sm",loading:m.processingId===u.name,onClick:h=>k("order-action",u.name,"accept"),class:"text-xs"},{default:q(()=>[...o[18]||(o[18]=[T("Accept",-1)])]),_:1},8,["loading","onClick"])):b("",!0),u.docstatus===1&&u.per_delivered<100&&!u.custom_subscription_refereance?(t(),P(n(de),{key:1,variant:"subtle",theme:"gray",size:"sm",loading:m.processingId===u.name,onClick:h=>k("order-action",u.name,"deliver"),class:"text-xs"},{prefix:q(()=>[d(n(Oe),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:q(()=>[o[19]||(o[19]=e("span",{class:"hidden sm:inline"},"Deliver",-1))]),_:1},8,["loading","onClick"])):b("",!0),u.per_delivered>=100&&u.per_billed<100?(t(),P(n(de),{key:2,variant:"subtle",theme:"gray",size:"sm",loading:m.processingId===u.name,onClick:h=>k("order-action",u.name,"invoice"),class:"text-xs"},{prefix:q(()=>[d(n(ot),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:q(()=>[o[20]||(o[20]=e("span",{class:"hidden sm:inline"},"Invoice",-1))]),_:1},8,["loading","onClick"])):b("",!0),u.custom_subscription_refereance&&u.docstatus===1&&u.per_delivered<100?(t(),a("span",ks," âš¡ Auto-Delivered ")):b("",!0),d(n(Re),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-300 ml-1 flex-shrink-0"})])],10,ps))],64))),128))]))])]))}}),Cs={class:"flex items-center justify-between w-full pr-6 sm:pr-8 gap-2 flex-wrap"},Ss={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Ds={class:"min-w-0"},Fs={class:"text-xs sm:text-sm text-gray-500 font-mono mt-1 truncate"},js={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},Ps={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[10px] sm:text-xs font-bold px-2 sm:px-3 py-1 rounded-full truncate max-w-[140px] sm:max-w-none"},Ts={class:"truncate"},Os={key:0,class:"flex flex-col items-center justify-center h-48 sm:h-80"},As={key:1,class:"py-4 sm:py-6 space-y-5 sm:space-y-8"},Ns={key:0,class:"flex items-start gap-2 sm:gap-3 bg-blue-50 border border-blue-200 rounded-xl sm:rounded-2xl p-3 sm:p-4"},Is={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-5"},Ls={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},Us={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},Rs={class:"min-w-0"},Ms={class:"font-bold text-sm sm:text-base truncate"},Vs={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},zs={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},qs={class:"font-bold text-sm sm:text-base"},Bs={class:"bg-blue-600 p-3 sm:p-5 rounded-xl sm:rounded-2xl text-white"},Es={class:"font-black text-xl sm:text-2xl"},Hs={class:"border border-gray-200 rounded-xl overflow-hidden"},Ws={class:"overflow-x-auto"},Ys={class:"w-full text-xs sm:text-sm min-w-[400px]"},Gs={class:"divide-y divide-gray-100"},Qs={class:"px-3 sm:px-5 py-3 sm:py-4 font-bold text-gray-900"},Js={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Xs={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Ks={class:"px-3 sm:px-5 py-3 sm:py-4 text-right font-bold tabular-nums"},Zs={class:"flex flex-col xs:flex-row justify-end gap-2 sm:gap-3 pt-4 sm:pt-6 border-t border-gray-100"},ea=Ce({__name:"SellerOrderDetailDialog",props:{modelValue:{type:Boolean},orderDetails:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["update:modelValue","order-action"],setup(m,{emit:H}){const k=m,A=H,N=R({get:()=>k.modelValue,set:O=>A("update:modelValue",O)});return(O,w)=>(t(),P(n(rt),{modelValue:N.value,"onUpdate:modelValue":w[3]||(w[3]=o=>N.value=o),options:{size:"4xl"}},{"body-title":q(()=>{var o,u,h,v;return[e("div",Cs,[e("div",Ss,[e("div",{class:$(["h-8 w-8 sm:h-10 sm:w-10 rounded-full flex items-center justify-center flex-shrink-0",(o=m.orderDetails)!=null&&o.custom_subscription_refereance?"bg-blue-50 text-blue-600":"bg-gray-50 text-gray-600"])},[(u=m.orderDetails)!=null&&u.custom_subscription_refereance?(t(),P(n(De),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),P(n(Ye),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",Ds,[w[4]||(w[4]=e("h3",{class:"text-base sm:text-xl font-black leading-none"},"Order Details",-1)),e("p",Fs,l((h=m.orderDetails)==null?void 0:h.name),1)])]),e("div",js,[(v=m.orderDetails)!=null&&v.custom_subscription_refereance?(t(),a("span",Ps,[d(n(De),{class:"w-3 h-3 flex-shrink-0"}),e("span",Ts,l(m.orderDetails.custom_subscription_refereance),1)])):b("",!0),m.orderDetails?(t(),P(n(nt),{key:1,theme:m.getStatusTheme(m.orderDetails.status),size:"lg",label:m.orderDetails.status},null,8,["theme","label"])):b("",!0)])])]}),"body-content":q(()=>[m.orderDetails?(t(),a("div",As,[m.orderDetails.custom_subscription_refereance&&m.orderDetails.docstatus===1?(t(),a("div",Ns,[d(n(Ee),{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 mt-0.5 flex-shrink-0"}),w[5]||(w[5]=e("p",{class:"text-[10px] sm:text-xs text-blue-700"},[e("span",{class:"font-bold"},"Daily Subscription Order."),T(" Auto-generated by cron. Delivery note created automatically. Only invoice needed manually. ")],-1))])):b("",!0),e("div",Is,[e("div",Ls,[e("div",Us,[d(n(Be),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",Rs,[w[6]||(w[6]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Customer",-1)),e("p",Ms,l(m.orderDetails.customer_name),1)])]),e("div",Vs,[e("div",zs,[d(n($e),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",null,[w[7]||(w[7]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Date",-1)),e("p",qs,l(m.orderDetails.transaction_date),1)])]),e("div",Bs,[w[8]||(w[8]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Grand Total",-1)),e("p",Es,l(m.formatCurrency(m.orderDetails.grand_total,m.orderDetails.currency)),1)])]),e("div",Hs,[e("div",Ws,[e("table",Ys,[w[9]||(w[9]=e("thead",{class:"bg-gray-50 text-[9px] sm:text-[10px] uppercase font-bold text-gray-500"},[e("tr",null,[e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-left"},"Item"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Qty"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Rate"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Amount")])],-1)),e("tbody",Gs,[(t(!0),a(U,null,E(m.orderDetails.items,o=>(t(),a("tr",{key:o.name},[e("td",Qs,l(o.item_name),1),e("td",Js,l(o.qty),1),e("td",Xs,l(m.formatCurrency(o.rate,m.orderDetails.currency)),1),e("td",Ks,l(m.formatCurrency(o.amount,m.orderDetails.currency)),1)]))),128))])])])]),e("div",Zs,[m.orderDetails.docstatus===0?(t(),P(n(de),{key:0,variant:"solid",theme:"blue",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:w[0]||(w[0]=o=>A("order-action",m.orderDetails.name,"accept"))},{default:q(()=>[...w[10]||(w[10]=[T("Accept Order",-1)])]),_:1},8,["loading"])):b("",!0),m.orderDetails.docstatus===1&&m.orderDetails.per_delivered<100&&!m.orderDetails.custom_subscription_refereance?(t(),P(n(de),{key:1,variant:"solid",theme:"gray",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:w[1]||(w[1]=o=>A("order-action",m.orderDetails.name,"deliver"))},{prefix:q(()=>[d(n(Oe),{class:"w-4 h-4"})]),default:q(()=>[w[11]||(w[11]=T(" Generate Delivery Note ",-1))]),_:1},8,["loading"])):b("",!0),m.orderDetails.per_delivered>=100&&m.orderDetails.per_billed<100?(t(),P(n(de),{key:2,variant:"solid",theme:"gray",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:w[2]||(w[2]=o=>A("order-action",m.orderDetails.name,"invoice"))},{prefix:q(()=>[d(n(ot),{class:"w-4 h-4"})]),default:q(()=>[w[12]||(w[12]=T(" Generate Invoice ",-1))]),_:1},8,["loading"])):b("",!0)])])):(t(),a("div",Os,[d(n(He),{class:"w-8 h-8 sm:w-10 sm:h-10 text-blue-500"})]))]),_:1},8,["modelValue"]))}}),ta={class:"space-y-4 sm:space-y-5"},sa={class:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4"},aa={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-gray-100 shadow-sm"},la={class:"text-2xl sm:text-3xl font-black text-gray-900"},na={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-green-100 shadow-sm"},oa={class:"text-2xl sm:text-3xl font-black text-gray-900"},ra={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-blue-100 shadow-sm"},ia={class:"text-2xl sm:text-3xl font-black text-gray-900"},da={class:"bg-blue-600 p-3 sm:p-4 rounded-xl sm:rounded-2xl shadow-sm"},ca={class:"text-xl sm:text-2xl font-black text-white"},ua={class:"flex flex-col sm:flex-row gap-2 sm:gap-3"},xa={class:"relative flex-1"},pa={class:"flex gap-2 sm:gap-3"},ma=["value"],ga={key:0,class:"flex justify-center py-16 sm:py-20"},ba={key:1,class:"bg-gray-50 rounded-2xl sm:rounded-3xl border-2 border-dashed border-gray-200 py-16 sm:py-24 text-center px-4"},fa={class:"text-xs sm:text-sm text-gray-400 mt-1"},ya={key:2,class:"space-y-2 sm:space-y-3"},va=["onClick"],ha={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},_a={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-lg sm:rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 text-white flex items-center justify-center font-black text-base sm:text-lg flex-shrink-0 shadow-sm"},wa={class:"min-w-0 flex-1"},ka={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},$a={class:"font-bold text-gray-900 text-xs sm:text-sm"},Ca={class:"font-mono text-[9px] sm:text-[10px] text-gray-400 hidden xs:inline"},Sa={key:0,class:"inline-flex items-center gap-1 bg-green-100 text-green-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-green-200"},Da={key:1,class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-amber-200"},Fa={class:"flex items-center gap-2 sm:gap-3 mt-0.5 flex-wrap"},ja={key:0,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Pa={class:"truncate max-w-[110px] sm:max-w-none"},Ta={key:1,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Oa={key:2,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Aa={class:"flex items-center gap-3 sm:gap-4 flex-shrink-0"},Na={class:"text-right hidden md:block"},Ia={class:"font-black text-gray-900"},La={class:"text-right hidden md:block"},Ua={class:"font-black text-gray-900 text-sm"},Ra={key:0,class:"border-t border-gray-100 px-3 sm:px-4 pb-4 sm:pb-5 pt-3 sm:pt-4 space-y-3 sm:space-y-4 bg-gray-50/30"},Ma={class:"flex gap-3 md:hidden"},Va={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},za={class:"font-black text-gray-900 text-sm sm:text-base"},qa={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},Ba={class:"font-black text-gray-900 text-xs sm:text-sm"},Ea={key:0},Ha={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},Wa={class:"space-y-2"},Ya={class:"flex flex-col xs:flex-row xs:items-center justify-between gap-1 mb-2"},Ga={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},Qa={class:"font-mono text-[10px] sm:text-xs font-bold text-gray-700"},Ja={class:"text-[9px] sm:text-[10px] text-gray-400 whitespace-nowrap"},Xa={class:"text-[9px] sm:text-[10px] text-gray-500 font-semibold mb-1"},Ka={class:"flex gap-1 flex-wrap"},Za={key:0,class:"opacity-80 text-[7px] sm:text-[8px]"},el={key:1,class:"text-center py-3 sm:py-4 text-[10px] sm:text-xs text-gray-400 bg-white rounded-lg sm:rounded-xl border border-dashed border-gray-200"},tl={key:2},sl={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},al={class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 overflow-hidden"},ll={class:"overflow-x-auto"},nl={class:"w-full text-xs min-w-[360px]"},ol={class:"divide-y divide-gray-50"},rl={class:"px-2.5 sm:px-3 py-2 font-mono font-bold text-gray-700 text-[10px] sm:text-xs"},il={key:0,class:"ml-1 text-[8px] bg-blue-100 text-blue-600 px-1 py-0.5 rounded font-bold"},dl={class:"px-2.5 sm:px-3 py-2 text-gray-500 text-[10px] sm:text-xs"},cl={class:"px-2.5 sm:px-3 py-2"},ul={class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-800 text-[10px] sm:text-xs tabular-nums"},xl=Ce({__name:"SellerCustomersTab",props:{seller:{}},setup(m){const H=m,k=I(""),A=I(null),N=I(""),O=le({url:"my_frappe_app.api.get_seller_customers",onSuccess(){}});gt(()=>{H.seller&&O.fetch({seller:H.seller})});const w=R(()=>{var V;return((V=O.data)==null?void 0:V.customers)||[]}),o=R(()=>{var V;return((V=O.data)==null?void 0:V.pincodes)||[]}),u=R(()=>{let V=w.value;if(N.value&&(V=V.filter(D=>D.pincode===N.value)),k.value.trim()){const D=k.value.toLowerCase();V=V.filter(F=>{var X,ae,Q,Y;return((X=F.customer_name)==null?void 0:X.toLowerCase().includes(D))||((ae=F.name)==null?void 0:ae.toLowerCase().includes(D))||((Q=F.email)==null?void 0:Q.toLowerCase().includes(D))||((Y=F.mobile)==null?void 0:Y.toLowerCase().includes(D))})}return V}),h=R(()=>{const V=w.value;return{total:V.length,withActiveSub:V.filter(D=>D.active_subs>0).length,totalOrders:V.reduce((D,F)=>D+(F.total_orders||0),0),totalRevenue:V.reduce((D,F)=>D+(F.total_revenue||0),0)}}),v=V=>{A.value=A.value===V?null:V},C=V=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(V),M={Active:"bg-green-100 text-green-700 border-green-200","Accept Pending":"bg-amber-100 text-amber-700 border-amber-200",Expired:"bg-gray-100 text-gray-500 border-gray-200",Cancelled:"bg-red-100 text-red-600 border-red-200"},K=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],B={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},Z={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(V,D)=>(t(),a("div",ta,[e("div",sa,[e("div",aa,[D[3]||(D[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Total Customers",-1)),e("p",la,l(h.value.total),1)]),e("div",na,[D[4]||(D[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1"},"With Active Plan",-1)),e("p",oa,l(h.value.withActiveSub),1)]),e("div",ra,[D[5]||(D[5]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-500 uppercase tracking-widest mb-1"},"Total Orders",-1)),e("p",ia,l(h.value.totalOrders),1)]),e("div",da,[D[6]||(D[6]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Total Revenue",-1)),e("p",ca,l(C(h.value.totalRevenue)),1)])]),e("div",ua,[e("div",xa,[d(n(Ge),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),ce(e("input",{"onUpdate:modelValue":D[0]||(D[0]=F=>k.value=F),type:"text",placeholder:"Search by name, email, mobile...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[pe,k.value]])]),e("div",pa,[ce(e("select",{"onUpdate:modelValue":D[1]||(D[1]=F=>N.value=F),class:"flex-1 sm:flex-none border border-gray-200 rounded-xl px-3 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"},[D[7]||(D[7]=e("option",{value:""},"All Pincodes",-1)),(t(!0),a(U,null,E(o.value,F=>(t(),a("option",{key:F,value:F},l(F),9,ma))),128))],512),[[st,N.value]]),d(n(de),{variant:"outline",loading:n(O).loading,class:"text-xs sm:text-sm flex-shrink-0",onClick:D[2]||(D[2]=F=>n(O).fetch({seller:H.seller}))},{prefix:q(()=>[d(n(se),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:q(()=>[D[8]||(D[8]=e("span",{class:"hidden sm:inline"},"Refresh",-1))]),_:1},8,["loading"])])]),n(O).loading?(t(),a("div",ga,[d(n(He),{class:"w-7 h-7 sm:w-8 sm:h-8 text-blue-600"})])):u.value.length===0?(t(),a("div",ba,[d(n(at),{class:"w-9 h-9 sm:w-10 sm:h-10 text-gray-300 mx-auto mb-3"}),D[9]||(D[9]=e("h3",{class:"text-sm sm:text-base font-bold text-gray-700"},"No Customers Found",-1)),e("p",fa,l(k.value||N.value?"Try different filters":"No customers in your area yet"),1)])):(t(),a("div",ya,[(t(!0),a(U,null,E(u.value,F=>{var X,ae,Q,Y;return t(),a("div",{key:F.name,class:"bg-white rounded-xl sm:rounded-2xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow"},[e("div",{class:"flex items-center justify-between p-3 sm:p-4 gap-2 sm:gap-3 cursor-pointer",onClick:z=>v(F.name)},[e("div",ha,[e("div",_a,l(((ae=(X=F.customer_name)==null?void 0:X[0])==null?void 0:ae.toUpperCase())||"?"),1),e("div",wa,[e("div",ka,[e("span",$a,l(F.customer_name),1),e("span",Ca,l(F.name),1),F.active_subs>0?(t(),a("span",Sa,[d(n(Ne),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),T(" "+l(F.active_subs)+" Active ",1)])):F.pending_subs>0?(t(),a("span",Da,[d(n(Me),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),T(" "+l(F.pending_subs)+" Pending ",1)])):b("",!0)]),e("div",Fa,[F.email?(t(),a("span",ja,[d(n(kt),{class:"w-3 h-3 flex-shrink-0"}),e("span",Pa,l(F.email),1)])):b("",!0),F.mobile?(t(),a("span",Ta,[d(n($t),{class:"w-3 h-3 flex-shrink-0"}),T(" "+l(F.mobile),1)])):b("",!0),F.pincode?(t(),a("span",Oa,[d(n(bt),{class:"w-3 h-3 flex-shrink-0"}),T(" "+l(F.pincode),1)])):b("",!0)])])]),e("div",Aa,[e("div",Na,[D[10]||(D[10]=e("p",{class:"text-xs text-gray-400 font-medium"},"Orders",-1)),e("p",Ia,l(F.total_orders||0),1)]),e("div",La,[D[11]||(D[11]=e("p",{class:"text-xs text-gray-400 font-medium"},"Revenue",-1)),e("p",Ua,l(C(F.total_revenue||0)),1)]),A.value===F.name?(t(),P(n(lt),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"})):(t(),P(n(Ue),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"}))])],8,va),A.value===F.name?(t(),a("div",Ra,[e("div",Ma,[e("div",Va,[D[12]||(D[12]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Orders",-1)),e("p",za,l(F.total_orders||0),1)]),e("div",qa,[D[13]||(D[13]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Revenue",-1)),e("p",Ba,l(C(F.total_revenue||0)),1)])]),((Q=F.subscriptions)==null?void 0:Q.length)>0?(t(),a("div",Ea,[e("h4",Ha,[d(n(De),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),D[14]||(D[14]=T(" Subscription Plans ",-1))]),e("div",Wa,[(t(!0),a(U,null,E(F.subscriptions,z=>(t(),a("div",{key:z.name,class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 p-2.5 sm:p-3"},[e("div",Ya,[e("div",Ga,[e("span",Qa,l(z.name),1),e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border",M[z.status]||"bg-gray-100 text-gray-500 border-gray-200"])},l(z.status),3)]),e("span",Ja,l(z.formatted_start)+" â†’ "+l(z.formatted_end),1)]),(t(!0),a(U,null,E(z.schedule_items,re=>(t(),a("div",{key:re.item_code,class:"mt-2"},[e("p",Xa,l(re.item_name),1),e("div",Ka,[(t(),a(U,null,E(K,G=>e("div",{key:G,class:$(["flex flex-col items-center px-1.5 sm:px-2 py-1 rounded-lg text-[8px] sm:text-[9px] font-bold min-w-[28px] sm:min-w-[32px] text-center",(re[Z[G]]||0)>0?"bg-blue-600 text-white":"bg-gray-100 text-gray-400"])},[e("span",null,l(B[G]),1),(re[Z[G]]||0)>0?(t(),a("span",Za," Ã—"+l(re[Z[G]]),1)):b("",!0)],2)),64))])]))),128))]))),128))])])):(t(),a("div",el,[d(n(De),{class:"w-5 h-5 sm:w-6 sm:h-6 text-gray-200 mx-auto mb-1"}),D[15]||(D[15]=T(" No subscription plans yet ",-1))])),((Y=F.recent_orders)==null?void 0:Y.length)>0?(t(),a("div",tl,[e("h4",sl,[d(n(ze),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),D[16]||(D[16]=T(" Recent Orders (last 5) ",-1))]),e("div",al,[e("div",ll,[e("table",nl,[D[17]||(D[17]=e("thead",{class:"bg-gray-50 border-b border-gray-100"},[e("tr",null,[e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Order"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Date"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Status"),e("th",{class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Amount")])],-1)),e("tbody",ol,[(t(!0),a(U,null,E(F.recent_orders,z=>(t(),a("tr",{key:z.name},[e("td",rl,[T(l(z.name)+" ",1),z.custom_subscription_refereance?(t(),a("span",il,"SUB")):b("",!0)]),e("td",dl,l(z.transaction_date),1),e("td",cl,[e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full",z.docstatus===2?"bg-red-100 text-red-600":z.status==="Completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"])},l(z.status),3)]),e("td",ul,l(C(z.grand_total)),1)]))),128))])])])])])):b("",!0)])):b("",!0)])}),128))]))]))}}),pl={class:"flex items-center gap-2 sm:gap-3"},ml={class:"p-2 sm:p-2.5 bg-emerald-600 rounded-lg sm:rounded-xl text-white shadow-md flex-shrink-0"},gl={class:"space-y-3"},bl={key:0,class:"flex items-start gap-3 bg-red-50 border border-red-200 rounded-xl px-4 py-3 shadow-sm"},fl={class:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0 mt-0.5"},yl={class:"flex-1 min-w-0"},vl={class:"text-xs text-red-600 mt-0.5 leading-relaxed"},hl={key:1,class:"flex items-start gap-3 bg-amber-50 border border-amber-200 rounded-xl px-4 py-3 shadow-sm"},_l={class:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0 mt-0.5"},wl={class:"flex-1 min-w-0"},kl={class:"text-[10px] text-amber-600 mt-0.5 font-mono break-all"},$l={class:"filter-card"},Cl={class:"filter-header"},Sl={class:"filter-title-group"},Dl={class:"filter-icon-wrap"},Fl={key:0,class:"filter-active-badge"},jl=["disabled"],Pl={class:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 mt-3"},Tl={class:"filter-field"},Ol=["max"],Al={class:"filter-field"},Nl=["min","max"],Il={class:"filter-field"},Ll={value:""},Ul=["value"],Rl={class:"filter-pills-row"},Ml={class:"pill pill-date"},Vl={class:"pill-text"},zl={class:"pill-text"},ql={key:0,class:"pill pill-customer"},Bl={class:"pill-text truncate max-w-[110px]"},El={class:"pill pill-count ml-auto"},Hl={class:"pill-count-num"},Wl={class:"summary-table-wrapper border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},Yl={class:"flex items-center gap-3 px-4 py-3.5 bg-gradient-to-r from-emerald-700 to-emerald-600 flex-shrink-0"},Gl={key:1,class:"flex items-center gap-1.5 bg-white/20 border border-white/20 rounded-full px-3 py-1 flex-shrink-0"},Ql={class:"text-[11px] font-black text-white"},Jl={key:0,class:"flex flex-col items-center justify-center gap-2 py-10 bg-white"},Xl={class:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center"},Kl={key:1,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},Zl={key:2,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},en={class:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center"},tn={key:3,class:"summary-scroll-area"},sn={class:"summary-table"},an=["title"],ln=["title"],nn={key:0,class:"cell-value"},on={key:1,class:"cell-empty"},rn={class:"col-total td-total-cell"},dn={class:"total-amt"},cn={class:"total-qty"},un={class:"footer-row"},xn={class:"col-total td-foot-amount"},pn={class:"border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},mn={class:"flex items-center gap-2.5 px-4 py-3 bg-gradient-to-r from-gray-700 to-gray-600"},gn={key:0,class:"w-2.5 h-2.5 text-white",viewBox:"0 0 12 12",fill:"none"},bn={key:1,class:"w-2 h-0.5 bg-white rounded-full"},fn={class:"text-[10px] font-bold text-white whitespace-nowrap"},yn={key:0,class:"flex flex-col items-center justify-center py-10 text-center bg-white px-4"},vn={class:"w-12 h-12 rounded-2xl bg-gray-100 flex items-center justify-center mb-3"},hn={key:1,class:"divide-y divide-gray-50 max-h-52 overflow-y-auto bg-white orders-scroll"},_n=["onClick"],wn={class:"hidden sm:grid items-center gap-2 px-4 py-3",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},kn={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},$n={class:"text-[10px] text-gray-400 font-mono font-bold"},Cn={class:"min-w-0"},Sn={class:"flex items-center gap-1.5 flex-wrap"},Dn={class:"font-bold font-mono text-[11px] text-gray-800 truncate"},Fn={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold"},jn={class:"text-[10px] text-gray-400 mt-0.5 truncate"},Pn={class:"min-w-0"},Tn={class:"font-mono text-[10px] text-gray-500 truncate block"},On={class:"text-right"},An={class:"text-[10px] font-bold text-emerald-700 bg-emerald-50 px-1.5 py-0.5 rounded-lg border border-emerald-100"},Nn={class:"text-right"},In={class:"text-[10px] font-bold text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded-lg border border-orange-100"},Ln={class:"font-black text-gray-800 font-mono text-xs text-right tabular-nums block"},Un={class:"flex sm:hidden items-center gap-3 px-4 py-3"},Rn={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},Mn={class:"flex-1 min-w-0"},Vn={class:"flex items-center gap-1"},zn={class:"font-bold font-mono text-[10px] text-gray-800 truncate"},qn={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},Bn={class:"flex items-center gap-2 mt-0.5"},En={class:"text-[9px] text-gray-400 truncate flex-1"},Hn={class:"text-[9px] font-bold text-emerald-700 bg-emerald-50 px-1 py-0.5 rounded flex-shrink-0"},Wn={class:"font-black text-gray-800 font-mono text-[11px] text-right tabular-nums flex-shrink-0"},Yn={class:"flex flex-col xs:flex-row items-start xs:items-center w-full gap-3"},Gn={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Qn={class:"text-[10px] sm:text-xs text-gray-500 font-semibold whitespace-nowrap"},Jn={class:"font-black text-gray-900 text-sm sm:text-base"},Xn={class:"flex items-center gap-2 sm:gap-3 ml-auto flex-shrink-0"},Kn=Ce({__name:"SellerCreateInvoiceDialog",props:{modelValue:{type:Boolean},eligibleOrders:{},seller:{},formatCurrency:{type:Function}},emits:["update:modelValue","invoice-created"],setup(m,{emit:H}){const k=m,A=H,N=R({get:()=>k.modelValue,set:_=>A("update:modelValue",_)}),O=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],w={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},o=new Date().toISOString().split("T")[0],u=I(""),h=I(o),v=I(new Set),C=I(""),M=I(""),K=I({}),B=I(!1),Z=I(""),V=le({url:"my_frappe_app.api.get_sales_order_items",onError(_){console.error("[InvoiceDialog] soItemsResource error:",_)}}),D=R(()=>{const _=new Map;return k.eligibleOrders.forEach(i=>{const x=i.customer||i.customer_name,s=i.customer_name||i.customer;x&&s&&_.set(x,s)}),Array.from(_.entries()).map(([i,x])=>({value:i,label:x}))}),F=R(()=>k.eligibleOrders.filter(_=>{const i=_.transaction_date;return!(u.value&&i<u.value||h.value&&i>h.value||M.value&&!(_.customer===M.value||_.customer_name===M.value))}));let X=!0;Se(F,_=>{X&&(v.value=new Set(_.map(i=>i.name)),X=!1)},{immediate:!0});const ae=()=>{u.value="",h.value=o,M.value="",v.value=new Set,C.value=""},Q=R(()=>!!u.value||!!M.value||h.value!==o),Y=R(()=>F.value.length>0&&F.value.every(_=>v.value.has(_.name))),z=R(()=>F.value.some(_=>v.value.has(_.name))&&!Y.value),re=()=>{const _=new Set(v.value);Y.value?F.value.forEach(i=>_.delete(i.name)):F.value.forEach(i=>_.add(i.name)),v.value=_},G=_=>{const i=new Set(v.value);i.has(_)?i.delete(_):i.add(_),v.value=i,C.value=""},me=R(()=>k.eligibleOrders.filter(_=>v.value.has(_.name))),ne=R(()=>me.value.reduce((_,i)=>_+(i.grand_total||0),0));function oe(_){return fe(this,null,function*(){const i=_.filter(x=>!K.value[x]);if(i.length){B.value=!0,Z.value="";try{const x=yield V.submit({order_names:JSON.stringify(i)});if(!Array.isArray(x))throw new Error(`Unexpected response format. Got: ${JSON.stringify(x)}`);const s={};for(const y of x)s[y.parent]||(s[y.parent]=[]),s[y.parent].push(y);for(const y of i)K.value[y]=s[y]||[]}catch(x){const s=(x==null?void 0:x.message)||(x==null?void 0:x.exception)||(x==null?void 0:x.exc_type)||String(x);Z.value=s;for(const y of i)K.value[y]||(K.value[y]=[])}finally{B.value=!1}}})}Se(v,_=>fe(this,null,function*(){_.size>0&&(yield oe([..._]))}),{deep:!0});const ie=R(()=>{const _=new Map;for(const i of me.value){const x=i.transaction_date;if(!x)continue;const s=new Date(x+"T00:00:00").toLocaleDateString("en-US",{weekday:"long"}),y=K.value[i.name]||[];for(const c of y){const r=c.item_code;if(!r)continue;_.has(r)||_.set(r,{item_name:c.item_name||r,days:{},total_qty:0,total_amt:0});const p=_.get(r),L=Number(c.qty)||0,W=Number(c.rate)||0;p.days[s]||(p.days[s]={qty:0,price:0}),p.days[s].qty+=L,W>0&&p.days[s].price===0&&(p.days[s].price=W),p.total_qty+=L,p.total_amt+=L*W}}return Array.from(_.entries()).map(([i,x])=>Fe({item_code:i},x))});function ve(_,i){const x=String(_).padStart(3,"0"),s=Number.isInteger(i)?String(i):i.toFixed(2);return`${x}(${s})`}const xe=le({url:"my_frappe_app.api.create_invoice_from_sales_orders",onSuccess(_){C.value="",N.value=!1,A("invoice-created",_.invoice_name),be()},onError(_){const i=((_==null?void 0:_.exception)||(_==null?void 0:_.message)||"").toLowerCase();if(i.includes("already been billed")||i.includes("billed amount"))C.value="This order has already been billed. Please select a different order.";else if(i.includes("not submitted")||i.includes("draft"))C.value="Order has not been submitted yet. Please submit the order first.";else if(i.includes("permission")||i.includes("not permitted"))C.value="You do not have permission to create this invoice.";else if(i.includes("no orders")||i.includes("select at least"))C.value="Please select at least one order.";else if(i.includes("delivery")&&i.includes("not"))C.value="Delivery has not been completed yet. Please confirm delivery first.";else if(i.includes("customer")&&i.includes("match"))C.value="All selected orders must belong to the same customer.";else if(i.includes("internal server error")||i.includes("operationalerror")||i.includes("traceback"))C.value="A server error occurred. Please try again later or contact the admin.";else{const x=((_==null?void 0:_.exception)||(_==null?void 0:_.message)||"").replace(/<[^>]+>/g,"").replace(/^[\w.]+Error:\s*/i,"").replace(/Traceback[\s\S]*/i,"").trim();C.value=x||"An error occurred while creating the invoice. Please try again."}}}),he=R(()=>xe.loading),ge=()=>{v.value.size!==0&&(C.value="",xe.submit({sales_orders:[...v.value]}))},be=()=>{u.value="",h.value=o,v.value=new Set,C.value="",M.value="",K.value={},Z.value="",X=!0};return Se(N,_=>{_||be()}),(_,i)=>(t(),P(n(rt),{modelValue:N.value,"onUpdate:modelValue":i[9]||(i[9]=x=>N.value=x),options:{size:"5xl"}},{"body-title":q(()=>[e("div",pl,[e("div",ml,[d(n(ke),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),i[10]||(i[10]=e("div",null,[e("h3",{class:"text-base sm:text-xl font-black leading-none text-gray-900"},"Create Invoice"),e("p",{class:"text-[10px] sm:text-sm text-gray-400 font-medium mt-0.5"}," Select delivered orders to generate a combined invoice ")],-1))])]),"body-content":q(()=>{var x;return[e("div",gl,[C.value?(t(),a("div",bl,[e("div",fl,[d(n(je),{class:"w-4 h-4 text-red-500"})]),e("div",yl,[i[11]||(i[11]=e("p",{class:"text-sm text-red-800 font-bold"},"Invoice Could Not Be Created",-1)),e("p",vl,l(C.value),1)]),e("button",{onClick:i[0]||(i[0]=s=>C.value=""),class:"text-red-300 hover:text-red-500 transition-colors mt-0.5"},[d(n(_e),{class:"w-4 h-4"})])])):b("",!0),Z.value?(t(),a("div",hl,[e("div",_l,[d(n(je),{class:"w-4 h-4 text-amber-500"})]),e("div",wl,[i[12]||(i[12]=e("p",{class:"text-xs text-amber-800 font-bold"},"Could not load item details",-1)),e("p",kl,l(Z.value),1)]),e("button",{onClick:i[1]||(i[1]=s=>Z.value=""),class:"text-amber-300 hover:text-amber-500 transition-colors"},[d(n(_e),{class:"w-3.5 h-3.5"})])])):b("",!0),e("div",$l,[e("div",Cl,[e("div",Sl,[e("div",Dl,[d(n(_t),{class:"w-3.5 h-3.5 text-indigo-600"})]),i[13]||(i[13]=e("span",{class:"filter-title"},"Filters",-1)),Q.value?(t(),a("span",Fl,l((u.value?1:0)+(M.value?1:0)+(h.value!==n(o)?1:0))+" active ",1)):b("",!0)]),e("button",{onClick:ae,disabled:!Q.value,class:$(["clear-btn",Q.value?"clear-btn-active":"clear-btn-disabled"])},[d(n(_e),{class:"w-3 h-3"}),i[14]||(i[14]=e("span",null,"Clear Filters",-1))],10,jl)]),e("div",Pl,[e("div",Tl,[i[15]||(i[15]=e("label",{class:"filter-label"},"From Date",-1)),e("div",{class:$(["filter-input-wrap",u.value?"input-active":""])},[d(n($e),{class:"filter-input-icon"}),ce(e("input",{type:"date","onUpdate:modelValue":i[2]||(i[2]=s=>u.value=s),max:h.value||n(o),class:"filter-input"},null,8,Ol),[[pe,u.value]]),u.value?(t(),a("button",{key:0,onClick:i[3]||(i[3]=ee(s=>u.value="",["stop"])),class:"input-clear-btn"},[d(n(_e),{class:"w-3 h-3"})])):b("",!0)],2)]),e("div",Al,[i[16]||(i[16]=e("label",{class:"filter-label"},"To Date",-1)),e("div",{class:$(["filter-input-wrap",h.value!==n(o)?"input-active":""])},[d(n($e),{class:"filter-input-icon"}),ce(e("input",{type:"date","onUpdate:modelValue":i[4]||(i[4]=s=>h.value=s),min:u.value,max:n(o),class:"filter-input"},null,8,Nl),[[pe,h.value]]),h.value!==n(o)?(t(),a("button",{key:0,onClick:i[5]||(i[5]=ee(s=>h.value=n(o),["stop"])),class:"input-clear-btn"},[d(n(_e),{class:"w-3 h-3"})])):b("",!0)],2)]),e("div",Il,[i[18]||(i[18]=e("label",{class:"filter-label"},"Customer",-1)),e("div",{class:$(["filter-input-wrap",M.value?"input-active":""])},[d(n(Be),{class:"filter-input-icon",style:{"z-index":"2"}}),ce(e("select",{"onUpdate:modelValue":i[6]||(i[6]=s=>M.value=s),class:"filter-input filter-select"},[e("option",Ll,"All Customers ("+l(D.value.length)+")",1),(t(!0),a(U,null,E(D.value,s=>(t(),a("option",{key:s.value,value:s.value},l(s.label),9,Ul))),128))],512),[[st,M.value]]),i[17]||(i[17]=e("svg",{class:"absolute right-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1))],2)])]),e("div",Rl,[e("div",Ml,[e("span",{class:$(["pill-dot",Q.value?"pill-dot-active":"pill-dot-idle"])},null,2),e("span",Vl,l(u.value||"Any"),1),d(n(Re),{class:"w-3 h-3 opacity-40"}),e("span",zl,l(h.value||n(o)),1)]),M.value?(t(),a("div",ql,[d(n(Be),{class:"w-2.5 h-2.5"}),e("span",Bl,l((x=D.value.find(s=>s.value===M.value))==null?void 0:x.label),1),e("button",{onClick:i[7]||(i[7]=s=>{M.value="",v.value=new Set}),class:"pill-remove"},[d(n(_e),{class:"w-2.5 h-2.5"})])])):b("",!0),e("div",El,[e("span",Hl,l(F.value.length),1),i[19]||(i[19]=e("span",{class:"pill-count-label"},"orders found",-1))])])]),e("div",Wl,[e("div",Yl,[i[21]||(i[21]=e("div",{class:"w-8 h-8 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0 shadow-inner"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7"})])],-1)),i[22]||(i[22]=e("div",{class:"flex-1 min-w-0"},[e("p",{class:"text-sm font-black text-white leading-tight tracking-tight"},"Day-wise Item Summary"),e("p",{class:"text-[11px] text-emerald-200 mt-0.5 font-semibold"},"qty(â‚¹rate) â€” e.g. 002(35)")],-1)),B.value?(t(),P(n(et),{key:0,class:"w-4 h-4 text-white/80 animate-spin flex-shrink-0"})):(t(),a("div",Gl,[e("span",Ql,l(ie.value.length),1),i[20]||(i[20]=e("span",{class:"text-[11px] text-emerald-200 font-semibold"},"items",-1))]))]),B.value&&ie.value.length===0?(t(),a("div",Jl,[e("div",Xl,[d(n(et),{class:"w-5 h-5 text-emerald-500 animate-spin"})]),i[23]||(i[23]=e("p",{class:"text-xs font-semibold text-gray-400"},"Fetching item details...",-1))])):v.value.size===0?(t(),a("div",Kl,[...i[24]||(i[24]=[e("div",{class:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1),e("p",{class:"text-xs font-semibold text-gray-400"},"Select orders below to see item summary",-1)])])):!B.value&&ie.value.length===0?(t(),a("div",Zl,[e("div",en,[d(n(je),{class:"w-5 h-5 text-amber-400"})]),i[25]||(i[25]=e("p",{class:"text-xs font-semibold text-gray-400"},"No item data found for selected orders",-1)),i[26]||(i[26]=e("p",{class:"text-[10px] text-gray-300"},"Check browser console (F12) for details",-1))])):(t(),a("div",tn,[e("table",sn,[e("thead",null,[e("tr",null,[i[27]||(i[27]=e("th",{class:"col-item th-item"},[e("span",{class:"th-label"},"Item")],-1)),(t(),a(U,null,E(O,s=>e("th",{key:s,class:$(["col-day th-day",s==="Saturday"||s==="Sunday"?"th-weekend":""])},l(w[s]),3)),64)),i[28]||(i[28]=e("th",{class:"col-total th-total"},[e("span",{class:"th-label"},"Total")],-1))])]),e("tbody",null,[(t(!0),a(U,null,E(ie.value,(s,y)=>(t(),a("tr",{key:s.item_code,class:$(["data-row",y%2===1?"row-alt":"row-base"])},[e("td",{class:$(["col-item td-item",y%2===1?"td-item-alt":"td-item-base"])},[e("div",{class:"item-name",title:s.item_name},l(s.item_name),9,an),e("div",{class:"item-code",title:s.item_code},l(s.item_code),9,ln)],2),(t(),a(U,null,E(O,c=>e("td",{key:c,class:$(["col-day td-day",c==="Saturday"||c==="Sunday"?"td-weekend":""])},[s.days[c]&&s.days[c].qty>0?(t(),a("span",nn,l(ve(s.days[c].qty,s.days[c].price)),1)):(t(),a("span",on,"Â·"))],2)),64)),e("td",rn,[e("div",dn,l(m.formatCurrency(s.total_amt)),1),e("div",cn,"qty: "+l(s.total_qty),1)])],2))),128))]),e("tfoot",null,[e("tr",un,[i[29]||(i[29]=e("td",{class:"col-item td-foot-label"},"Grand Total",-1)),(t(),a(U,null,E(O,s=>e("td",{key:s,class:$(["col-day td-foot-day",s==="Saturday"||s==="Sunday"?"td-foot-weekend":""])},null,2)),64)),e("td",xn,l(m.formatCurrency(ne.value)),1)])])])]))]),e("div",pn,[e("div",mn,[i[31]||(i[31]=e("div",{class:"w-7 h-7 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),i[32]||(i[32]=e("div",{class:"flex-1"},[e("p",{class:"text-sm font-black text-white leading-none"},"Select Orders"),e("p",{class:"text-[10px] text-gray-300 mt-0.5"},"Click to select/deselect orders for invoicing")],-1)),e("button",{onClick:re,class:"flex items-center gap-1.5 bg-white/15 hover:bg-white/25 transition-colors rounded-lg px-2.5 py-1.5 flex-shrink-0"},[e("div",{class:$(["checkbox-circle-sm",Y.value?"checkbox-sm-selected":z.value?"checkbox-sm-indeterminate":"checkbox-sm-unselected"])},[Y.value?(t(),a("svg",gn,[...i[30]||(i[30]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):z.value?(t(),a("div",bn)):b("",!0)],2),e("span",fn,l(Y.value?"Deselect All":"Select All"),1)])]),i[37]||(i[37]=e("div",{class:"hidden sm:grid items-center gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},[e("span"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"#"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Sales Order"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Delivery Note"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Delivered"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Billed"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Amount")],-1)),F.value.length===0?(t(),a("div",yn,[e("div",vn,[d(n(je),{class:"w-6 h-6 text-gray-300"})]),i[33]||(i[33]=e("p",{class:"text-sm font-bold text-gray-400"},"No eligible orders found",-1)),i[34]||(i[34]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting the date range or customer filter",-1))])):(t(),a("div",hn,[(t(!0),a(U,null,E(F.value,(s,y)=>(t(),a("div",{key:s.name,onClick:c=>G(s.name),class:$(["order-row cursor-pointer select-none transition-all duration-100",v.value.has(s.name)?"order-row-selected":"order-row-unselected"])},[e("div",wn,[e("div",{class:$(["checkbox-circle",v.value.has(s.name)?"checkbox-selected":"checkbox-unselected"])},[v.value.has(s.name)?(t(),a("svg",kn,[...i[35]||(i[35]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):b("",!0)],2),e("span",$n,l(y+1),1),e("div",Cn,[e("div",Sn,[e("span",Dn,l(s.name),1),s.custom_subscription_refereance?(t(),a("span",Fn,"Sub")):b("",!0)]),e("p",jn,l(s.customer_name),1)]),e("div",Pn,[e("span",Tn,l(s.delivery_note||"â€”"),1)]),e("div",On,[e("span",An,l(s.per_delivered)+"% ",1)]),e("div",Nn,[e("span",In,l(s.per_billed)+"% ",1)]),e("span",Ln,l(m.formatCurrency(s.grand_total,s.currency)),1)]),e("div",Un,[e("div",{class:$(["checkbox-circle",v.value.has(s.name)?"checkbox-selected":"checkbox-unselected"])},[v.value.has(s.name)?(t(),a("svg",Rn,[...i[36]||(i[36]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):b("",!0)],2),e("div",Mn,[e("div",Vn,[e("span",zn,l(s.name),1),s.custom_subscription_refereance?(t(),a("span",qn,"Sub")):b("",!0)]),e("div",Bn,[e("p",En,l(s.customer_name),1),e("span",Hn,l(s.per_delivered)+"%",1)])]),e("span",Wn,l(m.formatCurrency(s.grand_total,s.currency)),1)])],10,_n))),128))]))])])]}),actions:q(()=>[e("div",Yn,[e("div",Gn,[v.value.size>0?(t(),a(U,{key:0},[e("span",Qn,l(v.value.size)+" orders ",1),i[38]||(i[38]=e("div",{class:"h-4 w-px bg-gray-200 flex-shrink-0"},null,-1)),e("span",Jn,l(m.formatCurrency(ne.value)),1)],64)):b("",!0)]),e("div",Xn,[d(n(de),{variant:"outline",class:"text-xs sm:text-sm",onClick:i[8]||(i[8]=x=>N.value=!1)},{default:q(()=>[...i[39]||(i[39]=[T("Cancel",-1)])]),_:1}),d(n(de),{variant:"solid",theme:"green",loading:he.value,disabled:v.value.size===0,class:"text-xs sm:text-sm",onClick:ge},{prefix:q(()=>[d(n(ke),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:q(()=>[i[40]||(i[40]=T(" Create Invoice ",-1))]),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"]))}}),Zn=ft(Kn,[["__scopeId","data-v-bf1c7c7e"]]),eo={class:"w-full min-w-0"},to={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},so={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},ao={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},lo={class:"flex-1 min-w-0"},no={class:"text-sm font-black text-white truncate"},oo={key:0,class:"text-[10px] text-gray-400 font-medium"},ro={class:"text-blue-400"},io={class:"flex items-center gap-2 flex-shrink-0"},co={key:0,class:"flex-1 flex items-center justify-center"},uo={class:"flex flex-col items-center gap-4"},xo={class:"relative"},po={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},mo={key:1,class:"flex-1 flex items-center justify-center p-6"},go={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},bo={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},fo={class:"text-xs text-red-500 mt-1 break-words"},yo=["src"],vo={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},ho={class:"flex items-start gap-3"},_o={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},wo={class:"text-sm font-black text-gray-900"},ko={class:"text-xs text-gray-500 mt-1 leading-relaxed"},$o={class:"flex gap-2 justify-end"},Co={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},So={class:"flex items-start gap-3"},Do={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},Fo={class:"flex-1 min-w-0"},jo={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},Po={class:"flex justify-end"},To={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},Oo={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},Ao={class:"text-sm sm:text-base font-black leading-tight"},No={class:"bg-gradient-to-br from-orange-500 to-amber-400 rounded-xl p-3 text-white"},Io={class:"text-sm sm:text-base font-black leading-tight"},Lo={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},Uo={class:"text-sm sm:text-base font-black leading-tight"},Ro={class:"bg-gradient-to-br from-gray-500 to-gray-400 rounded-xl p-3 text-white"},Mo={class:"text-sm sm:text-base font-black leading-tight"},Vo={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},zo={class:"flex flex-wrap items-center gap-2"},qo={class:"flex items-center gap-2 flex-1 min-w-0"},Bo={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Eo={class:"min-w-0"},Ho={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Wo={key:0,class:"text-blue-500"},Yo={class:"relative"},Go={class:"flex flex-wrap gap-2 items-center"},Qo={class:"flex gap-1 flex-wrap"},Jo=["onClick"],Xo={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Ko=["max"],Zo={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},er=["min"],tr={key:0,class:"p-6 space-y-3"},sr={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},ar={class:"p-4 bg-gray-100 rounded-2xl mb-4"},lr={key:2},nr={class:"divide-y divide-gray-100/80"},or=["onClick"],rr={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},ir={class:"flex items-center gap-2 flex-wrap"},dr={class:"text-xs font-black text-gray-900 truncate"},cr={class:"text-[10px] text-gray-500 font-medium truncate"},ur={class:"flex items-center gap-2 flex-wrap mt-0.5"},xr={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},pr={class:"text-[10px] font-black text-gray-800"},mr={key:0,class:"text-[9px] text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded font-semibold"},gr={class:"hidden sm:block text-xs font-black text-gray-900 truncate"},br={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},fr={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},yr={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},vr={class:"hidden sm:flex justify-center"},hr={class:"flex justify-center text-gray-400"},_r={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},wr={key:0,class:"space-y-2"},kr={key:1,class:"space-y-4"},$r={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},Cr={class:"col-span-2 sm:col-span-1 bg-white rounded-xl p-3 border border-gray-100"},Sr={class:"text-xs font-black text-blue-700 truncate"},Dr={class:"bg-white rounded-xl p-3 border border-gray-100"},Fr={class:"text-xs font-black text-gray-800"},jr={class:"bg-white rounded-xl p-3 border border-gray-100"},Pr={class:"text-xs font-black text-gray-800"},Tr={class:"bg-white rounded-xl p-3 border border-gray-100"},Or={class:"text-xs font-black text-gray-800"},Ar={class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},Nr={class:"bg-white rounded-xl p-3 border border-gray-100"},Ir={class:"text-xs font-black text-gray-800 truncate"},Lr={class:"bg-white rounded-xl p-3 border border-gray-100"},Ur={class:"text-xs font-black text-gray-800"},Rr={class:"bg-white rounded-xl p-3 border border-gray-100"},Mr={class:"text-xs font-black text-gray-800"},Vr={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},zr={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},qr={class:"min-w-0"},Br={class:"text-xs font-semibold text-gray-800 truncate"},Er={class:"text-[9px] text-gray-400 truncate"},Hr={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},Wr={class:"text-xs text-gray-600 text-center font-medium"},Yr={class:"text-xs text-gray-600 text-center"},Gr={class:"text-xs font-black text-gray-900 text-right"},Qr={class:"border-t border-gray-200 px-4 py-3 flex justify-between items-center"},Jr={key:0,class:"text-xs text-gray-500"},Xr={class:"text-right ml-auto"},Kr={class:"text-sm font-black text-gray-900"},Zr={class:"flex flex-wrap gap-2 justify-end pt-1"},ei=["onClick"],ti=["onClick","disabled"],si=["onClick","disabled"],ai=["onClick","disabled"],li=["onClick","disabled"],ni={key:2,class:"space-y-2"},oi={key:0,class:"flex justify-center py-4"},ri=Ce({__name:"Deliverynote",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(m){const H=m,k=I(""),A=I(""),N=I(""),O=I("all"),w=I(null),o=I(null),u=I(""),h=I(""),v=I({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),C=I({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),M=I({show:!1,message:""}),K=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Submitted",label:"Submitted"},{key:"Cancelled",label:"Cancelled"}],B=We({doctype:"Delivery Note",fields:["name","customer","customer_name","status","posting_date","grand_total","currency","docstatus","lr_no","lr_date","per_billed","per_returned","set_warehouse","shipping_address_name"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),Z=le({url:"frappe.client.get",makeParams:x=>({doctype:"Delivery Note",name:x.name}),onSuccess(x){o.value=x}}),V=le({url:"frappe.client.submit",onSuccess(){u.value="",h.value="",B.reload(),w.value&&Z.fetch({name:w.value})},onError(x){u.value="",h.value="",oe((x==null?void 0:x.message)||(x==null?void 0:x.exc_type)||"Submit failed")}}),D=le({url:"frappe.client.cancel",onSuccess(){u.value="",h.value="",B.reload(),w.value&&Z.fetch({name:w.value})},onError(x){u.value="",h.value="",oe((x==null?void 0:x.message)||(x==null?void 0:x.exc_type)||"Cancel failed")}}),F=le({url:"frappe.client.delete",onSuccess(){u.value="",h.value="",w.value=null,o.value=null,B.reload()},onError(x){u.value="",h.value="",oe((x==null?void 0:x.message)||(x==null?void 0:x.exc_type)||"Delete failed")}});Se(()=>[H.customer,H.seller],([x])=>{const s=[];x&&s.push(["customer","=",x]),B.update({filters:s}),B.reload()},{immediate:!0});const X=R(()=>{let x=B.data||[];if(O.value!=="all"&&(x=x.filter(s=>O.value==="Draft"?s.docstatus===0:O.value==="Submitted"?s.docstatus===1:O.value==="Cancelled"?s.docstatus===2:!0)),A.value&&(x=x.filter(s=>s.posting_date>=A.value)),N.value&&(x=x.filter(s=>s.posting_date<=N.value)),k.value.trim()){const s=k.value.toLowerCase();x=x.filter(y=>{var c,r;return((c=y.name)==null?void 0:c.toLowerCase().includes(s))||((r=y.customer_name)==null?void 0:r.toLowerCase().includes(s))})}return x}),ae=R(()=>A.value!==""||N.value!==""),Q=R(()=>B.loading),Y=R(()=>(B.data||[]).length>0),z=R(()=>{const x=B.data||[];return{total:x.length,draft:x.filter(s=>s.docstatus===0).length,submitted:x.filter(s=>s.docstatus===1).length,cancelled:x.filter(s=>s.docstatus===2).length}});function re(){A.value="",N.value="",O.value="all",k.value=""}function G(x){return x.docstatus===2?{label:"Cancelled",theme:"gray",icon:Le}:x.docstatus===0?{label:"Draft",theme:"orange",icon:Me}:x.per_billed>=100?{label:"Completed",theme:"green",icon:it}:x.per_billed>0?{label:"Partly Billed",theme:"blue",icon:je}:{label:"To Bill",theme:"purple",icon:Ye}}const me={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function ne(x){w.value===x?(w.value=null,o.value=null):(w.value=x,o.value=null,Z.fetch({name:x}))}function oe(x){const s=x.replace(/<[^>]*>/g,"").trim().split(`
`)[0];M.value={show:!0,message:s}}function ie(x){return fe(this,null,function*(){var s,y;try{const c=yield fetch(`/api/method/frappe.client.get_value?doctype=Property+Setter&filters=${encodeURIComponent(JSON.stringify([["doc_type","=",x],["property","=","default_print_format"]]))}&fieldname=value`,{credentials:"include"});if(c.ok){const r=yield c.json(),p=(s=r==null?void 0:r.message)==null?void 0:s.value;if(p&&p.trim())return p.trim()}}catch(c){}try{const c=yield fetch(`/api/resource/Print+Format?filters=${encodeURIComponent(JSON.stringify([["doc_type","=",x],["disabled","=",0]]))}&fields=${encodeURIComponent(JSON.stringify(["name","default_format"]))}&order_by=modified+desc&limit=50`,{credentials:"include"});if(c.ok){const r=yield c.json(),p=(r==null?void 0:r.data)||[],L=p.find(W=>W.default_format===1);if(L!=null&&L.name)return L.name;if((y=p[0])!=null&&y.name)return p[0].name}}catch(c){}return"Standard"})}function ve(x){return fe(this,null,function*(){v.value={show:!0,loading:!0,blobUrl:"",docName:x,printFormat:"",error:""};try{const s=yield ie("Delivery Note");v.value.printFormat=s;const y=`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(x)}&format=${encodeURIComponent(s)}&no_letterhead=0&letterhead=No+Letterhead`,c=yield fetch(y,{credentials:"include"});if(!c.ok){if(s!=="Standard"){const L=yield fetch(`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(x)}&format=Standard&no_letterhead=0`,{credentials:"include"});if(!L.ok)throw new Error(`HTTP ${L.status} â€” PDF generation failed`);const W=yield L.blob(),j=URL.createObjectURL(W);v.value={show:!0,loading:!1,blobUrl:j,docName:x,printFormat:"Standard (fallback)",error:""};return}throw new Error(`HTTP ${c.status} â€” PDF generation failed`)}const r=yield c.blob(),p=URL.createObjectURL(r);v.value={show:!0,loading:!1,blobUrl:p,docName:x,printFormat:s,error:""}}catch(s){const y=(s==null?void 0:s.message)||"Could not load PDF";v.value={show:!0,loading:!1,blobUrl:"",docName:x,printFormat:"",error:y}}})}function xe(){v.value.blobUrl&&URL.revokeObjectURL(v.value.blobUrl),v.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function he(){if(!v.value.blobUrl)return;const x=document.createElement("a");x.href=v.value.blobUrl,x.download=`${v.value.docName}.pdf`,x.click()}function ge(x){C.value=Fe({show:!0},x)}function be(x){o.value&&ge({title:"Submit Delivery Note",message:`Submit ${x}? Stock entries will be posted and cannot be easily undone.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{C.value.show=!1,u.value=x,h.value="submit",V.fetch({doc:o.value})}})}function _(x){ge({title:"Cancel Delivery Note",message:`Cancel ${x}? Stock entries will be reversed.`,confirmLabel:"Cancel DN",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{C.value.show=!1,u.value=x,h.value="cancel",D.fetch({doctype:"Delivery Note",name:x})}})}function i(x){ge({title:"Delete Delivery Note",message:`Permanently delete ${x}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{C.value.show=!1,u.value=x,h.value="delete",F.fetch({doctype:"Delivery Note",name:x})}})}return(x,s)=>(t(),a("div",eo,[(t(),P(Pe,{to:"body"},[d(we,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>[v.value.show?(t(),a("div",to,[e("div",so,[e("div",ao,[d(n(Ae),{class:"w-4 h-4 text-white"})]),e("div",lo,[e("p",no,l(v.value.docName),1),v.value.printFormat?(t(),a("p",oo,[s[12]||(s[12]=T(" Format: ",-1)),e("span",ro,l(v.value.printFormat),1)])):b("",!0)]),e("div",io,[v.value.blobUrl?(t(),a("button",{key:0,onClick:he,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[d(n(dt),{class:"w-3.5 h-3.5"}),s[13]||(s[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):b("",!0),e("button",{onClick:xe,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[d(n(_e),{class:"w-4 h-4"})])])]),v.value.loading?(t(),a("div",co,[e("div",uo,[e("div",xo,[e("div",po,[d(n(Ae),{class:"w-7 h-7 text-white/60"})]),s[14]||(s[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-blue-400 border-t-transparent animate-spin"},null,-1))]),s[15]||(s[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Detecting default print format")],-1))])])):v.value.error?(t(),a("div",mo,[e("div",go,[e("div",bo,[d(n(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[s[16]||(s[16]=e("p",{class:"text-sm font-black text-red-300"},"PDF Load Failed",-1)),e("p",fo,l(v.value.error),1)]),e("button",{onClick:xe,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Close ")])])):v.value.blobUrl?(t(),a("iframe",{key:2,src:v.value.blobUrl,class:"flex-1 w-full border-0",title:"Print Preview"},null,8,yo)):b("",!0)])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[d(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:q(()=>[C.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s[2]||(s[2]=ee(y=>C.value.show=!1,["self"]))},[e("div",vo,[e("div",ho,[e("div",_o,[d(n(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",wo,l(C.value.title),1),e("p",ko,l(C.value.message),1)])]),e("div",$o,[e("button",{onClick:s[0]||(s[0]=y=>C.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"}," Go Back "),e("button",{onClick:s[1]||(s[1]=y=>C.value.onConfirm()),class:$(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",C.value.confirmClass])},l(C.value.confirmLabel),3)])])])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[d(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>[M.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s[4]||(s[4]=ee(y=>M.value.show=!1,["self"]))},[e("div",Co,[e("div",So,[e("div",Do,[d(n(Te),{class:"w-5 h-5 text-red-500"})]),e("div",Fo,[s[17]||(s[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Failed",-1)),e("p",jo,l(M.value.message),1)])]),e("div",Po,[e("button",{onClick:s[3]||(s[3]=y=>M.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"}," OK ")])])])):b("",!0)]),_:1})])),e("div",To,[e("div",Oo,[s[18]||(s[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total DNs",-1)),e("p",Ao,l(z.value.total),1)]),e("div",No,[s[19]||(s[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Draft",-1)),e("p",Io,l(z.value.draft),1)]),e("div",Lo,[s[20]||(s[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Submitted",-1)),e("p",Uo,l(z.value.submitted),1)]),e("div",Ro,[s[21]||(s[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Cancelled",-1)),e("p",Mo,l(z.value.cancelled),1)])]),e("div",Vo,[e("div",zo,[e("div",qo,[e("div",Bo,[d(n(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Eo,[s[22]||(s[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Delivery Notes",-1)),e("p",Ho,[T(l(X.value.length)+" record"+l(X.value.length!==1?"s":"")+" ",1),ae.value||O.value!=="all"||k.value?(t(),a("span",Wo," (filtered)")):b("",!0)])])]),e("button",{onClick:s[5]||(s[5]=y=>n(B).reload()),class:$(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",Q.value?"opacity-60 pointer-events-none":""])},[d(n(se),{class:$(["w-3.5 h-3.5",Q.value?"animate-spin":""])},null,8,["class"]),s[23]||(s[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Yo,[d(n(Ge),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),ce(e("input",{"onUpdate:modelValue":s[6]||(s[6]=y=>k.value=y),type:"text",placeholder:"Search by DN #, customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[pe,k.value]]),k.value?(t(),a("button",{key:0,onClick:s[7]||(s[7]=y=>k.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[d(n(ue),{class:"w-3.5 h-3.5"})])):b("",!0)]),e("div",Go,[e("div",Qo,[(t(),a(U,null,E(K,y=>e("button",{key:y.key,onClick:c=>O.value=y.key,class:$(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",O.value===y.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},l(y.label),11,Jo)),64))]),e("div",Xo,[s[24]||(s[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),ce(e("input",{type:"date","onUpdate:modelValue":s[8]||(s[8]=y=>A.value=y),max:N.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Ko),[[pe,A.value]]),A.value?(t(),a("button",{key:0,onClick:s[9]||(s[9]=y=>A.value=""),class:"text-gray-300 hover:text-red-400"},[d(n(ue),{class:"w-3 h-3"})])):b("",!0)]),e("div",Zo,[s[25]||(s[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),ce(e("input",{type:"date","onUpdate:modelValue":s[10]||(s[10]=y=>N.value=y),min:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,er),[[pe,N.value]]),N.value?(t(),a("button",{key:0,onClick:s[11]||(s[11]=y=>N.value=""),class:"text-gray-300 hover:text-red-400"},[d(n(ue),{class:"w-3 h-3"})])):b("",!0)]),ae.value||O.value!=="all"||k.value?(t(),a("button",{key:0,onClick:re,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[d(n(ue),{class:"w-3 h-3"}),s[26]||(s[26]=T(" Clear All ",-1))])):b("",!0)])]),Q.value&&!Y.value?(t(),a("div",tr,[(t(),a(U,null,E(5,y=>e("div",{key:y,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!Q.value&&X.value.length===0?(t(),a("div",sr,[e("div",ar,[d(n(Oe),{class:"w-10 h-10 text-gray-300"})]),s[27]||(s[27]=e("p",{class:"text-sm font-black text-gray-300"},"No Delivery Notes Found",-1)),s[28]||(s[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),a("div",lr,[s[43]||(s[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"DN #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Amount"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",nr,[(t(!0),a(U,null,E(X.value,y=>{var c;return t(),a("div",{key:y.name},[e("div",{onClick:r=>ne(y.name),class:"grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5 hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none"},[e("div",rr,[e("div",ir,[e("span",dr,l(y.name),1),e("span",{class:$(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",me[G(y).theme]])},[(t(),P(ye(G(y).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(G(y).label),1)],2)]),e("span",cr,l(y.customer_name),1),e("div",ur,[e("span",xr,[d(n($e),{class:"w-2.5 h-2.5"}),T(l(y.posting_date),1)]),e("span",pr,l(m.formatCurrency(y.grand_total,y.currency)),1),y.per_billed>0&&y.per_billed<100?(t(),a("span",mr,l((c=y.per_billed)==null?void 0:c.toFixed(0))+"% billed ",1)):b("",!0)])]),e("span",gr,l(y.name),1),e("span",br,l(y.customer_name),1),e("span",fr,[d(n($e),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),T(l(y.posting_date),1)]),e("span",yr,l(m.formatCurrency(y.grand_total,y.currency)),1),e("span",vr,[e("span",{class:$(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",me[G(y).theme]])},[(t(),P(ye(G(y).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(G(y).label),1)],2)]),e("div",hr,[w.value===y.name?(t(),P(n(Ue),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),P(n(Re),{key:1,class:"w-4 h-4"}))])],8,or),d(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>{var r,p,L,W;return[w.value===y.name?(t(),a("div",_r,[n(Z).loading&&!o.value?(t(),a("div",wr,[(t(),a(U,null,E(4,j=>e("div",{key:j,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):o.value&&o.value.name===y.name?(t(),a("div",kr,[e("div",$r,[e("div",Cr,[s[29]||(s[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Against Sales Order",-1)),e("p",Sr,l(((r=o.value.items)==null?void 0:r.map(j=>j.against_sales_order).filter(Boolean).filter((j,S,g)=>g.indexOf(j)===S).join(", "))||"â€”"),1)]),e("div",Dr,[s[30]||(s[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Number",-1)),e("p",Fr,l(o.value.lr_no||"â€”"),1)]),e("div",jr,[s[31]||(s[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Date",-1)),e("p",Pr,l(o.value.lr_date||"â€”"),1)]),e("div",Tr,[s[32]||(s[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Billed %",-1)),e("p",Or,l((p=o.value.per_billed)!=null?p:0)+"%",1)])]),e("div",Ar,[e("div",Nr,[s[33]||(s[33]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Warehouse",-1)),e("p",Ir,l(o.value.set_warehouse||"â€”"),1)]),e("div",Lr,[s[34]||(s[34]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"% Returned",-1)),e("p",Ur,l((L=o.value.per_returned)!=null?L:0)+"%",1)]),e("div",Rr,[s[35]||(s[35]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Vehicle No",-1)),e("p",Mr,l(o.value.vehicle_no||"â€”"),1)])]),(W=o.value.items)!=null&&W.length?(t(),a("div",Vr,[s[37]||(s[37]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",zr,[(t(!0),a(U,null,E(o.value.items,j=>(t(),a("div",{key:j.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",qr,[e("p",Br,l(j.item_name),1),e("p",Er,l(j.item_code),1),j.against_sales_order?(t(),a("p",Hr," SO: "+l(j.against_sales_order),1)):b("",!0)]),e("span",Wr,l(j.qty)+" "+l(j.uom),1),e("span",Yr,l(m.formatCurrency(j.rate,o.value.currency)),1),e("span",Gr,l(m.formatCurrency(j.amount,o.value.currency)),1)]))),128))]),e("div",Qr,[o.value.total_taxes_and_charges?(t(),a("div",Jr," Tax: "+l(m.formatCurrency(o.value.total_taxes_and_charges,o.value.currency)),1)):b("",!0),e("div",Xr,[s[36]||(s[36]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase"},"Grand Total",-1)),e("p",Kr,l(m.formatCurrency(o.value.grand_total,o.value.currency)),1)])])])):b("",!0),e("div",Zr,[e("button",{onClick:ee(j=>ve(y.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[d(n(Ae),{class:"w-3.5 h-3.5"}),s[38]||(s[38]=T(" Print / PDF ",-1))],8,ei),o.value.docstatus===0?(t(),a("button",{key:0,onClick:ee(j=>be(y.name),["stop"]),disabled:u.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[u.value===y.name&&h.value==="submit"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(ct),{key:1,class:"w-3.5 h-3.5"})),s[39]||(s[39]=T(" Submit ",-1))],8,ti)):b("",!0),o.value.docstatus===0?(t(),a("button",{key:1,onClick:ee(j=>i(y.name),["stop"]),disabled:u.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[u.value===y.name&&h.value==="delete"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),s[40]||(s[40]=T(" Delete ",-1))],8,si)):b("",!0),o.value.docstatus===1?(t(),a("button",{key:2,onClick:ee(j=>_(y.name),["stop"]),disabled:u.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[u.value===y.name&&h.value==="cancel"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Le),{key:1,class:"w-3.5 h-3.5"})),s[41]||(s[41]=T(" Cancel ",-1))],8,ai)):b("",!0),o.value.docstatus===2?(t(),a("button",{key:3,onClick:ee(j=>i(y.name),["stop"]),disabled:u.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[u.value===y.name&&h.value==="delete"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),s[42]||(s[42]=T(" Delete ",-1))],8,li)):b("",!0)])])):(t(),a("div",ni,[(t(),a(U,null,E(3,j=>e("div",{key:j,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):b("",!0)]}),_:2},1024)])}),128))]),Q.value&&Y.value?(t(),a("div",oi,[d(n(se),{class:"w-5 h-5 text-gray-400 animate-spin"})])):b("",!0)]))]))}}),ii={class:"w-full min-w-0"},di={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},ci={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},ui={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},xi={class:"flex-1 min-w-0"},pi={class:"text-sm font-black text-white truncate"},mi={class:"text-emerald-400"},gi={class:"flex items-center gap-2 flex-shrink-0"},bi={key:0,class:"flex-1 flex items-center justify-center"},fi={class:"flex flex-col items-center gap-4"},yi={class:"relative"},vi={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},hi={key:1,class:"flex-1 flex items-center justify-center p-6"},_i={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},wi={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},ki={class:"text-xs text-red-500 mt-1 break-words"},$i=["src"],Ci={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Si={class:"flex items-start gap-3"},Di={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},Fi={class:"text-sm font-black text-gray-900"},ji={class:"text-xs text-gray-500 mt-1 leading-relaxed"},Pi={class:"flex gap-2 justify-end"},Ti={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Oi={class:"flex items-start gap-3"},Ai={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},Ni={class:"flex-1 min-w-0"},Ii={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},Li={class:"flex justify-end"},Ui={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},Ri={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},Mi={class:"text-sm sm:text-base font-black leading-tight"},Vi={class:"bg-gradient-to-br from-blue-600 to-blue-500 rounded-xl p-3 text-white"},zi={class:"text-sm sm:text-base font-black leading-tight"},qi={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},Bi={class:"text-sm sm:text-base font-black leading-tight"},Ei={class:"bg-gradient-to-br from-red-500 to-red-400 rounded-xl p-3 text-white"},Hi={class:"text-sm sm:text-base font-black leading-tight"},Wi={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},Yi={class:"flex flex-wrap items-center gap-2"},Gi={class:"flex items-center gap-2 flex-1 min-w-0"},Qi={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Ji={class:"min-w-0"},Xi={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Ki={key:0,class:"text-blue-500"},Zi={class:"relative"},ed={class:"flex flex-wrap gap-2 items-center"},td={class:"flex gap-1 flex-wrap"},sd=["onClick"],ad={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},ld=["max"],nd={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},od=["min"],rd={key:0,class:"p-6 space-y-3"},id={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},dd={class:"p-4 bg-gray-100 rounded-2xl mb-4"},cd={key:2},ud={class:"divide-y divide-gray-100/80"},xd=["onClick"],pd={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},md={class:"flex items-center gap-2 flex-wrap"},gd={class:"text-xs font-black text-gray-900"},bd={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold"},fd={class:"text-[10px] text-gray-500 font-medium truncate"},yd={class:"flex items-center gap-3 flex-wrap mt-0.5"},vd={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},hd={class:"text-[10px] font-black text-gray-900"},_d={key:0,class:"text-[9px] font-bold text-red-500"},wd={key:0,class:"mt-1.5 w-full bg-gray-200 rounded-full h-1"},kd={class:"hidden sm:flex items-center gap-1.5 min-w-0"},$d={class:"text-xs font-black text-gray-900 truncate"},Cd={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},Sd={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},Dd={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},Fd={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},jd={class:"hidden sm:flex flex-col items-end gap-1"},Pd={key:0,class:"w-16 bg-gray-200 rounded-full h-1"},Td={class:"hidden sm:flex justify-center"},Od={class:"flex justify-center text-gray-400"},Ad={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},Nd={key:0,class:"space-y-2"},Id={key:1,class:"space-y-4"},Ld={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},Ud={class:"bg-white rounded-xl p-3 border border-gray-100"},Rd={class:"bg-white rounded-xl p-3 border border-gray-100"},Md={class:"text-xs font-black text-green-700"},Vd={class:"bg-white rounded-xl p-3 border border-gray-100"},zd={class:"text-xs font-black text-gray-800"},qd={class:"bg-white rounded-xl p-3 border border-gray-100"},Bd={class:"text-xs font-black text-gray-800 truncate"},Ed={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},Hd={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},Wd={class:"min-w-0"},Yd={class:"text-xs font-semibold text-gray-800 truncate"},Gd={class:"text-[9px] text-gray-400 truncate"},Qd={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},Jd={class:"text-xs text-gray-600 text-center font-medium"},Xd={class:"text-xs text-gray-600 text-center"},Kd={class:"text-xs font-black text-gray-900 text-right"},Zd={class:"border-t border-gray-200 px-4 py-3 space-y-1.5"},ec={key:0,class:"flex justify-between text-xs text-gray-500"},tc={class:"flex justify-between items-center"},sc={class:"text-sm font-black text-gray-900"},ac={key:1,class:"flex justify-between items-center"},lc={class:"text-sm font-black text-red-600"},nc={key:1,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},oc={class:"divide-y divide-gray-100 max-h-36 overflow-y-auto"},rc={class:"text-xs text-gray-600 flex-shrink-0"},ic={class:"text-xs font-bold text-gray-500 truncate"},dc={class:"text-xs font-black text-gray-900 flex-shrink-0"},cc={class:"flex flex-wrap gap-2 justify-end pt-1"},uc=["onClick"],xc=["onClick","disabled"],pc=["onClick","disabled"],mc=["onClick","disabled"],gc=["onClick","disabled"],bc={key:2,class:"space-y-2"},fc={key:0,class:"flex justify-center py-4"},yc=Ce({__name:"SalesInvoiceList",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(m){const H=m,k=I(""),A=I(""),N=I(""),O=I("all"),w=I(null),o=I(null),u=I(""),h=I(""),v=I({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),C=I({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),M=I({show:!1,message:""}),K=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Unpaid",label:"Unpaid"},{key:"Paid",label:"Paid"},{key:"Overdue",label:"Overdue"},{key:"Cancelled",label:"Cancelled"}],B=We({doctype:"Sales Invoice",fields:["name","customer","customer_name","status","posting_date","grand_total","outstanding_amount","currency","docstatus","due_date","paid_amount","discount_amount","taxes_and_charges","is_return","return_against"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),Z=le({url:"frappe.client.get",makeParams:c=>({doctype:"Sales Invoice",name:c.name}),onSuccess(c){o.value=c}}),V=le({url:"frappe.client.submit",onSuccess(){u.value="",h.value="",B.reload(),w.value&&Z.fetch({name:w.value})},onError(c){u.value="",h.value="",ie((c==null?void 0:c.message)||(c==null?void 0:c.exc_type)||"Submit failed")}}),D=le({url:"frappe.client.cancel",onSuccess(){u.value="",h.value="",B.reload(),w.value&&Z.fetch({name:w.value})},onError(c){u.value="",h.value="",ie((c==null?void 0:c.message)||(c==null?void 0:c.exc_type)||"Cancel failed")}}),F=le({url:"frappe.client.delete",onSuccess(){u.value="",h.value="",w.value=null,o.value=null,B.reload()},onError(c){u.value="",h.value="",ie((c==null?void 0:c.message)||(c==null?void 0:c.exc_type)||"Delete failed")}});Se(()=>[H.customer,H.seller],([c])=>{const r=[];c&&r.push(["customer","=",c]),B.update({filters:r}),B.reload()},{immediate:!0});const X=R(()=>{let c=B.data||[];if(O.value!=="all"&&(O.value==="Draft"?c=c.filter(r=>r.docstatus===0):O.value==="Cancelled"?c=c.filter(r=>r.docstatus===2):c=c.filter(r=>r.status===O.value)),A.value&&(c=c.filter(r=>r.posting_date>=A.value)),N.value&&(c=c.filter(r=>r.posting_date<=N.value)),k.value.trim()){const r=k.value.toLowerCase();c=c.filter(p=>{var L,W;return((L=p.name)==null?void 0:L.toLowerCase().includes(r))||((W=p.customer_name)==null?void 0:W.toLowerCase().includes(r))})}return c}),ae=R(()=>A.value!==""||N.value!==""),Q=R(()=>B.loading),Y=R(()=>(B.data||[]).length>0),z=R(()=>{const r=(B.data||[]).filter(p=>p.docstatus===1);return{total:r.reduce((p,L)=>p+(L.grand_total||0),0),outstanding:r.reduce((p,L)=>p+(L.outstanding_amount||0),0),paid:r.reduce((p,L)=>p+(L.paid_amount||0),0),overdue:r.filter(p=>p.status==="Overdue").length}});function re(){A.value="",N.value="",O.value="all",k.value=""}function G(c){return c.docstatus===2?{label:"Cancelled",theme:"gray",icon:Le}:c.docstatus===0?{label:"Draft",theme:"orange",icon:Me}:c.status==="Paid"?{label:"Paid",theme:"green",icon:it}:c.status==="Overdue"?{label:"Overdue",theme:"red",icon:je}:c.status==="Unpaid"?{label:"Unpaid",theme:"blue",icon:qe}:c.status==="Partly Paid"?{label:"Part Paid",theme:"purple",icon:vt}:{label:c.status||"Unknown",theme:"gray",icon:ke}}const me={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function ne(c){return c.grand_total?Math.round(c.outstanding_amount/c.grand_total*100):0}function oe(c){w.value===c?(w.value=null,o.value=null):(w.value=c,o.value=null,Z.fetch({name:c}))}function ie(c){const r=c.replace(/<[^>]*>/g,"").trim().split(`
`)[0];M.value={show:!0,message:r}}function ve(c){return fe(this,null,function*(){var r,p,L,W,j,S;try{const g=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":xe()},body:JSON.stringify({doctype:"Print Format",filters:{doc_type:c,default_format:1,disabled:0},fieldname:"name"})});if(g.ok){const f=yield g.json(),J=(p=(r=f==null?void 0:f.message)==null?void 0:r.name)==null?void 0:p.trim();if(J)return console.log(`[PrintFormat] âœ… Step 1a (default_format=1 via POST) â†’ "${J}"`),J}}catch(g){console.warn("[PrintFormat] Step 1a error:",g)}try{const g=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":xe()},body:JSON.stringify({doctype:"Property Setter",filters:{doc_type:c,property:"default_print_format"},fieldname:"value"})});if(g.ok){const f=yield g.json(),J=(W=(L=f==null?void 0:f.message)==null?void 0:L.value)==null?void 0:W.trim();if(J)return console.log(`[PrintFormat] âœ… Step 1b (Property Setter via POST) â†’ "${J}"`),J}}catch(g){console.warn("[PrintFormat] Step 1b error:",g)}try{const g=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":xe()},body:JSON.stringify({doctype:"Print Format",filters:{doc_type:c,disabled:0,standard:"No"},fieldname:"name"})});if(g.ok){const f=yield g.json(),J=(S=(j=f==null?void 0:f.message)==null?void 0:j.name)==null?void 0:S.trim();if(J)return console.log(`[PrintFormat] âœ… Step 1c (first custom format via POST) â†’ "${J}"`),J}}catch(g){console.warn("[PrintFormat] Step 1c error:",g)}return console.log("[PrintFormat] âš ï¸ All steps failed â€” server default will be used (format=null)"),null})}function xe(){try{const c=document.cookie.match(/csrftoken=([^;]+)/);return c?c[1]:""}catch(c){return""}}function he(c){return fe(this,null,function*(){v.value={show:!0,loading:!0,blobUrl:"",docName:c,printFormat:"Detectingâ€¦",error:""};try{const r=yield ve("Sales Invoice");v.value.printFormat=r!=null?r:"Server Default";const p=yield ge(c,r);v.value={show:!0,loading:!1,blobUrl:URL.createObjectURL(p),docName:c,printFormat:r!=null?r:"Server Default",error:""}}catch(r){v.value={show:!0,loading:!1,blobUrl:"",docName:c,printFormat:"",error:(r==null?void 0:r.message)||"Failed to load PDF"}}})}function ge(c,r){return fe(this,null,function*(){const p=W=>{const j={doctype:"Sales Invoice",name:c,no_letterhead:"0",letterhead:"No Letterhead"};return W&&(j.format=W),"/api/method/frappe.utils.print_format.download_pdf?"+new URLSearchParams(j).toString()};if(r){const W=yield fetch(p(r),{credentials:"include"});if(W.ok){const j=yield W.blob();if(j.size>500)return console.log(`[PDF] âœ… PDF ready using format "${r}"`),j}console.warn(`[PDF] Format "${r}" failed, retrying without formatâ€¦`),v.value.printFormat="Server Default"}const L=yield fetch(p(),{credentials:"include"});if(L.ok){const W=yield L.blob();if(W.size>500)return console.log("[PDF] âœ… PDF ready using server default format"),W}throw new Error(`PDF generation failed â€” HTTP ${L.status}`)})}function be(){v.value.blobUrl&&URL.revokeObjectURL(v.value.blobUrl),v.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function _(){if(!v.value.blobUrl)return;const c=document.createElement("a");c.href=v.value.blobUrl,c.download=`${v.value.docName}.pdf`,c.click()}function i(c){C.value=Fe({show:!0},c)}function x(c){o.value&&i({title:"Submit Sales Invoice",message:`Submit ${c}? Accounting entries will be posted.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{C.value.show=!1,u.value=c,h.value="submit",V.fetch({doc:o.value})}})}function s(c){i({title:"Cancel Sales Invoice",message:`Cancel ${c}? All accounting entries will be reversed.`,confirmLabel:"Cancel Invoice",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{C.value.show=!1,u.value=c,h.value="cancel",D.fetch({doctype:"Sales Invoice",name:c})}})}function y(c){i({title:"Delete Sales Invoice",message:`Permanently delete ${c}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{C.value.show=!1,u.value=c,h.value="delete",F.fetch({doctype:"Sales Invoice",name:c})}})}return(c,r)=>(t(),a("div",ii,[(t(),P(Pe,{to:"body"},[d(we,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>[v.value.show?(t(),a("div",di,[e("div",ci,[e("div",ui,[d(n(Ae),{class:"w-4 h-4 text-white"})]),e("div",xi,[e("p",pi,l(v.value.docName),1),e("p",{class:$(["text-[10px] font-medium",v.value.loading?"text-gray-500 animate-pulse":"text-gray-400"])},[r[12]||(r[12]=T(" Format: ",-1)),e("span",mi,l(v.value.printFormat||"â€¦"),1)],2)]),e("div",gi,[v.value.blobUrl?(t(),a("button",{key:0,onClick:_,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[d(n(dt),{class:"w-3.5 h-3.5"}),r[13]||(r[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):b("",!0),e("button",{onClick:be,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[d(n(_e),{class:"w-4 h-4"})])])]),v.value.loading?(t(),a("div",bi,[e("div",fi,[e("div",yi,[e("div",vi,[d(n(ke),{class:"w-7 h-7 text-white/60"})]),r[14]||(r[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-emerald-400 border-t-transparent animate-spin"},null,-1))]),r[15]||(r[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Detecting default print format")],-1))])])):v.value.error?(t(),a("div",hi,[e("div",_i,[e("div",wi,[d(n(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[r[16]||(r[16]=e("p",{class:"text-sm font-black text-red-300"},"Failed to Load PDF",-1)),e("p",ki,l(v.value.error),1)]),e("button",{onClick:be,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Close ")])])):v.value.blobUrl?(t(),a("iframe",{key:2,src:v.value.blobUrl,class:"flex-1 w-full border-0",title:"Invoice Print Preview"},null,8,$i)):b("",!0)])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[d(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:q(()=>[C.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:r[2]||(r[2]=ee(p=>C.value.show=!1,["self"]))},[e("div",Ci,[e("div",Si,[e("div",Di,[d(n(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",Fi,l(C.value.title),1),e("p",ji,l(C.value.message),1)])]),e("div",Pi,[e("button",{onClick:r[0]||(r[0]=p=>C.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"},"Go Back"),e("button",{onClick:r[1]||(r[1]=p=>C.value.onConfirm()),class:$(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",C.value.confirmClass])},l(C.value.confirmLabel),3)])])])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[d(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>[M.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:r[4]||(r[4]=ee(p=>M.value.show=!1,["self"]))},[e("div",Ti,[e("div",Oi,[e("div",Ai,[d(n(Te),{class:"w-5 h-5 text-red-500"})]),e("div",Ni,[r[17]||(r[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Failed",-1)),e("p",Ii,l(M.value.message),1)])]),e("div",Li,[e("button",{onClick:r[3]||(r[3]=p=>M.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"},"OK")])])])):b("",!0)]),_:1})])),e("div",Ui,[e("div",Ri,[r[18]||(r[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total Billed",-1)),e("p",Mi,l(m.formatCurrency(z.value.total)),1)]),e("div",Vi,[r[19]||(r[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Outstanding",-1)),e("p",zi,l(m.formatCurrency(z.value.outstanding)),1)]),e("div",qi,[r[20]||(r[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Collected",-1)),e("p",Bi,l(m.formatCurrency(z.value.paid)),1)]),e("div",Ei,[r[21]||(r[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Overdue",-1)),e("p",Hi,l(z.value.overdue)+" invoice"+l(z.value.overdue!==1?"s":""),1)])]),e("div",Wi,[e("div",Yi,[e("div",Gi,[e("div",Qi,[d(n(ke),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Ji,[r[22]||(r[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Invoices",-1)),e("p",Xi,[T(l(X.value.length)+" record"+l(X.value.length!==1?"s":"")+" ",1),ae.value||O.value!=="all"||k.value?(t(),a("span",Ki," (filtered)")):b("",!0)])])]),e("button",{onClick:r[5]||(r[5]=p=>n(B).reload()),class:$(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",Q.value?"opacity-60 pointer-events-none":""])},[d(n(se),{class:$(["w-3.5 h-3.5",Q.value?"animate-spin":""])},null,8,["class"]),r[23]||(r[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Zi,[d(n(Ge),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),ce(e("input",{"onUpdate:modelValue":r[6]||(r[6]=p=>k.value=p),type:"text",placeholder:"Search invoice # or customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[pe,k.value]]),k.value?(t(),a("button",{key:0,onClick:r[7]||(r[7]=p=>k.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[d(n(ue),{class:"w-3.5 h-3.5"})])):b("",!0)]),e("div",ed,[e("div",td,[(t(),a(U,null,E(K,p=>e("button",{key:p.key,onClick:L=>O.value=p.key,class:$(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",O.value===p.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},l(p.label),11,sd)),64))]),e("div",ad,[r[24]||(r[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),ce(e("input",{type:"date","onUpdate:modelValue":r[8]||(r[8]=p=>A.value=p),max:N.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,ld),[[pe,A.value]]),A.value?(t(),a("button",{key:0,onClick:r[9]||(r[9]=p=>A.value=""),class:"text-gray-300 hover:text-red-400"},[d(n(ue),{class:"w-3 h-3"})])):b("",!0)]),e("div",nd,[r[25]||(r[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),ce(e("input",{type:"date","onUpdate:modelValue":r[10]||(r[10]=p=>N.value=p),min:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,od),[[pe,N.value]]),N.value?(t(),a("button",{key:0,onClick:r[11]||(r[11]=p=>N.value=""),class:"text-gray-300 hover:text-red-400"},[d(n(ue),{class:"w-3 h-3"})])):b("",!0)]),ae.value||O.value!=="all"||k.value?(t(),a("button",{key:0,onClick:re,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[d(n(ue),{class:"w-3 h-3"}),r[26]||(r[26]=T(" Clear All ",-1))])):b("",!0)])]),Q.value&&!Y.value?(t(),a("div",rd,[(t(),a(U,null,E(5,p=>e("div",{key:p,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!Q.value&&X.value.length===0?(t(),a("div",id,[e("div",dd,[d(n(ke),{class:"w-10 h-10 text-gray-300"})]),r[27]||(r[27]=e("p",{class:"text-sm font-black text-gray-300"},"No Invoices Found",-1)),r[28]||(r[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),a("div",cd,[r[43]||(r[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Invoice #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Grand Total"),e("span",{class:"text-right"},"Outstanding"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",ud,[(t(!0),a(U,null,E(X.value,p=>(t(),a("div",{key:p.name},[e("div",{onClick:L=>oe(p.name),class:$(["grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_36px]","gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5","hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none",p.status==="Overdue"?"bg-red-50/30":""])},[e("div",pd,[e("div",md,[e("span",gd,l(p.name),1),p.is_return?(t(),a("span",bd,"Return")):b("",!0),e("span",{class:$(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",me[G(p).theme]])},[(t(),P(ye(G(p).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(G(p).label),1)],2)]),e("span",fd,l(p.customer_name),1),e("div",yd,[e("span",vd,[d(n($e),{class:"w-2.5 h-2.5"}),T(l(p.posting_date),1)]),e("span",hd,l(m.formatCurrency(p.grand_total,p.currency)),1),p.outstanding_amount>0?(t(),a("span",_d,"Due: "+l(m.formatCurrency(p.outstanding_amount,p.currency)),1)):b("",!0)]),p.docstatus===1&&p.grand_total>0?(t(),a("div",wd,[e("div",{style:Xe({width:`${100-ne(p)}%`}),class:$(["h-1 rounded-full transition-all",p.status==="Paid"?"bg-green-500":p.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):b("",!0)]),e("div",kd,[e("span",$d,l(p.name),1),p.is_return?(t(),a("span",Cd,"Return")):b("",!0)]),e("span",Sd,l(p.customer_name),1),e("span",Dd,[d(n($e),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),T(l(p.posting_date),1)]),e("span",Fd,l(m.formatCurrency(p.grand_total,p.currency)),1),e("div",jd,[e("span",{class:$(["text-xs font-black",p.outstanding_amount>0?"text-red-600":"text-gray-400"])},l(p.outstanding_amount>0?m.formatCurrency(p.outstanding_amount,p.currency):"â€”"),3),p.docstatus===1&&p.grand_total>0?(t(),a("div",Pd,[e("div",{style:Xe({width:`${100-ne(p)}%`}),class:$(["h-1 rounded-full",p.status==="Paid"?"bg-green-500":p.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):b("",!0)]),e("span",Td,[e("span",{class:$(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",me[G(p).theme]])},[(t(),P(ye(G(p).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(G(p).label),1)],2)]),e("div",Od,[w.value===p.name?(t(),P(n(Ue),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),P(n(Re),{key:1,class:"w-4 h-4"}))])],10,xd),d(we,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:q(()=>{var L,W;return[w.value===p.name?(t(),a("div",Ad,[n(Z).loading&&!o.value?(t(),a("div",Nd,[(t(),a(U,null,E(4,j=>e("div",{key:j,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):o.value&&o.value.name===p.name?(t(),a("div",Id,[e("div",Ld,[e("div",Ud,[r[29]||(r[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Due Date",-1)),e("p",{class:$(["text-xs font-black",o.value.status==="Overdue"?"text-red-600":"text-gray-800"])},l(o.value.due_date||"â€”"),3)]),e("div",Rd,[r[30]||(r[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid Amount",-1)),e("p",Md,l(m.formatCurrency(o.value.paid_amount||0,o.value.currency)),1)]),e("div",Vd,[r[31]||(r[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Discount",-1)),e("p",zd,l(m.formatCurrency(o.value.discount_amount||0,o.value.currency)),1)]),e("div",qd,[r[32]||(r[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Tax Template",-1)),e("p",Bd,l(o.value.taxes_and_charges||"â€”"),1)])]),(L=o.value.items)!=null&&L.length?(t(),a("div",Ed,[r[36]||(r[36]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",Hd,[(t(!0),a(U,null,E(o.value.items,j=>(t(),a("div",{key:j.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",Wd,[e("p",Yd,l(j.item_name),1),e("p",Gd,l(j.item_code),1),j.delivery_note?(t(),a("p",Qd,"DN: "+l(j.delivery_note),1)):b("",!0)]),e("span",Jd,l(j.qty)+" "+l(j.uom),1),e("span",Xd,l(m.formatCurrency(j.rate,o.value.currency)),1),e("span",Kd,l(m.formatCurrency(j.amount,o.value.currency)),1)]))),128))]),e("div",Zd,[o.value.total_taxes_and_charges?(t(),a("div",ec,[r[33]||(r[33]=e("span",null,"Taxes",-1)),e("span",null,l(m.formatCurrency(o.value.total_taxes_and_charges,o.value.currency)),1)])):b("",!0),e("div",tc,[r[34]||(r[34]=e("span",{class:"text-xs font-black text-gray-500 uppercase tracking-wide"},"Grand Total",-1)),e("span",sc,l(m.formatCurrency(o.value.grand_total,o.value.currency)),1)]),o.value.outstanding_amount>0?(t(),a("div",ac,[r[35]||(r[35]=e("span",{class:"text-xs font-bold text-red-500 uppercase tracking-wide"},"Outstanding",-1)),e("span",lc,l(m.formatCurrency(o.value.outstanding_amount,o.value.currency)),1)])):b("",!0)])])):b("",!0),(W=o.value.payment_schedule)!=null&&W.length?(t(),a("div",nc,[r[37]||(r[37]=e("div",{class:"px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[10px] font-black text-gray-500 uppercase tracking-widest"},"Payment Schedule",-1)),e("div",oc,[(t(!0),a(U,null,E(o.value.payment_schedule,j=>(t(),a("div",{key:j.name,class:"flex items-center justify-between gap-2 px-4 py-2.5"},[e("span",rc,l(j.due_date),1),e("span",ic,l(j.payment_term),1),e("span",dc,l(m.formatCurrency(j.payment_amount,o.value.currency)),1),e("span",{class:$(["text-[9px] font-bold px-1.5 py-0.5 rounded-full flex-shrink-0",j.outstanding>0?"bg-red-50 text-red-600":"bg-green-50 text-green-600"])},l(j.outstanding>0?"Due":"Paid"),3)]))),128))])])):b("",!0),e("div",cc,[e("button",{onClick:ee(j=>he(p.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[d(n(Ae),{class:"w-3.5 h-3.5"}),r[38]||(r[38]=T("Print / PDF ",-1))],8,uc),o.value.docstatus===0?(t(),a("button",{key:0,onClick:ee(j=>x(p.name),["stop"]),disabled:u.value===p.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[u.value===p.name&&h.value==="submit"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(ct),{key:1,class:"w-3.5 h-3.5"})),r[39]||(r[39]=T("Submit ",-1))],8,xc)):b("",!0),o.value.docstatus===0?(t(),a("button",{key:1,onClick:ee(j=>y(p.name),["stop"]),disabled:u.value===p.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[u.value===p.name&&h.value==="delete"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),r[40]||(r[40]=T("Delete ",-1))],8,pc)):b("",!0),o.value.docstatus===1?(t(),a("button",{key:2,onClick:ee(j=>s(p.name),["stop"]),disabled:u.value===p.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[u.value===p.name&&h.value==="cancel"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Le),{key:1,class:"w-3.5 h-3.5"})),r[41]||(r[41]=T("Cancel ",-1))],8,mc)):b("",!0),o.value.docstatus===2?(t(),a("button",{key:3,onClick:ee(j=>y(p.name),["stop"]),disabled:u.value===p.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[u.value===p.name&&h.value==="delete"?(t(),P(n(se),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),r[42]||(r[42]=T("Delete ",-1))],8,gc)):b("",!0)])])):(t(),a("div",bc,[(t(),a(U,null,E(3,j=>e("div",{key:j,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):b("",!0)]}),_:2},1024)]))),128))]),Q.value&&Y.value?(t(),a("div",fc,[d(n(se),{class:"w-5 h-5 text-gray-400 animate-spin"})])):b("",!0)]))]))}}),vc={class:"w-full min-w-0 max-w-7xl mx-auto font-sans text-gray-900 px-0 sm:px-4 md:px-6 pt-[env(safe-area-inset-top,0px)] pb-[calc(120px+env(safe-area-inset-bottom,0px))] sm:pb-[env(safe-area-inset-bottom,16px)] space-y-3 sm:space-y-4 md:space-y-5"},hc={class:"hidden sm:flex items-center justify-between gap-2 pt-1 flex-wrap"},_c={class:"flex gap-1 bg-gray-100 p-1 rounded-xl"},wc=["onClick"],kc={class:"px-2 sm:px-0"},$c={class:"bg-white border-y sm:border border-gray-100 sm:rounded-2xl shadow-sm overflow-hidden w-full min-w-0"},Cc={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24 text-center px-6"},Sc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Dc={class:"hidden sm:block border-b border-gray-100 overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden"},Fc={class:"flex min-w-max"},jc=["onClick"],Pc={key:0,class:"absolute bottom-0 left-0 right-0 h-[2.5px] bg-gray-900 rounded-t-full"},Tc={key:0,class:"sm:hidden flex items-center gap-2 px-3 py-2.5 border-b border-gray-100 bg-gray-50/60"},Oc={class:"text-sm font-black text-gray-800"},Ac={key:1,class:"flex flex-col items-center justify-center py-16 sm:py-24 text-center px-6"},Nc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Ic={key:2,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},Lc={class:"w-full flex justify-end px-3 pb-4"},Uc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Rc={class:"border-b border-gray-100 bg-gray-50/60"},Mc={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pt-3 pb-2"},Vc={class:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0"},zc={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},qc={class:"min-w-0"},Bc={class:"flex items-center gap-1.5 flex-wrap mt-0.5"},Ec={class:"text-[10px] sm:text-xs text-gray-400 font-medium"},Hc={key:0},Wc={key:1},Yc={key:2},Gc={key:3},Qc={class:"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end"},Jc={class:"flex items-center justify-center w-5 h-5 bg-white/20 rounded-md flex-shrink-0"},Xc=["disabled","title"],Kc={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pb-3"},Zc={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},e0=["max"],t0={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},s0=["min"],a0={key:1,class:"text-[10px] text-gray-400 font-semibold"},l0={key:6,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},n0={class:"w-full flex justify-end px-3 pb-4"},o0={class:"p-4 bg-gray-100 rounded-2xl mb-4"},r0={key:7,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},i0={class:"w-full flex justify-end px-3 pb-4"},d0={class:"p-4 bg-gray-100 rounded-2xl mb-4"},c0={key:1,class:"px-2 sm:px-0"},u0={class:"sm:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/96 backdrop-blur-xl border-t border-gray-200 pb-[env(safe-area-inset-bottom,0px)] shadow-[0_-4px_32px_rgba(0,0,0,0.10)]",style:{"will-change":"transform"}},x0={class:"flex border-b border-gray-100"},p0=["onClick"],m0={key:0,class:"flex overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden overscroll-x-contain"},g0=["onClick"],b0={key:0,class:"absolute top-0 left-1/2 -translate-x-1/2 w-6 h-[2px] bg-gray-900 rounded-b-full"},f0={class:"leading-tight text-center whitespace-nowrap"},y0={key:1,class:"flex items-center justify-center py-2 px-4"},w0=Ce({__name:"SellerHomeComponent",props:{filters:{}},emits:["dialog-open"],setup(m,{emit:H}){const k=m,A=yt("showToast"),N=H,O=I("dashboard"),w=[{key:"dashboard",label:"Dashboard",icon:wt},{key:"customers",label:"My Customers",icon:at}],o=I(null),u=[{key:"quotation",label:"Quotation",shortLabel:"Quote",icon:Ke},{key:"salesorder",label:"Sales Order",shortLabel:"SO",icon:Ve},{key:"delivery",label:"Delivery Note",shortLabel:"Delivery",icon:Oe},{key:"invoice",label:"Sales Invoice",shortLabel:"Invoice",icon:ke},{key:"payment",label:"Payment",shortLabel:"Payment",icon:qe},{key:"customer_ledger",label:"Customer Ledger",shortLabel:"Ledger",icon:Ze}],h=R(()=>o.value?u.find(S=>S.key===o.value):null),v=R(()=>!!k.filters.customer),C=I("all"),M=I(""),K=I(""),B=R(()=>M.value!==""||K.value!=="");function Z(){M.value="",K.value=""}const V=I(!1),D=I(!1),F=I(""),X=I(""),ae=I(null),Q=I(null);Se([V,D],([S,g])=>{N("dialog-open",S||g)});const Y=We({doctype:"Sales Order",fields:["name","customer","customer_name","status","grand_total","currency","docstatus","per_delivered","per_billed","transaction_date","custom_subscription_refereance"],filters:{},orderBy:"transaction_date desc",pageLength:200,auto:!0}),z=le({url:"frappe.client.get",makeParams:S=>({doctype:"Sales Order",name:S.name}),onSuccess(S){Q.value=S}}),re=le({url:"my_frappe_app.api.process_order_workflow",auto:!1}),G=le({url:"my_frappe_app.api.get_seller_subscriptions"}),me=le({url:"my_frappe_app.api.process_subscription",onSuccess(S){X.value="",S.status==="success"?(A(S.message,"success"),G.fetch({seller:ne.value})):A(S.message||"Operation failed","error")},onError(S){X.value="",A((S==null?void 0:S.message)||"Error","error")}}),ne=R(()=>k.filters.seller||""),oe=R(()=>k.filters.customer||""),ie=R(()=>{const S=(k.filters.category||"").toLowerCase();return S.includes("newspaper")||S.includes("news paper")}),ve=R(()=>{var g;return!oe.value||!ie.value?[]:(((g=G.data)==null?void 0:g.subscriptions)||[]).filter(f=>f.customer===oe.value||f.customer_name===oe.value)}),xe=R(()=>{const S=Y.data||[];return B.value?S.filter(g=>{const f=g.transaction_date||"";return!(M.value&&f<M.value||K.value&&f>K.value)}):S}),he=R(()=>{const S=[],g=ie.value&&!!oe.value;if(g&&(C.value==="all"||C.value==="subscription_pending"))for(const f of ve.value)C.value==="subscription_pending"&&f.status!=="Accept Pending"||S.push(Fe({row_type:"subscription"},f));if(C.value!=="subscription_pending")for(const f of xe.value){const J=!!f.custom_subscription_refereance;J&&!g||C.value==="daily"&&!J||C.value==="normal"&&J||S.push(Fe({row_type:"order"},f))}return S}),ge=R(()=>he.value.filter(S=>S.row_type==="order").length),be=R(()=>{const S=ve.value,g=Y.data||[];return{subPending:S.filter(f=>f.status==="Accept Pending").length,subActive:S.filter(f=>f.status==="Active").length,orderPending:g.filter(f=>Number(f.docstatus)===0&&!f.custom_subscription_refereance).length,toDeliver:g.filter(f=>{var J;return Number(f.docstatus)===1&&Number((J=f.per_delivered)!=null?J:0)<100}).length,completed:g.filter(f=>{var J;return Number((J=f.per_delivered)!=null?J:0)>=100}).length}}),_=R(()=>(Y.data||[]).filter(S=>{var g,f;return Number(S.docstatus)===1&&Number((g=S.per_delivered)!=null?g:0)>0&&Number((f=S.per_billed)!=null?f:100)<100})),i=R(()=>o.value==="salesorder"?G.loading||Y.loading:!1);Se(()=>[k.filters.customer,k.filters.seller],([S,g])=>{S&&(Y.update({filters:{customer:S}}),Y.reload()),g&&G.fetch({seller:g})},{immediate:!0});function x(S){return["Completed","To Bill","To Deliver"].includes(S)?"green":S==="Draft"?"red":S==="Cancelled"?"gray":"orange"}function s(S,g="INR"){return new Intl.NumberFormat("en-IN",{style:"currency",currency:g}).format(S)}function y(S){Q.value=null,V.value=!0,z.fetch({name:S.name})}function c(S,g){return fe(this,null,function*(){F.value=S;try{const f=yield re.submit({order_id:S,action:g});(f==null?void 0:f.status)==="success"?(A(f.message,"success"),yield Y.reload(),V.value&&z.fetch({name:S})):A((f==null?void 0:f.message)||"Operation Failed","error")}catch(f){A((f==null?void 0:f.message)||"System Error","error")}finally{F.value=""}})}function r(S,g){X.value=S,me.fetch({sub_name:S,action:g})}function p(S){ae.value=ae.value===S?null:S}function L(){o.value=null,G.fetch({seller:ne.value}),Y.reload()}function W(S){A(`Invoice ${S} created successfully!`,"success"),Y.reload()}function j(){}return(S,g)=>(t(),a(U,null,[e("div",vc,[e("div",hc,[e("div",_c,[(t(),a(U,null,E(w,f=>e("button",{key:f.key,onClick:J=>O.value=f.key,class:$(["flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-bold transition-all whitespace-nowrap",O.value===f.key?"bg-gray-900 text-white shadow-sm":"text-gray-500 hover:text-gray-700"])},[(t(),P(ye(f.icon),{class:"w-4 h-4 flex-shrink-0"})),T(" "+l(f.label),1)],10,wc)),64))]),d(n(de),{variant:"outline",size:"sm",loading:n(G).loading||n(Y).loading,class:"text-sm",onClick:L},{prefix:q(()=>[d(n(se),{class:"w-4 h-4"})]),default:q(()=>[g[10]||(g[10]=T(" Refresh ",-1))]),_:1},8,["loading"])]),O.value==="dashboard"?(t(),a(U,{key:0},[e("div",kc,[d(Rt,{stats:be.value,"active-filter":C.value,"onUpdate:activeFilter":g[0]||(g[0]=f=>C.value=f)},null,8,["stats","active-filter"])]),e("div",$c,[v.value?(t(),a(U,{key:1},[e("div",Dc,[e("div",Fc,[(t(),a(U,null,E(u,f=>e("button",{key:f.key,onClick:J=>o.value=f.key,class:$(["relative flex items-center gap-2 px-5 md:px-7 py-3.5 text-sm font-bold transition-all whitespace-nowrap",o.value===f.key?"text-gray-900 bg-gray-50/80":"text-gray-400 hover:text-gray-600 hover:bg-gray-50/40"])},[o.value===f.key?(t(),a("span",Pc)):b("",!0),(t(),P(ye(f.icon),{class:"w-4 h-4 flex-shrink-0"})),T(" "+l(f.label),1)],10,jc)),64))])]),h.value?(t(),a("div",Tc,[(t(),P(ye(h.value.icon),{class:"w-4 h-4 text-gray-700 flex-shrink-0"})),e("span",Oc,l(h.value.label),1)])):b("",!0),o.value===null?(t(),a("div",Ac,[e("div",Nc,[d(n(Ve),{class:"w-10 h-10 text-gray-300"})]),g[13]||(g[13]=e("p",{class:"text-sm font-black text-gray-400"},"Select a Tab",-1)),g[14]||(g[14]=e("p",{class:"text-xs text-gray-300 mt-1.5"},"Choose a section above to get started.",-1))])):o.value==="quotation"?(t(),a("div",Ic,[e("div",Lc,[e("button",{onClick:L,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[d(n(se),{class:"w-3.5 h-3.5"}),g[15]||(g[15]=T(" Refresh ",-1))])]),e("div",Uc,[d(n(Ke),{class:"w-10 h-10 text-gray-300"})]),g[16]||(g[16]=e("p",{class:"text-base font-black text-gray-300"},"Quotation",-1)),g[17]||(g[17]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):o.value==="salesorder"?(t(),a(U,{key:3},[e("div",Rc,[e("div",Mc,[e("div",Vc,[e("div",zc,[d(n(Ve),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",qc,[g[18]||(g[18]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Orders",-1)),e("div",Bc,[e("span",Ec,[C.value==="all"?(t(),a("span",Hc,"All â€” Subscriptions & Orders")):C.value==="subscription_pending"?(t(),a("span",Wc,"Subscription Requests")):C.value==="daily"?(t(),a("span",Yc,"Daily Auto-Orders")):C.value==="normal"?(t(),a("span",Gc,"Normal Orders")):b("",!0)])])])]),e("div",Qc,[e("button",{onClick:j,class:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-colors whitespace-nowrap shadow-sm"},[e("span",Jc,[d(n(ht),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),g[19]||(g[19]=e("span",{class:"hidden sm:inline"},"Create Sales Order",-1)),g[20]||(g[20]=e("span",{class:"sm:hidden"},"New SO",-1))]),e("button",{onClick:g[1]||(g[1]=f=>_.value.length>0?D.value=!0:void 0),disabled:_.value.length===0,class:$(["flex items-center gap-1.5 sm:gap-2 font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-all whitespace-nowrap shadow-sm",_.value.length>0?"bg-green-600 hover:bg-green-700 active:bg-green-800 text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"]),title:_.value.length===0?"No eligible orders to invoice":`${_.value.length} orders eligible`},[e("span",{class:$(["flex items-center justify-center w-5 h-5 rounded-md flex-shrink-0",_.value.length>0?"bg-white/20":"bg-gray-300/50"])},[d(n(ke),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})],2),g[21]||(g[21]=e("span",{class:"hidden sm:inline"},"Create Invoice",-1)),g[22]||(g[22]=e("span",{class:"sm:hidden"},"Invoice",-1)),e("span",{class:$(["text-[10px] font-black px-1.5 py-0.5 rounded-full leading-none",_.value.length>0?"bg-white/25 text-white":"bg-gray-300 text-gray-500"])},l(_.value.length),3)],10,Xc),C.value!=="all"?(t(),a("button",{key:0,onClick:g[2]||(g[2]=f=>C.value="all"),class:"flex items-center gap-1 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-gray-600 text-xs font-semibold px-2.5 py-2 rounded-lg transition-all whitespace-nowrap"},[d(n(ue),{class:"w-3.5 h-3.5 flex-shrink-0"}),g[23]||(g[23]=T(" Clear ",-1))])):b("",!0),e("button",{onClick:L,class:$(["flex items-center gap-1.5 px-2.5 sm:px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-xs font-semibold text-gray-600 transition-all",i.value?"opacity-60 pointer-events-none":""])},[d(n(se),{class:$(["w-3.5 h-3.5 flex-shrink-0",i.value?"animate-spin":""])},null,8,["class"]),g[24]||(g[24]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)])]),e("div",Kc,[e("div",Zc,[g[25]||(g[25]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"From",-1)),ce(e("input",{type:"date","onUpdate:modelValue":g[3]||(g[3]=f=>M.value=f),max:K.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,e0),[[pe,M.value]]),M.value?(t(),a("button",{key:0,onClick:g[4]||(g[4]=ee(f=>M.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[d(n(ue),{class:"w-3 h-3"})])):b("",!0)]),e("div",t0,[g[26]||(g[26]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"To",-1)),ce(e("input",{type:"date","onUpdate:modelValue":g[5]||(g[5]=f=>K.value=f),min:M.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,s0),[[pe,K.value]]),K.value?(t(),a("button",{key:0,onClick:g[6]||(g[6]=ee(f=>K.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[d(n(ue),{class:"w-3 h-3"})])):b("",!0)]),B.value?(t(),a("button",{key:0,onClick:Z,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[d(n(ue),{class:"w-3 h-3"}),g[27]||(g[27]=T(" Clear Dates ",-1))])):b("",!0),B.value?(t(),a("span",a0,l(ge.value)+" orders ",1)):b("",!0)])]),d($s,{"combined-rows":he.value,loading:n(G).loading||n(Y).loading,"active-filter":C.value,"expanded-sub-id":ae.value,"processing-sub-id":X.value,"processing-id":F.value,"format-currency":s,"get-status-theme":x,onToggleSubExpand:p,onSubAction:r,onOpenOrderDetail:y,onOrderAction:c,onShowAll:g[7]||(g[7]=f=>C.value="all")},null,8,["combined-rows","loading","active-filter","expanded-sub-id","processing-sub-id","processing-id"])],64)):o.value==="delivery"?(t(),P(ri,{key:4,customer:oe.value,seller:ne.value,"format-currency":s},null,8,["customer","seller"])):o.value==="invoice"?(t(),P(yc,{key:5,customer:oe.value,seller:ne.value,"format-currency":s},null,8,["customer","seller"])):o.value==="payment"?(t(),a("div",l0,[e("div",n0,[e("button",{onClick:L,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[d(n(se),{class:"w-3.5 h-3.5"}),g[28]||(g[28]=T(" Refresh ",-1))])]),e("div",o0,[d(n(qe),{class:"w-10 h-10 text-gray-300"})]),g[29]||(g[29]=e("p",{class:"text-base font-black text-gray-300"},"Payment",-1)),g[30]||(g[30]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):o.value==="customer_ledger"?(t(),a("div",r0,[e("div",i0,[e("button",{onClick:L,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[d(n(se),{class:"w-3.5 h-3.5"}),g[31]||(g[31]=T(" Refresh ",-1))])]),e("div",d0,[d(n(Ze),{class:"w-10 h-10 text-gray-300"})]),g[32]||(g[32]=e("p",{class:"text-base font-black text-gray-300"},"Customer Ledger",-1)),g[33]||(g[33]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):b("",!0)],64)):(t(),a("div",Cc,[e("div",Sc,[d(n(Ct),{class:"w-10 h-10 text-gray-300"})]),g[11]||(g[11]=e("p",{class:"text-sm font-black text-gray-400"},"No Customer Selected",-1)),g[12]||(g[12]=e("p",{class:"text-xs text-gray-300 mt-1.5 max-w-xs leading-relaxed"}," Select a customer from the sidebar to view their selling cycle â€” quotations, orders, deliveries, invoices and more. ",-1))]))])],64)):b("",!0),O.value==="customers"?(t(),a("div",c0,[d(xl,{seller:ne.value},null,8,["seller"])])):b("",!0),d(ea,{modelValue:V.value,"onUpdate:modelValue":g[8]||(g[8]=f=>V.value=f),"order-details":Q.value,"processing-id":F.value,"format-currency":s,"get-status-theme":x,onOrderAction:c},null,8,["modelValue","order-details","processing-id"]),d(Zn,{modelValue:D.value,"onUpdate:modelValue":g[9]||(g[9]=f=>D.value=f),"eligible-orders":_.value,seller:ne.value,"format-currency":s,onInvoiceCreated:W},null,8,["modelValue","eligible-orders","seller"])]),e("nav",u0,[e("div",x0,[(t(),a(U,null,E(w,f=>e("button",{key:f.key,onClick:J=>O.value=f.key,class:$(["flex-1 flex flex-col items-center justify-center gap-0.5 py-2 px-1 text-[10px] font-bold transition-all active:scale-95",O.value===f.key?"text-gray-900":"text-gray-400"])},[e("div",{class:$(["p-1.5 rounded-xl transition-all",O.value===f.key?"bg-gray-900 text-white":"text-gray-400"])},[(t(),P(ye(f.icon),{class:"w-4 h-4"}))],2),T(" "+l(f.label),1)],10,p0)),64))]),O.value==="dashboard"&&v.value?(t(),a("div",m0,[(t(),a(U,null,E(u,f=>e("button",{key:f.key,onClick:J=>o.value=f.key,class:$(["relative flex-shrink-0 flex flex-col items-center justify-center gap-0.5","px-3 py-2 min-w-[58px] text-[9px] font-bold transition-all active:scale-95",o.value===f.key?"text-gray-900":"text-gray-400"])},[o.value===f.key?(t(),a("span",b0)):b("",!0),(t(),P(ye(f.icon),{class:$(["w-[18px] h-[18px] transition-all",o.value===f.key?"text-gray-900":"text-gray-400"])},null,8,["class"])),e("span",f0,l(f.shortLabel),1)],10,g0)),64))])):O.value==="dashboard"&&!v.value?(t(),a("div",y0,[...g[34]||(g[34]=[e("p",{class:"text-[9px] text-gray-300 font-medium"},"Select a customer to view selling cycle",-1)])])):b("",!0)])],64))}});export{w0 as default};
