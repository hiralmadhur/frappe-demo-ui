var ut=Object.defineProperty;var Qe=Object.getOwnPropertySymbols;var xt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Je=(g,M,k)=>M in g?ut(g,M,{enumerable:!0,configurable:!0,writable:!0,value:k}):g[M]=k,De=(g,M)=>{for(var k in M||(M={}))xt.call(M,k)&&Je(g,k,M[k]);if(Qe)for(var k of Qe(M))pt.call(M,k)&&Je(g,k,M[k]);return g};var fe=(g,M,k)=>new Promise((O,A)=>{var S=x=>{try{i(k.next(x))}catch(_){A(_)}},w=x=>{try{i(k.throw(x))}catch(_){A(_)}},i=x=>x.done?O(x.value):Promise.resolve(x.value).then(S,w);i((k=k.apply(g,M)).next())});import{c as Z,d as $e,o as t,a,b as e,n as $,t as l,e as c,u as n,C as Ne,f as mt,_ as He,g as b,F as I,r as B,h as T,w as z,i as X,j as oe,k as P,l as Ue,m as Re,p as R,q as le,s as gt,v as ie,x as pe,y as st,U as at,z as N,M as bt,A as je,B as Fe,X as he,D as ft,E as We,T as Pe,G as _e,H as ye,I as Xe,S as Ve,J as yt}from"./index.js";import{N as Se,C as Me,T as Oe,P as Ye,a as lt,S as ze,_ as nt,b as ke,F as ot,D as rt,R as ee,c as re,d as Ie,e as vt,f as Ke,g as ht}from"./truck.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=Z("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=Z("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=Z("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=Z("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=Z("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=Z("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=Z("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Z("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=Z("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=Z("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=Z("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=Z("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=Z("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Z("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=Z("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=Z("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Z("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=Z("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=Z("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),St={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3 md:gap-4"},Dt={class:"min-w-0"},Ft={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-green-100 shadow-sm flex items-center justify-between"},jt={class:"min-w-0"},Pt={class:"text-2xl sm:text-3xl font-black text-gray-900"},Tt={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-green-50 flex items-center justify-center text-green-600 flex-shrink-0 ml-2"},Ot={class:"min-w-0"},At={class:"min-w-0"},Nt={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-emerald-100 shadow-sm flex items-center justify-between col-span-2 sm:col-span-1"},It={class:"min-w-0"},Lt={class:"text-2xl sm:text-3xl font-black text-gray-900"},Ut={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-600 flex-shrink-0 ml-2"},Rt=$e({__name:"SellerStatsCards",props:{stats:{},activeFilter:{}},emits:["update:activeFilter"],setup(g,{emit:M}){const k=g,O=M,A=S=>{O("update:activeFilter",k.activeFilter===S?"all":S)};return(S,w)=>(t(),a("div",St,[e("button",{onClick:w[0]||(w[0]=i=>A("subscription_pending")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",g.activeFilter==="subscription_pending"?"bg-amber-500 border-amber-500":"bg-white border-amber-100 hover:border-amber-300"])},[e("div",Dt,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",g.activeFilter==="subscription_pending"?"text-amber-100":"text-amber-400"])}," Sub Pending ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",g.activeFilter==="subscription_pending"?"text-white":"text-gray-900"])},l(g.stats.subPending),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",g.activeFilter==="subscription_pending"?"bg-amber-400 text-white":"bg-amber-50 text-amber-500 hover:bg-amber-500 hover:text-white"])},[c(n(Se),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",Ft,[e("div",jt,[w[3]||(w[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1 truncate"}," Sub Active ",-1)),e("p",Pt,l(g.stats.subActive),1)]),e("div",Tt,[c(n(Ne),{class:"w-4 h-4 sm:w-5 sm:h-5"})])]),e("button",{onClick:w[1]||(w[1]=i=>A("normal")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",g.activeFilter==="normal"?"bg-orange-500 border-orange-500":"bg-white border-orange-100 hover:border-orange-300"])},[e("div",Ot,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",g.activeFilter==="normal"?"text-orange-100":"text-orange-400"])}," To Accept ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",g.activeFilter==="normal"?"text-white":"text-gray-900"])},l(g.stats.orderPending),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",g.activeFilter==="normal"?"bg-orange-400 text-white":"bg-orange-50 text-orange-500 hover:bg-orange-500 hover:text-white"])},[c(n(Me),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("button",{onClick:w[2]||(w[2]=i=>A("daily")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",g.activeFilter==="daily"?"bg-blue-600 border-blue-600":"bg-white border-blue-100 hover:border-blue-300"])},[e("div",At,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",g.activeFilter==="daily"?"text-blue-200":"text-blue-400"])}," Daily Orders ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",g.activeFilter==="daily"?"text-white":"text-gray-900"])},l(g.stats.toDeliver),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",g.activeFilter==="daily"?"bg-blue-500 text-white":"bg-blue-50 text-blue-500 hover:bg-blue-600 hover:text-white"])},[c(n(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",Nt,[e("div",It,[w[4]||(w[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-emerald-500 uppercase tracking-widest mb-1 truncate"}," Completed ",-1)),e("p",Lt,l(g.stats.completed),1)]),e("div",Ut,[c(n(Ne),{class:"w-4 h-4 sm:w-5 sm:h-5"})])])]))}}),Mt={class:"w-full min-w-0"},Vt={class:"min-h-[300px] sm:min-h-[400px]"},zt={key:0,class:"flex flex-col items-center justify-center py-20 sm:py-32"},qt={key:1,class:"flex flex-col items-center justify-center py-20 sm:py-32 px-4 text-center"},Bt={key:2,class:"divide-y divide-gray-50"},Et={class:"flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2"},Ht={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},Wt={class:"min-w-0 flex-1"},Yt={class:"flex items-center gap-1.5 flex-wrap"},Gt={class:"font-black text-gray-900 font-mono text-xs sm:text-sm"},Qt={class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-amber-200"},Jt={class:"text-[10px] sm:text-xs text-gray-500 mt-0.5 flex flex-wrap gap-x-1"},Xt={class:"font-semibold text-gray-700 truncate max-w-[140px] sm:max-w-none"},Kt={class:"text-gray-400 text-[9px] sm:text-[10px]"},Zt={class:"text-[9px] sm:text-[10px] text-gray-400 mt-0.5 truncate"},es={class:"font-semibold text-gray-600"},ts={class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap"},ss={class:"flex items-center gap-1 bg-green-100 border border-green-200 rounded-lg px-2 py-1"},as=["onClick"],ls={key:0,class:"px-3 sm:px-5 pb-4 pt-0 border-t border-amber-100/80 bg-white/50 space-y-3"},ns={key:0,class:"mt-3 flex items-start gap-2 bg-amber-50 border border-amber-200 rounded-xl px-3 py-2.5"},os={class:"flex items-center justify-between px-3 sm:px-4 py-2 bg-white border-b border-gray-100"},rs={class:"text-[11px] sm:text-xs font-bold text-gray-800 truncate mr-2"},is={key:0,class:"text-[8px] sm:text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded font-bold flex-shrink-0"},ds={class:"p-2 sm:p-3 flex gap-1.5 flex-wrap"},cs={class:"text-[8px] sm:text-[9px] uppercase tracking-wide"},us={key:0,class:"text-xs sm:text-sm font-black leading-tight mt-0.5"},xs={key:1,class:"text-[9px] opacity-30 mt-0.5"},ps=["onClick"],ms={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},gs={class:"min-w-0 flex-1"},bs={class:"flex items-center gap-1.5 flex-wrap"},fs={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-blue-200"},ys={key:1,class:"inline-flex items-center gap-1 bg-gray-100 text-gray-500 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-gray-200"},vs={class:"text-[10px] sm:text-xs text-gray-400 mt-0.5 flex items-center gap-1 flex-wrap"},hs={key:0,class:"truncate max-w-[120px] sm:max-w-none"},_s={key:0,class:"text-[9px] sm:text-[10px] text-blue-400 font-mono mt-0.5 truncate"},ws={class:"font-black text-gray-800 font-mono text-xs sm:text-sm whitespace-nowrap"},ks={key:3,class:"text-[9px] sm:text-[10px] text-blue-500 font-semibold bg-blue-50 border border-blue-100 px-1.5 py-1 rounded-lg whitespace-nowrap"},$s=$e({__name:"SalesOrder",props:{combinedRows:{},loading:{type:Boolean},activeFilter:{},expandedSubId:{},processingSubId:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["toggle-sub-expand","sub-action","open-order-detail","order-action","show-all"],setup(g,{emit:M}){const k=M,O=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],A={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},S={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(w,i)=>(t(),a("div",Mt,[i[21]||(i[21]=mt('<div class="flex flex-wrap gap-1.5 px-3 sm:px-5 pt-3 pb-2 overflow-x-auto [scrollbar-width:none] [&amp;::-webkit-scrollbar]:hidden"><div class="flex items-center gap-1.5 bg-amber-50 border border-amber-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-amber-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-amber-700 whitespace-nowrap">Subscription â€” Accept to start daily delivery</span></div><div class="flex items-center gap-1.5 bg-blue-50 border border-blue-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-blue-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-blue-700 whitespace-nowrap">Daily Auto-Order â€” DN auto-created</span></div><div class="flex items-center gap-1.5 bg-gray-50 border border-gray-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-gray-300 flex-shrink-0"></div><span class="text-[10px] font-semibold text-gray-500 whitespace-nowrap">Normal Order</span></div></div>',1)),e("div",Vt,[g.loading?(t(),a("div",zt,[c(n(He),{class:"w-7 h-7 sm:w-8 sm:h-8 mb-4 text-blue-600"}),i[2]||(i[2]=e("p",{class:"text-gray-400 font-medium text-sm animate-pulse"},"Loading...",-1))])):g.combinedRows.length===0?(t(),a("div",qt,[c(n(Ye),{class:"w-10 h-10 sm:w-12 sm:h-12 text-gray-200 mb-4"}),i[3]||(i[3]=e("p",{class:"text-gray-400 font-medium text-sm"},"Nothing to show",-1)),g.activeFilter!=="all"?(t(),a("button",{key:0,onClick:i[0]||(i[0]=x=>k("show-all")),class:"mt-3 text-sm text-blue-600 hover:underline"}," Show all ")):b("",!0)])):(t(),a("div",Bt,[(t(!0),a(I,null,B(g.combinedRows,x=>(t(),a(I,{key:x.row_type+"-"+x.name},[x.row_type==="subscription"?(t(),a("div",{key:0,class:$(["border-l-4 transition-all",x.status==="Accept Pending"?"border-l-amber-400 bg-amber-50/50":"border-l-green-400 bg-green-50/20"])},[e("div",Et,[e("div",Ht,[e("div",{class:$(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 mt-0.5 sm:mt-0",x.status==="Accept Pending"?"bg-amber-100 text-amber-600":"bg-green-100 text-green-600"])},[c(n(Se),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2),e("div",Wt,[e("div",Yt,[e("span",Gt,l(x.name),1),e("span",Qt,[c(n(tt),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),i[4]||(i[4]=T(" Subscription Request ",-1))]),e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border",x.status==="Accept Pending"?"bg-amber-50 text-amber-600 border-amber-200":x.status==="Active"?"bg-green-50 text-green-600 border-green-200":"bg-gray-50 text-gray-500 border-gray-200"])},l(x.status),3)]),e("p",Jt,[i[5]||(i[5]=e("span",null,"Customer:",-1)),e("span",Xt,l(x.customer_name),1),i[6]||(i[6]=e("span",{class:"hidden sm:inline"},"Â·",-1)),e("span",Kt,l(x.formatted_start)+" â†’ "+l(x.formatted_end),1)]),e("p",Zt,[i[7]||(i[7]=T(" Primary: ",-1)),e("span",es,l(x.primary_item_name),1)])])]),e("div",ts,[x.status==="Accept Pending"?(t(),a(I,{key:0},[c(n(oe),{variant:"solid",class:"!bg-green-600 hover:!bg-green-700 !text-white text-xs",size:"sm",loading:g.processingSubId===x.name,onClick:X(_=>k("sub-action",x.name,"accept"),["stop"])},{prefix:z(()=>[c(n(Ne),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:z(()=>[i[8]||(i[8]=e("span",{class:"hidden sm:inline"},"Accept Plan",-1)),i[9]||(i[9]=e("span",{class:"sm:hidden"},"Accept",-1))]),_:1},8,["loading","onClick"]),c(n(oe),{variant:"subtle",theme:"red",size:"sm",loading:g.processingSubId===x.name,class:"text-xs",onClick:X(_=>k("sub-action",x.name,"reject"),["stop"])},{default:z(()=>[...i[10]||(i[10]=[T("Reject",-1)])]),_:1},8,["loading","onClick"])],64)):x.status==="Active"?(t(),a(I,{key:1},[e("div",ss,[c(n(Ee),{class:"w-3 h-3 text-green-600 flex-shrink-0"}),i[11]||(i[11]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-green-700"},"Auto-running",-1))]),c(n(oe),{variant:"subtle",theme:"red",size:"sm",loading:g.processingSubId===x.name,class:"text-xs",onClick:X(_=>k("sub-action",x.name,"reject"),["stop"])},{default:z(()=>[...i[12]||(i[12]=[e("span",{class:"hidden sm:inline"},"Cancel Plan",-1),e("span",{class:"sm:hidden"},"Cancel",-1)])]),_:1},8,["loading","onClick"])],64)):b("",!0),e("button",{onClick:_=>k("toggle-sub-expand",x.name),class:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all flex-shrink-0"},[g.expandedSubId===x.name?(t(),P(n(lt),{key:0,class:"w-4 h-4"})):(t(),P(n(Ue),{key:1,class:"w-4 h-4"}))],8,as)])]),g.expandedSubId===x.name?(t(),a("div",ls,[x.status==="Accept Pending"?(t(),a("div",ns,[c(n(tt),{class:"w-3.5 h-3.5 text-amber-500 mt-0.5 flex-shrink-0"}),i[13]||(i[13]=e("p",{class:"text-[10px] sm:text-xs text-amber-800"},[e("span",{class:"font-bold"},"Accept this plan"),T(" to activate daily delivery. From "),e("strong",null,"next day"),T(", system auto-generates Sales Orders + Delivery Notes. You only handle "),e("strong",null,"invoicing"),T(". ")],-1))])):b("",!0),(t(!0),a(I,null,B(x.schedule_items,_=>(t(),a("div",{key:_.item_code,class:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden"},[e("div",os,[e("span",rs,l(_.item_name),1),_.is_primary_item?(t(),a("span",is,"Primary")):b("",!0)]),e("div",ds,[(t(),a(I,null,B(O,y=>e("div",{key:y,class:$(["flex flex-col items-center px-2 sm:px-3 py-1.5 rounded-xl font-bold min-w-[34px] sm:min-w-[44px] text-center",(_[S[y]]||0)>0?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-400"])},[e("span",cs,l(A[y]),1),(_[S[y]]||0)>0?(t(),a("span",us,l(_[S[y]]),1)):(t(),a("span",xs,"â€”"))],2)),64))])]))),128))])):b("",!0)],2)):(t(),a("div",{key:1,class:$(["flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2 cursor-pointer group transition-all border-l-4",x.custom_subscription_refereance?"border-l-blue-300 bg-blue-50/20 hover:bg-blue-50/50 active:bg-blue-50/70":"border-l-transparent hover:bg-gray-50/70 active:bg-gray-100/50"]),onClick:_=>k("open-order-detail",x)},[e("div",ms,[e("div",{class:$(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 transition-colors mt-0.5 sm:mt-0",x.custom_subscription_refereance?"bg-blue-100 text-blue-600 group-hover:bg-blue-500 group-hover:text-white":"bg-gray-100 text-gray-500 group-hover:bg-blue-100 group-hover:text-blue-600"])},[x.custom_subscription_refereance?(t(),P(n(Se),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),P(n(ze),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",gs,[e("div",bs,[e("span",{class:$(["font-bold font-mono text-xs sm:text-sm transition-colors",x.custom_subscription_refereance?"text-blue-700":"text-gray-900 group-hover:text-blue-600"])},l(x.name),3),x.custom_subscription_refereance?(t(),a("span",fs,[c(n(Ee),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),i[14]||(i[14]=e("span",{class:"hidden xs:inline"},"Daily Sub-Auto-Order",-1)),i[15]||(i[15]=e("span",{class:"xs:hidden"},"Sub",-1))])):(t(),a("span",ys,[c(n(ze),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),i[16]||(i[16]=e("span",{class:"hidden xs:inline"},"Normal Order",-1)),i[17]||(i[17]=e("span",{class:"xs:hidden"},"Normal",-1))])),c(n(nt),{theme:g.getStatusTheme(x.status),variant:"subtle",label:x.status,size:"sm"},null,8,["theme","label"])]),e("p",vs,[c(n(ke),{class:"w-3 h-3 flex-shrink-0"}),e("span",null,l(x.transaction_date),1),x.customer_name?(t(),a("span",hs,"Â· "+l(x.customer_name),1)):b("",!0)]),x.custom_subscription_refereance?(t(),a("p",_s," ðŸ“‹ "+l(x.custom_subscription_refereance),1)):b("",!0)])]),e("div",{class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap",onClick:i[1]||(i[1]=X(()=>{},["stop"]))},[e("span",ws,l(g.formatCurrency(x.grand_total,x.currency)),1),x.docstatus===0?(t(),P(n(oe),{key:0,variant:"solid",theme:"blue",size:"sm",loading:g.processingId===x.name,onClick:_=>k("order-action",x.name,"accept"),class:"text-xs"},{default:z(()=>[...i[18]||(i[18]=[T("Accept",-1)])]),_:1},8,["loading","onClick"])):b("",!0),x.docstatus===1&&x.per_delivered<100&&!x.custom_subscription_refereance?(t(),P(n(oe),{key:1,variant:"subtle",theme:"gray",size:"sm",loading:g.processingId===x.name,onClick:_=>k("order-action",x.name,"deliver"),class:"text-xs"},{prefix:z(()=>[c(n(Oe),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:z(()=>[i[19]||(i[19]=e("span",{class:"hidden sm:inline"},"Deliver",-1))]),_:1},8,["loading","onClick"])):b("",!0),x.per_delivered>=100&&x.per_billed<100?(t(),P(n(oe),{key:2,variant:"subtle",theme:"gray",size:"sm",loading:g.processingId===x.name,onClick:_=>k("order-action",x.name,"invoice"),class:"text-xs"},{prefix:z(()=>[c(n(ot),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:z(()=>[i[20]||(i[20]=e("span",{class:"hidden sm:inline"},"Invoice",-1))]),_:1},8,["loading","onClick"])):b("",!0),x.custom_subscription_refereance&&x.docstatus===1&&x.per_delivered<100?(t(),a("span",ks," âš¡ Auto-Delivered ")):b("",!0),c(n(Re),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-300 ml-1 flex-shrink-0"})])],10,ps))],64))),128))]))])]))}}),Cs={class:"flex items-center justify-between w-full pr-6 sm:pr-8 gap-2 flex-wrap"},Ss={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Ds={class:"min-w-0"},Fs={class:"text-xs sm:text-sm text-gray-500 font-mono mt-1 truncate"},js={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},Ps={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[10px] sm:text-xs font-bold px-2 sm:px-3 py-1 rounded-full truncate max-w-[140px] sm:max-w-none"},Ts={class:"truncate"},Os={key:0,class:"flex flex-col items-center justify-center h-48 sm:h-80"},As={key:1,class:"py-4 sm:py-6 space-y-5 sm:space-y-8"},Ns={key:0,class:"flex items-start gap-2 sm:gap-3 bg-blue-50 border border-blue-200 rounded-xl sm:rounded-2xl p-3 sm:p-4"},Is={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-5"},Ls={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},Us={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},Rs={class:"min-w-0"},Ms={class:"font-bold text-sm sm:text-base truncate"},Vs={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},zs={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},qs={class:"font-bold text-sm sm:text-base"},Bs={class:"bg-blue-600 p-3 sm:p-5 rounded-xl sm:rounded-2xl text-white"},Es={class:"font-black text-xl sm:text-2xl"},Hs={class:"border border-gray-200 rounded-xl overflow-hidden"},Ws={class:"overflow-x-auto"},Ys={class:"w-full text-xs sm:text-sm min-w-[400px]"},Gs={class:"divide-y divide-gray-100"},Qs={class:"px-3 sm:px-5 py-3 sm:py-4 font-bold text-gray-900"},Js={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Xs={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Ks={class:"px-3 sm:px-5 py-3 sm:py-4 text-right font-bold tabular-nums"},Zs={class:"flex flex-col xs:flex-row justify-end gap-2 sm:gap-3 pt-4 sm:pt-6 border-t border-gray-100"},ea=$e({__name:"SellerOrderDetailDialog",props:{modelValue:{type:Boolean},orderDetails:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["update:modelValue","order-action"],setup(g,{emit:M}){const k=g,O=M,A=R({get:()=>k.modelValue,set:S=>O("update:modelValue",S)});return(S,w)=>(t(),P(n(rt),{modelValue:A.value,"onUpdate:modelValue":w[3]||(w[3]=i=>A.value=i),options:{size:"4xl"}},{"body-title":z(()=>{var i,x,_,y;return[e("div",Cs,[e("div",Ss,[e("div",{class:$(["h-8 w-8 sm:h-10 sm:w-10 rounded-full flex items-center justify-center flex-shrink-0",(i=g.orderDetails)!=null&&i.custom_subscription_refereance?"bg-blue-50 text-blue-600":"bg-gray-50 text-gray-600"])},[(x=g.orderDetails)!=null&&x.custom_subscription_refereance?(t(),P(n(Se),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),P(n(Ye),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",Ds,[w[4]||(w[4]=e("h3",{class:"text-base sm:text-xl font-black leading-none"},"Order Details",-1)),e("p",Fs,l((_=g.orderDetails)==null?void 0:_.name),1)])]),e("div",js,[(y=g.orderDetails)!=null&&y.custom_subscription_refereance?(t(),a("span",Ps,[c(n(Se),{class:"w-3 h-3 flex-shrink-0"}),e("span",Ts,l(g.orderDetails.custom_subscription_refereance),1)])):b("",!0),g.orderDetails?(t(),P(n(nt),{key:1,theme:g.getStatusTheme(g.orderDetails.status),size:"lg",label:g.orderDetails.status},null,8,["theme","label"])):b("",!0)])])]}),"body-content":z(()=>[g.orderDetails?(t(),a("div",As,[g.orderDetails.custom_subscription_refereance&&g.orderDetails.docstatus===1?(t(),a("div",Ns,[c(n(Ee),{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 mt-0.5 flex-shrink-0"}),w[5]||(w[5]=e("p",{class:"text-[10px] sm:text-xs text-blue-700"},[e("span",{class:"font-bold"},"Daily Subscription Order."),T(" Auto-generated by cron. Delivery note created automatically. Only invoice needed manually. ")],-1))])):b("",!0),e("div",Is,[e("div",Ls,[e("div",Us,[c(n(Be),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",Rs,[w[6]||(w[6]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Customer",-1)),e("p",Ms,l(g.orderDetails.customer_name),1)])]),e("div",Vs,[e("div",zs,[c(n(ke),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",null,[w[7]||(w[7]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Date",-1)),e("p",qs,l(g.orderDetails.transaction_date),1)])]),e("div",Bs,[w[8]||(w[8]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Grand Total",-1)),e("p",Es,l(g.formatCurrency(g.orderDetails.grand_total,g.orderDetails.currency)),1)])]),e("div",Hs,[e("div",Ws,[e("table",Ys,[w[9]||(w[9]=e("thead",{class:"bg-gray-50 text-[9px] sm:text-[10px] uppercase font-bold text-gray-500"},[e("tr",null,[e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-left"},"Item"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Qty"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Rate"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Amount")])],-1)),e("tbody",Gs,[(t(!0),a(I,null,B(g.orderDetails.items,i=>(t(),a("tr",{key:i.name},[e("td",Qs,l(i.item_name),1),e("td",Js,l(i.qty),1),e("td",Xs,l(g.formatCurrency(i.rate,g.orderDetails.currency)),1),e("td",Ks,l(g.formatCurrency(i.amount,g.orderDetails.currency)),1)]))),128))])])])]),e("div",Zs,[g.orderDetails.docstatus===0?(t(),P(n(oe),{key:0,variant:"solid",theme:"blue",size:"xl",loading:g.processingId===g.orderDetails.name,class:"w-full xs:w-auto",onClick:w[0]||(w[0]=i=>O("order-action",g.orderDetails.name,"accept"))},{default:z(()=>[...w[10]||(w[10]=[T("Accept Order",-1)])]),_:1},8,["loading"])):b("",!0),g.orderDetails.docstatus===1&&g.orderDetails.per_delivered<100&&!g.orderDetails.custom_subscription_refereance?(t(),P(n(oe),{key:1,variant:"solid",theme:"gray",size:"xl",loading:g.processingId===g.orderDetails.name,class:"w-full xs:w-auto",onClick:w[1]||(w[1]=i=>O("order-action",g.orderDetails.name,"deliver"))},{prefix:z(()=>[c(n(Oe),{class:"w-4 h-4"})]),default:z(()=>[w[11]||(w[11]=T(" Generate Delivery Note ",-1))]),_:1},8,["loading"])):b("",!0),g.orderDetails.per_delivered>=100&&g.orderDetails.per_billed<100?(t(),P(n(oe),{key:2,variant:"solid",theme:"gray",size:"xl",loading:g.processingId===g.orderDetails.name,class:"w-full xs:w-auto",onClick:w[2]||(w[2]=i=>O("order-action",g.orderDetails.name,"invoice"))},{prefix:z(()=>[c(n(ot),{class:"w-4 h-4"})]),default:z(()=>[w[12]||(w[12]=T(" Generate Invoice ",-1))]),_:1},8,["loading"])):b("",!0)])])):(t(),a("div",Os,[c(n(He),{class:"w-8 h-8 sm:w-10 sm:h-10 text-blue-500"})]))]),_:1},8,["modelValue"]))}}),ta={class:"space-y-4 sm:space-y-5"},sa={class:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4"},aa={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-gray-100 shadow-sm"},la={class:"text-2xl sm:text-3xl font-black text-gray-900"},na={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-green-100 shadow-sm"},oa={class:"text-2xl sm:text-3xl font-black text-gray-900"},ra={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-blue-100 shadow-sm"},ia={class:"text-2xl sm:text-3xl font-black text-gray-900"},da={class:"bg-blue-600 p-3 sm:p-4 rounded-xl sm:rounded-2xl shadow-sm"},ca={class:"text-xl sm:text-2xl font-black text-white"},ua={class:"flex flex-col sm:flex-row gap-2 sm:gap-3"},xa={class:"relative flex-1"},pa={class:"flex gap-2 sm:gap-3"},ma=["value"],ga={key:0,class:"flex justify-center py-16 sm:py-20"},ba={key:1,class:"bg-gray-50 rounded-2xl sm:rounded-3xl border-2 border-dashed border-gray-200 py-16 sm:py-24 text-center px-4"},fa={class:"text-xs sm:text-sm text-gray-400 mt-1"},ya={key:2,class:"space-y-2 sm:space-y-3"},va=["onClick"],ha={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},_a={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-lg sm:rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 text-white flex items-center justify-center font-black text-base sm:text-lg flex-shrink-0 shadow-sm"},wa={class:"min-w-0 flex-1"},ka={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},$a={class:"font-bold text-gray-900 text-xs sm:text-sm"},Ca={class:"font-mono text-[9px] sm:text-[10px] text-gray-400 hidden xs:inline"},Sa={key:0,class:"inline-flex items-center gap-1 bg-green-100 text-green-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-green-200"},Da={key:1,class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-amber-200"},Fa={class:"flex items-center gap-2 sm:gap-3 mt-0.5 flex-wrap"},ja={key:0,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Pa={class:"truncate max-w-[110px] sm:max-w-none"},Ta={key:1,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Oa={key:2,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Aa={class:"flex items-center gap-3 sm:gap-4 flex-shrink-0"},Na={class:"text-right hidden md:block"},Ia={class:"font-black text-gray-900"},La={class:"text-right hidden md:block"},Ua={class:"font-black text-gray-900 text-sm"},Ra={key:0,class:"border-t border-gray-100 px-3 sm:px-4 pb-4 sm:pb-5 pt-3 sm:pt-4 space-y-3 sm:space-y-4 bg-gray-50/30"},Ma={class:"flex gap-3 md:hidden"},Va={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},za={class:"font-black text-gray-900 text-sm sm:text-base"},qa={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},Ba={class:"font-black text-gray-900 text-xs sm:text-sm"},Ea={key:0},Ha={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},Wa={class:"space-y-2"},Ya={class:"flex flex-col xs:flex-row xs:items-center justify-between gap-1 mb-2"},Ga={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},Qa={class:"font-mono text-[10px] sm:text-xs font-bold text-gray-700"},Ja={class:"text-[9px] sm:text-[10px] text-gray-400 whitespace-nowrap"},Xa={class:"text-[9px] sm:text-[10px] text-gray-500 font-semibold mb-1"},Ka={class:"flex gap-1 flex-wrap"},Za={key:0,class:"opacity-80 text-[7px] sm:text-[8px]"},el={key:1,class:"text-center py-3 sm:py-4 text-[10px] sm:text-xs text-gray-400 bg-white rounded-lg sm:rounded-xl border border-dashed border-gray-200"},tl={key:2},sl={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},al={class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 overflow-hidden"},ll={class:"overflow-x-auto"},nl={class:"w-full text-xs min-w-[360px]"},ol={class:"divide-y divide-gray-50"},rl={class:"px-2.5 sm:px-3 py-2 font-mono font-bold text-gray-700 text-[10px] sm:text-xs"},il={key:0,class:"ml-1 text-[8px] bg-blue-100 text-blue-600 px-1 py-0.5 rounded font-bold"},dl={class:"px-2.5 sm:px-3 py-2 text-gray-500 text-[10px] sm:text-xs"},cl={class:"px-2.5 sm:px-3 py-2"},ul={class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-800 text-[10px] sm:text-xs tabular-nums"},xl=$e({__name:"SellerCustomersTab",props:{seller:{}},setup(g){const M=g,k=N(""),O=N(null),A=N(""),S=le({url:"my_frappe_app.api.get_seller_customers",onSuccess(){}});gt(()=>{M.seller&&S.fetch({seller:M.seller})});const w=R(()=>{var q;return((q=S.data)==null?void 0:q.customers)||[]}),i=R(()=>{var q;return((q=S.data)==null?void 0:q.pincodes)||[]}),x=R(()=>{let q=w.value;if(A.value&&(q=q.filter(D=>D.pincode===A.value)),k.value.trim()){const D=k.value.toLowerCase();q=q.filter(F=>{var J,Y,G,K;return((J=F.customer_name)==null?void 0:J.toLowerCase().includes(D))||((Y=F.name)==null?void 0:Y.toLowerCase().includes(D))||((G=F.email)==null?void 0:G.toLowerCase().includes(D))||((K=F.mobile)==null?void 0:K.toLowerCase().includes(D))})}return q}),_=R(()=>{const q=w.value;return{total:q.length,withActiveSub:q.filter(D=>D.active_subs>0).length,totalOrders:q.reduce((D,F)=>D+(F.total_orders||0),0),totalRevenue:q.reduce((D,F)=>D+(F.total_revenue||0),0)}}),y=q=>{O.value=O.value===q?null:q},j=q=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(q),E={Active:"bg-green-100 text-green-700 border-green-200","Accept Pending":"bg-amber-100 text-amber-700 border-amber-200",Expired:"bg-gray-100 text-gray-500 border-gray-200",Cancelled:"bg-red-100 text-red-600 border-red-200"},se=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],V={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},Q={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(q,D)=>(t(),a("div",ta,[e("div",sa,[e("div",aa,[D[3]||(D[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Total Customers",-1)),e("p",la,l(_.value.total),1)]),e("div",na,[D[4]||(D[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1"},"With Active Plan",-1)),e("p",oa,l(_.value.withActiveSub),1)]),e("div",ra,[D[5]||(D[5]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-500 uppercase tracking-widest mb-1"},"Total Orders",-1)),e("p",ia,l(_.value.totalOrders),1)]),e("div",da,[D[6]||(D[6]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Total Revenue",-1)),e("p",ca,l(j(_.value.totalRevenue)),1)])]),e("div",ua,[e("div",xa,[c(n(Ge),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),ie(e("input",{"onUpdate:modelValue":D[0]||(D[0]=F=>k.value=F),type:"text",placeholder:"Search by name, email, mobile...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[pe,k.value]])]),e("div",pa,[ie(e("select",{"onUpdate:modelValue":D[1]||(D[1]=F=>A.value=F),class:"flex-1 sm:flex-none border border-gray-200 rounded-xl px-3 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"},[D[7]||(D[7]=e("option",{value:""},"All Pincodes",-1)),(t(!0),a(I,null,B(i.value,F=>(t(),a("option",{key:F,value:F},l(F),9,ma))),128))],512),[[st,A.value]]),c(n(oe),{variant:"outline",loading:n(S).loading,class:"text-xs sm:text-sm flex-shrink-0",onClick:D[2]||(D[2]=F=>n(S).fetch({seller:M.seller}))},{prefix:z(()=>[c(n(ee),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:z(()=>[D[8]||(D[8]=e("span",{class:"hidden sm:inline"},"Refresh",-1))]),_:1},8,["loading"])])]),n(S).loading?(t(),a("div",ga,[c(n(He),{class:"w-7 h-7 sm:w-8 sm:h-8 text-blue-600"})])):x.value.length===0?(t(),a("div",ba,[c(n(at),{class:"w-9 h-9 sm:w-10 sm:h-10 text-gray-300 mx-auto mb-3"}),D[9]||(D[9]=e("h3",{class:"text-sm sm:text-base font-bold text-gray-700"},"No Customers Found",-1)),e("p",fa,l(k.value||A.value?"Try different filters":"No customers in your area yet"),1)])):(t(),a("div",ya,[(t(!0),a(I,null,B(x.value,F=>{var J,Y,G,K;return t(),a("div",{key:F.name,class:"bg-white rounded-xl sm:rounded-2xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow"},[e("div",{class:"flex items-center justify-between p-3 sm:p-4 gap-2 sm:gap-3 cursor-pointer",onClick:L=>y(F.name)},[e("div",ha,[e("div",_a,l(((Y=(J=F.customer_name)==null?void 0:J[0])==null?void 0:Y.toUpperCase())||"?"),1),e("div",wa,[e("div",ka,[e("span",$a,l(F.customer_name),1),e("span",Ca,l(F.name),1),F.active_subs>0?(t(),a("span",Sa,[c(n(Ne),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),T(" "+l(F.active_subs)+" Active ",1)])):F.pending_subs>0?(t(),a("span",Da,[c(n(Me),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),T(" "+l(F.pending_subs)+" Pending ",1)])):b("",!0)]),e("div",Fa,[F.email?(t(),a("span",ja,[c(n(kt),{class:"w-3 h-3 flex-shrink-0"}),e("span",Pa,l(F.email),1)])):b("",!0),F.mobile?(t(),a("span",Ta,[c(n($t),{class:"w-3 h-3 flex-shrink-0"}),T(" "+l(F.mobile),1)])):b("",!0),F.pincode?(t(),a("span",Oa,[c(n(bt),{class:"w-3 h-3 flex-shrink-0"}),T(" "+l(F.pincode),1)])):b("",!0)])])]),e("div",Aa,[e("div",Na,[D[10]||(D[10]=e("p",{class:"text-xs text-gray-400 font-medium"},"Orders",-1)),e("p",Ia,l(F.total_orders||0),1)]),e("div",La,[D[11]||(D[11]=e("p",{class:"text-xs text-gray-400 font-medium"},"Revenue",-1)),e("p",Ua,l(j(F.total_revenue||0)),1)]),O.value===F.name?(t(),P(n(lt),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"})):(t(),P(n(Ue),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"}))])],8,va),O.value===F.name?(t(),a("div",Ra,[e("div",Ma,[e("div",Va,[D[12]||(D[12]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Orders",-1)),e("p",za,l(F.total_orders||0),1)]),e("div",qa,[D[13]||(D[13]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Revenue",-1)),e("p",Ba,l(j(F.total_revenue||0)),1)])]),((G=F.subscriptions)==null?void 0:G.length)>0?(t(),a("div",Ea,[e("h4",Ha,[c(n(Se),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),D[14]||(D[14]=T(" Subscription Plans ",-1))]),e("div",Wa,[(t(!0),a(I,null,B(F.subscriptions,L=>(t(),a("div",{key:L.name,class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 p-2.5 sm:p-3"},[e("div",Ya,[e("div",Ga,[e("span",Qa,l(L.name),1),e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border",E[L.status]||"bg-gray-100 text-gray-500 border-gray-200"])},l(L.status),3)]),e("span",Ja,l(L.formatted_start)+" â†’ "+l(L.formatted_end),1)]),(t(!0),a(I,null,B(L.schedule_items,ne=>(t(),a("div",{key:ne.item_code,class:"mt-2"},[e("p",Xa,l(ne.item_name),1),e("div",Ka,[(t(),a(I,null,B(se,W=>e("div",{key:W,class:$(["flex flex-col items-center px-1.5 sm:px-2 py-1 rounded-lg text-[8px] sm:text-[9px] font-bold min-w-[28px] sm:min-w-[32px] text-center",(ne[Q[W]]||0)>0?"bg-blue-600 text-white":"bg-gray-100 text-gray-400"])},[e("span",null,l(V[W]),1),(ne[Q[W]]||0)>0?(t(),a("span",Za," Ã—"+l(ne[Q[W]]),1)):b("",!0)],2)),64))])]))),128))]))),128))])])):(t(),a("div",el,[c(n(Se),{class:"w-5 h-5 sm:w-6 sm:h-6 text-gray-200 mx-auto mb-1"}),D[15]||(D[15]=T(" No subscription plans yet ",-1))])),((K=F.recent_orders)==null?void 0:K.length)>0?(t(),a("div",tl,[e("h4",sl,[c(n(ze),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),D[16]||(D[16]=T(" Recent Orders (last 5) ",-1))]),e("div",al,[e("div",ll,[e("table",nl,[D[17]||(D[17]=e("thead",{class:"bg-gray-50 border-b border-gray-100"},[e("tr",null,[e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Order"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Date"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Status"),e("th",{class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Amount")])],-1)),e("tbody",ol,[(t(!0),a(I,null,B(F.recent_orders,L=>(t(),a("tr",{key:L.name},[e("td",rl,[T(l(L.name)+" ",1),L.custom_subscription_refereance?(t(),a("span",il,"SUB")):b("",!0)]),e("td",dl,l(L.transaction_date),1),e("td",cl,[e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full",L.docstatus===2?"bg-red-100 text-red-600":L.status==="Completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"])},l(L.status),3)]),e("td",ul,l(j(L.grand_total)),1)]))),128))])])])])])):b("",!0)])):b("",!0)])}),128))]))]))}}),pl={class:"flex items-center gap-2 sm:gap-3"},ml={class:"p-2 sm:p-2.5 bg-emerald-600 rounded-lg sm:rounded-xl text-white shadow-md flex-shrink-0"},gl={class:"space-y-3"},bl={key:0,class:"flex items-start gap-3 bg-red-50 border border-red-200 rounded-xl px-4 py-3 shadow-sm"},fl={class:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0 mt-0.5"},yl={class:"flex-1 min-w-0"},vl={class:"text-xs text-red-600 mt-0.5 leading-relaxed"},hl={key:1,class:"flex items-start gap-3 bg-amber-50 border border-amber-200 rounded-xl px-4 py-3 shadow-sm"},_l={class:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0 mt-0.5"},wl={class:"flex-1 min-w-0"},kl={class:"text-[10px] text-amber-600 mt-0.5 font-mono break-all"},$l={class:"filter-card"},Cl={class:"filter-header"},Sl={class:"filter-title-group"},Dl={class:"filter-icon-wrap"},Fl={key:0,class:"filter-active-badge"},jl=["disabled"],Pl={class:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 mt-3"},Tl={class:"filter-field"},Ol=["max"],Al={class:"filter-field"},Nl=["min","max"],Il={class:"filter-field"},Ll={value:""},Ul=["value"],Rl={class:"filter-pills-row"},Ml={class:"pill pill-date"},Vl={class:"pill-text"},zl={class:"pill-text"},ql={key:0,class:"pill pill-customer"},Bl={class:"pill-text truncate max-w-[110px]"},El={class:"pill pill-count ml-auto"},Hl={class:"pill-count-num"},Wl={class:"summary-table-wrapper border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},Yl={class:"flex items-center gap-3 px-4 py-3.5 bg-gradient-to-r from-emerald-700 to-emerald-600 flex-shrink-0"},Gl={key:1,class:"flex items-center gap-1.5 bg-white/20 border border-white/20 rounded-full px-3 py-1 flex-shrink-0"},Ql={class:"text-[11px] font-black text-white"},Jl={key:0,class:"flex flex-col items-center justify-center gap-2 py-10 bg-white"},Xl={class:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center"},Kl={key:1,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},Zl={key:2,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},en={class:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center"},tn={key:3,class:"summary-scroll-area"},sn={class:"summary-table"},an=["title"],ln=["title"],nn={key:0,class:"cell-value"},on={key:1,class:"cell-empty"},rn={class:"col-total td-total-cell"},dn={class:"total-amt"},cn={class:"total-qty"},un={class:"footer-row"},xn={class:"col-total td-foot-amount"},pn={class:"border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},mn={class:"flex items-center gap-2.5 px-4 py-3 bg-gradient-to-r from-gray-700 to-gray-600"},gn={key:0,class:"w-2.5 h-2.5 text-white",viewBox:"0 0 12 12",fill:"none"},bn={key:1,class:"w-2 h-0.5 bg-white rounded-full"},fn={class:"text-[10px] font-bold text-white whitespace-nowrap"},yn={key:0,class:"flex flex-col items-center justify-center py-10 text-center bg-white px-4"},vn={class:"w-12 h-12 rounded-2xl bg-gray-100 flex items-center justify-center mb-3"},hn={key:1,class:"divide-y divide-gray-50 max-h-52 overflow-y-auto bg-white orders-scroll"},_n=["onClick"],wn={class:"hidden sm:grid items-center gap-2 px-4 py-3",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},kn={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},$n={class:"text-[10px] text-gray-400 font-mono font-bold"},Cn={class:"min-w-0"},Sn={class:"flex items-center gap-1.5 flex-wrap"},Dn={class:"font-bold font-mono text-[11px] text-gray-800 truncate"},Fn={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold"},jn={class:"text-[10px] text-gray-400 mt-0.5 truncate"},Pn={class:"min-w-0"},Tn={class:"font-mono text-[10px] text-gray-500 truncate block"},On={class:"text-right"},An={class:"text-[10px] font-bold text-emerald-700 bg-emerald-50 px-1.5 py-0.5 rounded-lg border border-emerald-100"},Nn={class:"text-right"},In={class:"text-[10px] font-bold text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded-lg border border-orange-100"},Ln={class:"font-black text-gray-800 font-mono text-xs text-right tabular-nums block"},Un={class:"flex sm:hidden items-center gap-3 px-4 py-3"},Rn={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},Mn={class:"flex-1 min-w-0"},Vn={class:"flex items-center gap-1"},zn={class:"font-bold font-mono text-[10px] text-gray-800 truncate"},qn={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},Bn={class:"flex items-center gap-2 mt-0.5"},En={class:"text-[9px] text-gray-400 truncate flex-1"},Hn={class:"text-[9px] font-bold text-emerald-700 bg-emerald-50 px-1 py-0.5 rounded flex-shrink-0"},Wn={class:"font-black text-gray-800 font-mono text-[11px] text-right tabular-nums flex-shrink-0"},Yn={class:"flex flex-col xs:flex-row items-start xs:items-center w-full gap-3"},Gn={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Qn={class:"text-[10px] sm:text-xs text-gray-500 font-semibold whitespace-nowrap"},Jn={class:"font-black text-gray-900 text-sm sm:text-base"},Xn={class:"flex items-center gap-2 sm:gap-3 ml-auto flex-shrink-0"},Kn=$e({__name:"SellerCreateInvoiceDialog",props:{modelValue:{type:Boolean},eligibleOrders:{},seller:{},formatCurrency:{type:Function}},emits:["update:modelValue","invoice-created"],setup(g,{emit:M}){const k=g,O=M,A=R({get:()=>k.modelValue,set:C=>O("update:modelValue",C)}),S=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],w={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},i=new Date().toISOString().split("T")[0],x=N(""),_=N(i),y=N(new Set),j=N(""),E=N(""),se=N({}),V=N(!1),Q=N(""),q=le({url:"my_frappe_app.api.get_sales_order_items",onError(C){console.error("[InvoiceDialog] soItemsResource error:",C)}}),D=R(()=>{const C=new Map;return k.eligibleOrders.forEach(d=>{const p=d.customer||d.customer_name,s=d.customer_name||d.customer;p&&s&&C.set(p,s)}),Array.from(C.entries()).map(([d,p])=>({value:d,label:p}))}),F=R(()=>k.eligibleOrders.filter(C=>{const d=C.transaction_date;return!(x.value&&d<x.value||_.value&&d>_.value||E.value&&!(C.customer===E.value||C.customer_name===E.value))}));let J=!0;je(F,C=>{J&&(y.value=new Set(C.map(d=>d.name)),J=!1)},{immediate:!0});const Y=()=>{x.value="",_.value=i,E.value="",y.value=new Set,j.value=""},G=R(()=>!!x.value||!!E.value||_.value!==i),K=R(()=>F.value.length>0&&F.value.every(C=>y.value.has(C.name))),L=R(()=>F.value.some(C=>y.value.has(C.name))&&!K.value),ne=()=>{const C=new Set(y.value);K.value?F.value.forEach(d=>C.delete(d.name)):F.value.forEach(d=>C.add(d.name)),y.value=C},W=C=>{const d=new Set(y.value);d.has(C)?d.delete(C):d.add(C),y.value=d,j.value=""},ae=R(()=>k.eligibleOrders.filter(C=>y.value.has(C.name))),me=R(()=>ae.value.reduce((C,d)=>C+(d.grand_total||0),0));function ge(C){return fe(this,null,function*(){const d=C.filter(p=>!se.value[p]);if(d.length){V.value=!0,Q.value="";try{const p=yield q.submit({order_names:JSON.stringify(d)});if(!Array.isArray(p))throw new Error(`Unexpected response format. Got: ${JSON.stringify(p)}`);const s={};for(const f of p)s[f.parent]||(s[f.parent]=[]),s[f.parent].push(f);for(const f of d)se.value[f]=s[f]||[]}catch(p){const s=(p==null?void 0:p.message)||(p==null?void 0:p.exception)||(p==null?void 0:p.exc_type)||String(p);Q.value=s;for(const f of d)se.value[f]||(se.value[f]=[])}finally{V.value=!1}}})}je(y,C=>fe(this,null,function*(){C.size>0&&(yield ge([...C]))}),{deep:!0});const de=R(()=>{const C=new Map;for(const d of ae.value){const p=d.transaction_date;if(!p)continue;const s=new Date(p+"T00:00:00").toLocaleDateString("en-US",{weekday:"long"}),f=se.value[d.name]||[];for(const u of f){const o=u.item_code;if(!o)continue;C.has(o)||C.set(o,{item_name:u.item_name||o,days:{},total_qty:0,total_amt:0});const m=C.get(o),U=Number(u.qty)||0,v=Number(u.rate)||0;m.days[s]||(m.days[s]={qty:0,price:0}),m.days[s].qty+=U,v>0&&m.days[s].price===0&&(m.days[s].price=v),m.total_qty+=U,m.total_amt+=U*v}}return Array.from(C.entries()).map(([d,p])=>De({item_code:d},p))});function ve(C,d){const p=String(C).padStart(3,"0"),s=Number.isInteger(d)?String(d):d.toFixed(2);return`${p}(${s})`}const ce=le({url:"my_frappe_app.api.create_invoice_from_sales_orders",onSuccess(C){j.value="",A.value=!1,O("invoice-created",C.invoice_name),be()},onError(C){const d=((C==null?void 0:C.exception)||(C==null?void 0:C.message)||"").toLowerCase();if(d.includes("already been billed")||d.includes("billed amount"))j.value="This order has already been billed. Please select a different order.";else if(d.includes("not submitted")||d.includes("draft"))j.value="Order has not been submitted yet. Please submit the order first.";else if(d.includes("permission")||d.includes("not permitted"))j.value="You do not have permission to create this invoice.";else if(d.includes("no orders")||d.includes("select at least"))j.value="Please select at least one order.";else if(d.includes("delivery")&&d.includes("not"))j.value="Delivery has not been completed yet. Please confirm delivery first.";else if(d.includes("customer")&&d.includes("match"))j.value="All selected orders must belong to the same customer.";else if(d.includes("internal server error")||d.includes("operationalerror")||d.includes("traceback"))j.value="A server error occurred. Please try again later or contact the admin.";else{const p=((C==null?void 0:C.exception)||(C==null?void 0:C.message)||"").replace(/<[^>]+>/g,"").replace(/^[\w.]+Error:\s*/i,"").replace(/Traceback[\s\S]*/i,"").trim();j.value=p||"An error occurred while creating the invoice. Please try again."}}}),Ce=R(()=>ce.loading),te=()=>{y.value.size!==0&&(j.value="",ce.submit({sales_orders:[...y.value]}))},be=()=>{x.value="",_.value=i,y.value=new Set,j.value="",E.value="",se.value={},Q.value="",J=!0};return je(A,C=>{C||be()}),(C,d)=>(t(),P(n(rt),{modelValue:A.value,"onUpdate:modelValue":d[9]||(d[9]=p=>A.value=p),options:{size:"5xl"}},{"body-title":z(()=>[e("div",pl,[e("div",ml,[c(n(we),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),d[10]||(d[10]=e("div",null,[e("h3",{class:"text-base sm:text-xl font-black leading-none text-gray-900"},"Create Invoice"),e("p",{class:"text-[10px] sm:text-sm text-gray-400 font-medium mt-0.5"}," Select delivered orders to generate a combined invoice ")],-1))])]),"body-content":z(()=>{var p;return[e("div",gl,[j.value?(t(),a("div",bl,[e("div",fl,[c(n(Fe),{class:"w-4 h-4 text-red-500"})]),e("div",yl,[d[11]||(d[11]=e("p",{class:"text-sm text-red-800 font-bold"},"Invoice Could Not Be Created",-1)),e("p",vl,l(j.value),1)]),e("button",{onClick:d[0]||(d[0]=s=>j.value=""),class:"text-red-300 hover:text-red-500 transition-colors mt-0.5"},[c(n(he),{class:"w-4 h-4"})])])):b("",!0),Q.value?(t(),a("div",hl,[e("div",_l,[c(n(Fe),{class:"w-4 h-4 text-amber-500"})]),e("div",wl,[d[12]||(d[12]=e("p",{class:"text-xs text-amber-800 font-bold"},"Could not load item details",-1)),e("p",kl,l(Q.value),1)]),e("button",{onClick:d[1]||(d[1]=s=>Q.value=""),class:"text-amber-300 hover:text-amber-500 transition-colors"},[c(n(he),{class:"w-3.5 h-3.5"})])])):b("",!0),e("div",$l,[e("div",Cl,[e("div",Sl,[e("div",Dl,[c(n(_t),{class:"w-3.5 h-3.5 text-indigo-600"})]),d[13]||(d[13]=e("span",{class:"filter-title"},"Filters",-1)),G.value?(t(),a("span",Fl,l((x.value?1:0)+(E.value?1:0)+(_.value!==n(i)?1:0))+" active ",1)):b("",!0)]),e("button",{onClick:Y,disabled:!G.value,class:$(["clear-btn",G.value?"clear-btn-active":"clear-btn-disabled"])},[c(n(he),{class:"w-3 h-3"}),d[14]||(d[14]=e("span",null,"Clear Filters",-1))],10,jl)]),e("div",Pl,[e("div",Tl,[d[15]||(d[15]=e("label",{class:"filter-label"},"From Date",-1)),e("div",{class:$(["filter-input-wrap",x.value?"input-active":""])},[c(n(ke),{class:"filter-input-icon"}),ie(e("input",{type:"date","onUpdate:modelValue":d[2]||(d[2]=s=>x.value=s),max:_.value||n(i),class:"filter-input"},null,8,Ol),[[pe,x.value]]),x.value?(t(),a("button",{key:0,onClick:d[3]||(d[3]=X(s=>x.value="",["stop"])),class:"input-clear-btn"},[c(n(he),{class:"w-3 h-3"})])):b("",!0)],2)]),e("div",Al,[d[16]||(d[16]=e("label",{class:"filter-label"},"To Date",-1)),e("div",{class:$(["filter-input-wrap",_.value!==n(i)?"input-active":""])},[c(n(ke),{class:"filter-input-icon"}),ie(e("input",{type:"date","onUpdate:modelValue":d[4]||(d[4]=s=>_.value=s),min:x.value,max:n(i),class:"filter-input"},null,8,Nl),[[pe,_.value]]),_.value!==n(i)?(t(),a("button",{key:0,onClick:d[5]||(d[5]=X(s=>_.value=n(i),["stop"])),class:"input-clear-btn"},[c(n(he),{class:"w-3 h-3"})])):b("",!0)],2)]),e("div",Il,[d[18]||(d[18]=e("label",{class:"filter-label"},"Customer",-1)),e("div",{class:$(["filter-input-wrap",E.value?"input-active":""])},[c(n(Be),{class:"filter-input-icon",style:{"z-index":"2"}}),ie(e("select",{"onUpdate:modelValue":d[6]||(d[6]=s=>E.value=s),class:"filter-input filter-select"},[e("option",Ll,"All Customers ("+l(D.value.length)+")",1),(t(!0),a(I,null,B(D.value,s=>(t(),a("option",{key:s.value,value:s.value},l(s.label),9,Ul))),128))],512),[[st,E.value]]),d[17]||(d[17]=e("svg",{class:"absolute right-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1))],2)])]),e("div",Rl,[e("div",Ml,[e("span",{class:$(["pill-dot",G.value?"pill-dot-active":"pill-dot-idle"])},null,2),e("span",Vl,l(x.value||"Any"),1),c(n(Re),{class:"w-3 h-3 opacity-40"}),e("span",zl,l(_.value||n(i)),1)]),E.value?(t(),a("div",ql,[c(n(Be),{class:"w-2.5 h-2.5"}),e("span",Bl,l((p=D.value.find(s=>s.value===E.value))==null?void 0:p.label),1),e("button",{onClick:d[7]||(d[7]=s=>{E.value="",y.value=new Set}),class:"pill-remove"},[c(n(he),{class:"w-2.5 h-2.5"})])])):b("",!0),e("div",El,[e("span",Hl,l(F.value.length),1),d[19]||(d[19]=e("span",{class:"pill-count-label"},"orders found",-1))])])]),e("div",Wl,[e("div",Yl,[d[21]||(d[21]=e("div",{class:"w-8 h-8 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0 shadow-inner"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7"})])],-1)),d[22]||(d[22]=e("div",{class:"flex-1 min-w-0"},[e("p",{class:"text-sm font-black text-white leading-tight tracking-tight"},"Day-wise Item Summary"),e("p",{class:"text-[11px] text-emerald-200 mt-0.5 font-semibold"},"qty(â‚¹rate) â€” e.g. 002(35)")],-1)),V.value?(t(),P(n(et),{key:0,class:"w-4 h-4 text-white/80 animate-spin flex-shrink-0"})):(t(),a("div",Gl,[e("span",Ql,l(de.value.length),1),d[20]||(d[20]=e("span",{class:"text-[11px] text-emerald-200 font-semibold"},"items",-1))]))]),V.value&&de.value.length===0?(t(),a("div",Jl,[e("div",Xl,[c(n(et),{class:"w-5 h-5 text-emerald-500 animate-spin"})]),d[23]||(d[23]=e("p",{class:"text-xs font-semibold text-gray-400"},"Fetching item details...",-1))])):y.value.size===0?(t(),a("div",Kl,[...d[24]||(d[24]=[e("div",{class:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1),e("p",{class:"text-xs font-semibold text-gray-400"},"Select orders below to see item summary",-1)])])):!V.value&&de.value.length===0?(t(),a("div",Zl,[e("div",en,[c(n(Fe),{class:"w-5 h-5 text-amber-400"})]),d[25]||(d[25]=e("p",{class:"text-xs font-semibold text-gray-400"},"No item data found for selected orders",-1)),d[26]||(d[26]=e("p",{class:"text-[10px] text-gray-300"},"Check browser console (F12) for details",-1))])):(t(),a("div",tn,[e("table",sn,[e("thead",null,[e("tr",null,[d[27]||(d[27]=e("th",{class:"col-item th-item"},[e("span",{class:"th-label"},"Item")],-1)),(t(),a(I,null,B(S,s=>e("th",{key:s,class:$(["col-day th-day",s==="Saturday"||s==="Sunday"?"th-weekend":""])},l(w[s]),3)),64)),d[28]||(d[28]=e("th",{class:"col-total th-total"},[e("span",{class:"th-label"},"Total")],-1))])]),e("tbody",null,[(t(!0),a(I,null,B(de.value,(s,f)=>(t(),a("tr",{key:s.item_code,class:$(["data-row",f%2===1?"row-alt":"row-base"])},[e("td",{class:$(["col-item td-item",f%2===1?"td-item-alt":"td-item-base"])},[e("div",{class:"item-name",title:s.item_name},l(s.item_name),9,an),e("div",{class:"item-code",title:s.item_code},l(s.item_code),9,ln)],2),(t(),a(I,null,B(S,u=>e("td",{key:u,class:$(["col-day td-day",u==="Saturday"||u==="Sunday"?"td-weekend":""])},[s.days[u]&&s.days[u].qty>0?(t(),a("span",nn,l(ve(s.days[u].qty,s.days[u].price)),1)):(t(),a("span",on,"Â·"))],2)),64)),e("td",rn,[e("div",dn,l(g.formatCurrency(s.total_amt)),1),e("div",cn,"qty: "+l(s.total_qty),1)])],2))),128))]),e("tfoot",null,[e("tr",un,[d[29]||(d[29]=e("td",{class:"col-item td-foot-label"},"Grand Total",-1)),(t(),a(I,null,B(S,s=>e("td",{key:s,class:$(["col-day td-foot-day",s==="Saturday"||s==="Sunday"?"td-foot-weekend":""])},null,2)),64)),e("td",xn,l(g.formatCurrency(me.value)),1)])])])]))]),e("div",pn,[e("div",mn,[d[31]||(d[31]=e("div",{class:"w-7 h-7 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),d[32]||(d[32]=e("div",{class:"flex-1"},[e("p",{class:"text-sm font-black text-white leading-none"},"Select Orders"),e("p",{class:"text-[10px] text-gray-300 mt-0.5"},"Click to select/deselect orders for invoicing")],-1)),e("button",{onClick:ne,class:"flex items-center gap-1.5 bg-white/15 hover:bg-white/25 transition-colors rounded-lg px-2.5 py-1.5 flex-shrink-0"},[e("div",{class:$(["checkbox-circle-sm",K.value?"checkbox-sm-selected":L.value?"checkbox-sm-indeterminate":"checkbox-sm-unselected"])},[K.value?(t(),a("svg",gn,[...d[30]||(d[30]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):L.value?(t(),a("div",bn)):b("",!0)],2),e("span",fn,l(K.value?"Deselect All":"Select All"),1)])]),d[37]||(d[37]=e("div",{class:"hidden sm:grid items-center gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},[e("span"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"#"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Sales Order"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Delivery Note"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Delivered"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Billed"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Amount")],-1)),F.value.length===0?(t(),a("div",yn,[e("div",vn,[c(n(Fe),{class:"w-6 h-6 text-gray-300"})]),d[33]||(d[33]=e("p",{class:"text-sm font-bold text-gray-400"},"No eligible orders found",-1)),d[34]||(d[34]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting the date range or customer filter",-1))])):(t(),a("div",hn,[(t(!0),a(I,null,B(F.value,(s,f)=>(t(),a("div",{key:s.name,onClick:u=>W(s.name),class:$(["order-row cursor-pointer select-none transition-all duration-100",y.value.has(s.name)?"order-row-selected":"order-row-unselected"])},[e("div",wn,[e("div",{class:$(["checkbox-circle",y.value.has(s.name)?"checkbox-selected":"checkbox-unselected"])},[y.value.has(s.name)?(t(),a("svg",kn,[...d[35]||(d[35]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):b("",!0)],2),e("span",$n,l(f+1),1),e("div",Cn,[e("div",Sn,[e("span",Dn,l(s.name),1),s.custom_subscription_refereance?(t(),a("span",Fn,"Sub")):b("",!0)]),e("p",jn,l(s.customer_name),1)]),e("div",Pn,[e("span",Tn,l(s.delivery_note||"â€”"),1)]),e("div",On,[e("span",An,l(s.per_delivered)+"% ",1)]),e("div",Nn,[e("span",In,l(s.per_billed)+"% ",1)]),e("span",Ln,l(g.formatCurrency(s.grand_total,s.currency)),1)]),e("div",Un,[e("div",{class:$(["checkbox-circle",y.value.has(s.name)?"checkbox-selected":"checkbox-unselected"])},[y.value.has(s.name)?(t(),a("svg",Rn,[...d[36]||(d[36]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):b("",!0)],2),e("div",Mn,[e("div",Vn,[e("span",zn,l(s.name),1),s.custom_subscription_refereance?(t(),a("span",qn,"Sub")):b("",!0)]),e("div",Bn,[e("p",En,l(s.customer_name),1),e("span",Hn,l(s.per_delivered)+"%",1)])]),e("span",Wn,l(g.formatCurrency(s.grand_total,s.currency)),1)])],10,_n))),128))]))])])]}),actions:z(()=>[e("div",Yn,[e("div",Gn,[y.value.size>0?(t(),a(I,{key:0},[e("span",Qn,l(y.value.size)+" orders ",1),d[38]||(d[38]=e("div",{class:"h-4 w-px bg-gray-200 flex-shrink-0"},null,-1)),e("span",Jn,l(g.formatCurrency(me.value)),1)],64)):b("",!0)]),e("div",Xn,[c(n(oe),{variant:"outline",class:"text-xs sm:text-sm",onClick:d[8]||(d[8]=p=>A.value=!1)},{default:z(()=>[...d[39]||(d[39]=[T("Cancel",-1)])]),_:1}),c(n(oe),{variant:"solid",theme:"green",loading:Ce.value,disabled:y.value.size===0,class:"text-xs sm:text-sm",onClick:te},{prefix:z(()=>[c(n(we),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:z(()=>[d[40]||(d[40]=T(" Create Invoice ",-1))]),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"]))}}),Zn=ft(Kn,[["__scopeId","data-v-bf1c7c7e"]]),eo={class:"w-full min-w-0"},to={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},so={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},ao={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},lo={class:"flex-1 min-w-0"},no={class:"text-sm font-black text-white truncate"},oo={key:0,class:"text-[10px] text-gray-400 font-medium"},ro={class:"text-blue-400"},io={class:"flex items-center gap-2 flex-shrink-0"},co={key:0,class:"flex-1 flex items-center justify-center"},uo={class:"flex flex-col items-center gap-4"},xo={class:"relative"},po={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},mo={key:1,class:"flex-1 flex items-center justify-center p-6"},go={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},bo={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},fo={class:"text-xs text-red-500 mt-1 break-words"},yo=["src"],vo={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},ho={class:"flex items-start gap-3"},_o={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},wo={class:"text-sm font-black text-gray-900"},ko={class:"text-xs text-gray-500 mt-1 leading-relaxed"},$o={class:"flex gap-2 justify-end"},Co={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},So={class:"flex items-start gap-3"},Do={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},Fo={class:"flex-1 min-w-0"},jo={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},Po={class:"flex justify-end"},To={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},Oo={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},Ao={class:"text-sm sm:text-base font-black leading-tight"},No={class:"bg-gradient-to-br from-orange-500 to-amber-400 rounded-xl p-3 text-white"},Io={class:"text-sm sm:text-base font-black leading-tight"},Lo={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},Uo={class:"text-sm sm:text-base font-black leading-tight"},Ro={class:"bg-gradient-to-br from-gray-500 to-gray-400 rounded-xl p-3 text-white"},Mo={class:"text-sm sm:text-base font-black leading-tight"},Vo={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},zo={class:"flex flex-wrap items-center gap-2"},qo={class:"flex items-center gap-2 flex-1 min-w-0"},Bo={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Eo={class:"min-w-0"},Ho={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Wo={key:0,class:"text-blue-500"},Yo={class:"relative"},Go={class:"flex flex-wrap gap-2 items-center"},Qo={class:"flex gap-1 flex-wrap"},Jo=["onClick"],Xo={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Ko=["max"],Zo={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},er=["min"],tr={key:0,class:"p-6 space-y-3"},sr={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},ar={class:"p-4 bg-gray-100 rounded-2xl mb-4"},lr={key:2},nr={class:"divide-y divide-gray-100/80"},or=["onClick"],rr={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},ir={class:"flex items-center gap-2 flex-wrap"},dr={class:"text-xs font-black text-gray-900 truncate"},cr={class:"text-[10px] text-gray-500 font-medium truncate"},ur={class:"flex items-center gap-2 flex-wrap mt-0.5"},xr={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},pr={class:"text-[10px] font-black text-gray-800"},mr={key:0,class:"text-[9px] text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded font-semibold"},gr={class:"hidden sm:block text-xs font-black text-gray-900 truncate"},br={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},fr={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},yr={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},vr={class:"hidden sm:flex justify-center"},hr={class:"flex justify-center text-gray-400"},_r={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},wr={key:0,class:"space-y-2"},kr={key:1,class:"space-y-4"},$r={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},Cr={class:"col-span-2 sm:col-span-1 bg-white rounded-xl p-3 border border-gray-100"},Sr={class:"text-xs font-black text-blue-700 truncate"},Dr={class:"bg-white rounded-xl p-3 border border-gray-100"},Fr={class:"text-xs font-black text-gray-800"},jr={class:"bg-white rounded-xl p-3 border border-gray-100"},Pr={class:"text-xs font-black text-gray-800"},Tr={class:"bg-white rounded-xl p-3 border border-gray-100"},Or={class:"text-xs font-black text-gray-800"},Ar={class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},Nr={class:"bg-white rounded-xl p-3 border border-gray-100"},Ir={class:"text-xs font-black text-gray-800 truncate"},Lr={class:"bg-white rounded-xl p-3 border border-gray-100"},Ur={class:"text-xs font-black text-gray-800"},Rr={class:"bg-white rounded-xl p-3 border border-gray-100"},Mr={class:"text-xs font-black text-gray-800"},Vr={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},zr={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},qr={class:"min-w-0"},Br={class:"text-xs font-semibold text-gray-800 truncate"},Er={class:"text-[9px] text-gray-400 truncate"},Hr={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},Wr={class:"text-xs text-gray-600 text-center font-medium"},Yr={class:"text-xs text-gray-600 text-center"},Gr={class:"text-xs font-black text-gray-900 text-right"},Qr={class:"border-t border-gray-200 px-4 py-3 flex justify-between items-center"},Jr={key:0,class:"text-xs text-gray-500"},Xr={class:"text-right ml-auto"},Kr={class:"text-sm font-black text-gray-900"},Zr={class:"flex flex-wrap gap-2 justify-end pt-1"},ei=["onClick"],ti=["onClick","disabled"],si=["onClick","disabled"],ai=["onClick","disabled"],li=["onClick","disabled"],ni={key:2,class:"space-y-2"},oi={key:0,class:"flex justify-center py-4"},ri=$e({__name:"Deliverynote",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(g){const M=g,k=N(""),O=N(""),A=N(""),S=N("all"),w=N(null),i=N(null),x=N(""),_=N(""),y=N({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),j=N({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),E=N({show:!1,message:""}),se=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Submitted",label:"Submitted"},{key:"Cancelled",label:"Cancelled"}],V=We({doctype:"Delivery Note",fields:["name","customer","customer_name","status","posting_date","grand_total","currency","docstatus","lr_no","lr_date","per_billed","per_returned","set_warehouse","shipping_address_name"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),Q=le({url:"frappe.client.get",makeParams:p=>({doctype:"Delivery Note",name:p.name}),onSuccess(p){i.value=p}}),q=le({url:"frappe.client.submit",onSuccess(){x.value="",_.value="",V.reload(),w.value&&Q.fetch({name:w.value})},onError(p){x.value="",_.value="",ge((p==null?void 0:p.message)||(p==null?void 0:p.exc_type)||"Submit failed")}}),D=le({url:"frappe.client.cancel",onSuccess(){x.value="",_.value="",V.reload(),w.value&&Q.fetch({name:w.value})},onError(p){x.value="",_.value="",ge((p==null?void 0:p.message)||(p==null?void 0:p.exc_type)||"Cancel failed")}}),F=le({url:"frappe.client.delete",onSuccess(){x.value="",_.value="",w.value=null,i.value=null,V.reload()},onError(p){x.value="",_.value="",ge((p==null?void 0:p.message)||(p==null?void 0:p.exc_type)||"Delete failed")}});je(()=>[M.customer,M.seller],([p])=>{const s=[];p&&s.push(["customer","=",p]),V.update({filters:s}),V.reload()},{immediate:!0});const J=R(()=>{let p=V.data||[];if(S.value!=="all"&&(p=p.filter(s=>S.value==="Draft"?s.docstatus===0:S.value==="Submitted"?s.docstatus===1:S.value==="Cancelled"?s.docstatus===2:!0)),O.value&&(p=p.filter(s=>s.posting_date>=O.value)),A.value&&(p=p.filter(s=>s.posting_date<=A.value)),k.value.trim()){const s=k.value.toLowerCase();p=p.filter(f=>{var u,o;return((u=f.name)==null?void 0:u.toLowerCase().includes(s))||((o=f.customer_name)==null?void 0:o.toLowerCase().includes(s))})}return p}),Y=R(()=>O.value!==""||A.value!==""),G=R(()=>V.loading),K=R(()=>(V.data||[]).length>0),L=R(()=>{const p=V.data||[];return{total:p.length,draft:p.filter(s=>s.docstatus===0).length,submitted:p.filter(s=>s.docstatus===1).length,cancelled:p.filter(s=>s.docstatus===2).length}});function ne(){O.value="",A.value="",S.value="all",k.value=""}function W(p){return p.docstatus===2?{label:"Cancelled",theme:"gray",icon:Le}:p.docstatus===0?{label:"Draft",theme:"orange",icon:Me}:p.per_billed>=100?{label:"Completed",theme:"green",icon:it}:p.per_billed>0?{label:"Partly Billed",theme:"blue",icon:Fe}:{label:"To Bill",theme:"purple",icon:Ye}}const ae={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function me(p){w.value===p?(w.value=null,i.value=null):(w.value=p,i.value=null,Q.fetch({name:p}))}function ge(p){const s=p.replace(/<[^>]*>/g,"").trim().split(`
`)[0];E.value={show:!0,message:s}}function de(p){return fe(this,null,function*(){var s,f;try{const u=yield fetch(`/api/method/frappe.client.get_value?doctype=Property+Setter&filters=${encodeURIComponent(JSON.stringify([["doc_type","=",p],["property","=","default_print_format"]]))}&fieldname=value`,{credentials:"include"});if(u.ok){const o=yield u.json(),m=(s=o==null?void 0:o.message)==null?void 0:s.value;if(m&&m.trim())return m.trim()}}catch(u){}try{const u=yield fetch(`/api/resource/Print+Format?filters=${encodeURIComponent(JSON.stringify([["doc_type","=",p],["disabled","=",0]]))}&fields=${encodeURIComponent(JSON.stringify(["name","default_format"]))}&order_by=modified+desc&limit=50`,{credentials:"include"});if(u.ok){const o=yield u.json(),m=(o==null?void 0:o.data)||[],U=m.find(v=>v.default_format===1);if(U!=null&&U.name)return U.name;if((f=m[0])!=null&&f.name)return m[0].name}}catch(u){}return"Standard"})}function ve(p){return fe(this,null,function*(){y.value={show:!0,loading:!0,blobUrl:"",docName:p,printFormat:"",error:""};try{const s=yield de("Delivery Note");y.value.printFormat=s;const f=`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(p)}&format=${encodeURIComponent(s)}&no_letterhead=0&letterhead=No+Letterhead`,u=yield fetch(f,{credentials:"include"});if(!u.ok){if(s!=="Standard"){const U=yield fetch(`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(p)}&format=Standard&no_letterhead=0`,{credentials:"include"});if(!U.ok)throw new Error(`HTTP ${U.status} â€” PDF generation failed`);const v=yield U.blob(),r=URL.createObjectURL(v);y.value={show:!0,loading:!1,blobUrl:r,docName:p,printFormat:"Standard (fallback)",error:""};return}throw new Error(`HTTP ${u.status} â€” PDF generation failed`)}const o=yield u.blob(),m=URL.createObjectURL(o);y.value={show:!0,loading:!1,blobUrl:m,docName:p,printFormat:s,error:""}}catch(s){const f=(s==null?void 0:s.message)||"Could not load PDF";y.value={show:!0,loading:!1,blobUrl:"",docName:p,printFormat:"",error:f}}})}function ce(){y.value.blobUrl&&URL.revokeObjectURL(y.value.blobUrl),y.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function Ce(){if(!y.value.blobUrl)return;const p=document.createElement("a");p.href=y.value.blobUrl,p.download=`${y.value.docName}.pdf`,p.click()}function te(p){j.value=De({show:!0},p)}function be(p){i.value&&te({title:"Submit Delivery Note",message:`Submit ${p}? Stock entries will be posted and cannot be easily undone.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{j.value.show=!1,x.value=p,_.value="submit",q.fetch({doc:i.value})}})}function C(p){te({title:"Cancel Delivery Note",message:`Cancel ${p}? Stock entries will be reversed.`,confirmLabel:"Cancel DN",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{j.value.show=!1,x.value=p,_.value="cancel",D.fetch({doctype:"Delivery Note",name:p})}})}function d(p){te({title:"Delete Delivery Note",message:`Permanently delete ${p}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{j.value.show=!1,x.value=p,_.value="delete",F.fetch({doctype:"Delivery Note",name:p})}})}return(p,s)=>(t(),a("div",eo,[(t(),P(Pe,{to:"body"},[c(_e,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>[y.value.show?(t(),a("div",to,[e("div",so,[e("div",ao,[c(n(Ae),{class:"w-4 h-4 text-white"})]),e("div",lo,[e("p",no,l(y.value.docName),1),y.value.printFormat?(t(),a("p",oo,[s[12]||(s[12]=T(" Format: ",-1)),e("span",ro,l(y.value.printFormat),1)])):b("",!0)]),e("div",io,[y.value.blobUrl?(t(),a("button",{key:0,onClick:Ce,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[c(n(dt),{class:"w-3.5 h-3.5"}),s[13]||(s[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):b("",!0),e("button",{onClick:ce,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[c(n(he),{class:"w-4 h-4"})])])]),y.value.loading?(t(),a("div",co,[e("div",uo,[e("div",xo,[e("div",po,[c(n(Ae),{class:"w-7 h-7 text-white/60"})]),s[14]||(s[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-blue-400 border-t-transparent animate-spin"},null,-1))]),s[15]||(s[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Detecting default print format")],-1))])])):y.value.error?(t(),a("div",mo,[e("div",go,[e("div",bo,[c(n(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[s[16]||(s[16]=e("p",{class:"text-sm font-black text-red-300"},"PDF Load Failed",-1)),e("p",fo,l(y.value.error),1)]),e("button",{onClick:ce,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Close ")])])):y.value.blobUrl?(t(),a("iframe",{key:2,src:y.value.blobUrl,class:"flex-1 w-full border-0",title:"Print Preview"},null,8,yo)):b("",!0)])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[c(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:z(()=>[j.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s[2]||(s[2]=X(f=>j.value.show=!1,["self"]))},[e("div",vo,[e("div",ho,[e("div",_o,[c(n(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",wo,l(j.value.title),1),e("p",ko,l(j.value.message),1)])]),e("div",$o,[e("button",{onClick:s[0]||(s[0]=f=>j.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"}," Go Back "),e("button",{onClick:s[1]||(s[1]=f=>j.value.onConfirm()),class:$(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",j.value.confirmClass])},l(j.value.confirmLabel),3)])])])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[c(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>[E.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s[4]||(s[4]=X(f=>E.value.show=!1,["self"]))},[e("div",Co,[e("div",So,[e("div",Do,[c(n(Te),{class:"w-5 h-5 text-red-500"})]),e("div",Fo,[s[17]||(s[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Failed",-1)),e("p",jo,l(E.value.message),1)])]),e("div",Po,[e("button",{onClick:s[3]||(s[3]=f=>E.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"}," OK ")])])])):b("",!0)]),_:1})])),e("div",To,[e("div",Oo,[s[18]||(s[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total DNs",-1)),e("p",Ao,l(L.value.total),1)]),e("div",No,[s[19]||(s[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Draft",-1)),e("p",Io,l(L.value.draft),1)]),e("div",Lo,[s[20]||(s[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Submitted",-1)),e("p",Uo,l(L.value.submitted),1)]),e("div",Ro,[s[21]||(s[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Cancelled",-1)),e("p",Mo,l(L.value.cancelled),1)])]),e("div",Vo,[e("div",zo,[e("div",qo,[e("div",Bo,[c(n(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Eo,[s[22]||(s[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Delivery Notes",-1)),e("p",Ho,[T(l(J.value.length)+" record"+l(J.value.length!==1?"s":"")+" ",1),Y.value||S.value!=="all"||k.value?(t(),a("span",Wo," (filtered)")):b("",!0)])])]),e("button",{onClick:s[5]||(s[5]=f=>n(V).reload()),class:$(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",G.value?"opacity-60 pointer-events-none":""])},[c(n(ee),{class:$(["w-3.5 h-3.5",G.value?"animate-spin":""])},null,8,["class"]),s[23]||(s[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Yo,[c(n(Ge),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),ie(e("input",{"onUpdate:modelValue":s[6]||(s[6]=f=>k.value=f),type:"text",placeholder:"Search by DN #, customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[pe,k.value]]),k.value?(t(),a("button",{key:0,onClick:s[7]||(s[7]=f=>k.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[c(n(re),{class:"w-3.5 h-3.5"})])):b("",!0)]),e("div",Go,[e("div",Qo,[(t(),a(I,null,B(se,f=>e("button",{key:f.key,onClick:u=>S.value=f.key,class:$(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",S.value===f.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},l(f.label),11,Jo)),64))]),e("div",Xo,[s[24]||(s[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),ie(e("input",{type:"date","onUpdate:modelValue":s[8]||(s[8]=f=>O.value=f),max:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Ko),[[pe,O.value]]),O.value?(t(),a("button",{key:0,onClick:s[9]||(s[9]=f=>O.value=""),class:"text-gray-300 hover:text-red-400"},[c(n(re),{class:"w-3 h-3"})])):b("",!0)]),e("div",Zo,[s[25]||(s[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),ie(e("input",{type:"date","onUpdate:modelValue":s[10]||(s[10]=f=>A.value=f),min:O.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,er),[[pe,A.value]]),A.value?(t(),a("button",{key:0,onClick:s[11]||(s[11]=f=>A.value=""),class:"text-gray-300 hover:text-red-400"},[c(n(re),{class:"w-3 h-3"})])):b("",!0)]),Y.value||S.value!=="all"||k.value?(t(),a("button",{key:0,onClick:ne,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[c(n(re),{class:"w-3 h-3"}),s[26]||(s[26]=T(" Clear All ",-1))])):b("",!0)])]),G.value&&!K.value?(t(),a("div",tr,[(t(),a(I,null,B(5,f=>e("div",{key:f,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!G.value&&J.value.length===0?(t(),a("div",sr,[e("div",ar,[c(n(Oe),{class:"w-10 h-10 text-gray-300"})]),s[27]||(s[27]=e("p",{class:"text-sm font-black text-gray-300"},"No Delivery Notes Found",-1)),s[28]||(s[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),a("div",lr,[s[43]||(s[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"DN #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Amount"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",nr,[(t(!0),a(I,null,B(J.value,f=>{var u;return t(),a("div",{key:f.name},[e("div",{onClick:o=>me(f.name),class:"grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5 hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none"},[e("div",rr,[e("div",ir,[e("span",dr,l(f.name),1),e("span",{class:$(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",ae[W(f).theme]])},[(t(),P(ye(W(f).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(W(f).label),1)],2)]),e("span",cr,l(f.customer_name),1),e("div",ur,[e("span",xr,[c(n(ke),{class:"w-2.5 h-2.5"}),T(l(f.posting_date),1)]),e("span",pr,l(g.formatCurrency(f.grand_total,f.currency)),1),f.per_billed>0&&f.per_billed<100?(t(),a("span",mr,l((u=f.per_billed)==null?void 0:u.toFixed(0))+"% billed ",1)):b("",!0)])]),e("span",gr,l(f.name),1),e("span",br,l(f.customer_name),1),e("span",fr,[c(n(ke),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),T(l(f.posting_date),1)]),e("span",yr,l(g.formatCurrency(f.grand_total,f.currency)),1),e("span",vr,[e("span",{class:$(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",ae[W(f).theme]])},[(t(),P(ye(W(f).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(W(f).label),1)],2)]),e("div",hr,[w.value===f.name?(t(),P(n(Ue),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),P(n(Re),{key:1,class:"w-4 h-4"}))])],8,or),c(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>{var o,m,U,v;return[w.value===f.name?(t(),a("div",_r,[n(Q).loading&&!i.value?(t(),a("div",wr,[(t(),a(I,null,B(4,r=>e("div",{key:r,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):i.value&&i.value.name===f.name?(t(),a("div",kr,[e("div",$r,[e("div",Cr,[s[29]||(s[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Against Sales Order",-1)),e("p",Sr,l(((o=i.value.items)==null?void 0:o.map(r=>r.against_sales_order).filter(Boolean).filter((r,h,H)=>H.indexOf(r)===h).join(", "))||"â€”"),1)]),e("div",Dr,[s[30]||(s[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Number",-1)),e("p",Fr,l(i.value.lr_no||"â€”"),1)]),e("div",jr,[s[31]||(s[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Date",-1)),e("p",Pr,l(i.value.lr_date||"â€”"),1)]),e("div",Tr,[s[32]||(s[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Billed %",-1)),e("p",Or,l((m=i.value.per_billed)!=null?m:0)+"%",1)])]),e("div",Ar,[e("div",Nr,[s[33]||(s[33]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Warehouse",-1)),e("p",Ir,l(i.value.set_warehouse||"â€”"),1)]),e("div",Lr,[s[34]||(s[34]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"% Returned",-1)),e("p",Ur,l((U=i.value.per_returned)!=null?U:0)+"%",1)]),e("div",Rr,[s[35]||(s[35]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Vehicle No",-1)),e("p",Mr,l(i.value.vehicle_no||"â€”"),1)])]),(v=i.value.items)!=null&&v.length?(t(),a("div",Vr,[s[37]||(s[37]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",zr,[(t(!0),a(I,null,B(i.value.items,r=>(t(),a("div",{key:r.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",qr,[e("p",Br,l(r.item_name),1),e("p",Er,l(r.item_code),1),r.against_sales_order?(t(),a("p",Hr," SO: "+l(r.against_sales_order),1)):b("",!0)]),e("span",Wr,l(r.qty)+" "+l(r.uom),1),e("span",Yr,l(g.formatCurrency(r.rate,i.value.currency)),1),e("span",Gr,l(g.formatCurrency(r.amount,i.value.currency)),1)]))),128))]),e("div",Qr,[i.value.total_taxes_and_charges?(t(),a("div",Jr," Tax: "+l(g.formatCurrency(i.value.total_taxes_and_charges,i.value.currency)),1)):b("",!0),e("div",Xr,[s[36]||(s[36]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase"},"Grand Total",-1)),e("p",Kr,l(g.formatCurrency(i.value.grand_total,i.value.currency)),1)])])])):b("",!0),e("div",Zr,[e("button",{onClick:X(r=>ve(f.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[c(n(Ae),{class:"w-3.5 h-3.5"}),s[38]||(s[38]=T(" Print / PDF ",-1))],8,ei),i.value.docstatus===0?(t(),a("button",{key:0,onClick:X(r=>be(f.name),["stop"]),disabled:x.value===f.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[x.value===f.name&&_.value==="submit"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(ct),{key:1,class:"w-3.5 h-3.5"})),s[39]||(s[39]=T(" Submit ",-1))],8,ti)):b("",!0),i.value.docstatus===0?(t(),a("button",{key:1,onClick:X(r=>d(f.name),["stop"]),disabled:x.value===f.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[x.value===f.name&&_.value==="delete"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),s[40]||(s[40]=T(" Delete ",-1))],8,si)):b("",!0),i.value.docstatus===1?(t(),a("button",{key:2,onClick:X(r=>C(f.name),["stop"]),disabled:x.value===f.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[x.value===f.name&&_.value==="cancel"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Le),{key:1,class:"w-3.5 h-3.5"})),s[41]||(s[41]=T(" Cancel ",-1))],8,ai)):b("",!0),i.value.docstatus===2?(t(),a("button",{key:3,onClick:X(r=>d(f.name),["stop"]),disabled:x.value===f.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[x.value===f.name&&_.value==="delete"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),s[42]||(s[42]=T(" Delete ",-1))],8,li)):b("",!0)])])):(t(),a("div",ni,[(t(),a(I,null,B(3,r=>e("div",{key:r,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):b("",!0)]}),_:2},1024)])}),128))]),G.value&&K.value?(t(),a("div",oi,[c(n(ee),{class:"w-5 h-5 text-gray-400 animate-spin"})])):b("",!0)]))]))}}),ii={class:"w-full min-w-0"},di={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},ci={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},ui={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},xi={class:"flex-1 min-w-0"},pi={class:"text-sm font-black text-white truncate"},mi={class:"text-emerald-400"},gi={class:"flex items-center gap-2 flex-shrink-0"},bi={key:0,class:"flex-1 flex items-center justify-center"},fi={class:"flex flex-col items-center gap-4"},yi={class:"relative"},vi={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},hi={key:1,class:"flex-1 flex items-center justify-center p-6"},_i={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},wi={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},ki={class:"text-xs text-red-500 mt-1 break-words"},$i=["src"],Ci={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Si={class:"flex items-start gap-3"},Di={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},Fi={class:"text-sm font-black text-gray-900"},ji={class:"text-xs text-gray-500 mt-1 leading-relaxed"},Pi={class:"flex gap-2 justify-end"},Ti={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Oi={class:"flex items-start gap-3"},Ai={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},Ni={class:"flex-1 min-w-0"},Ii={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},Li={class:"flex justify-end"},Ui={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},Ri={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},Mi={class:"text-sm sm:text-base font-black leading-tight"},Vi={class:"bg-gradient-to-br from-blue-600 to-blue-500 rounded-xl p-3 text-white"},zi={class:"text-sm sm:text-base font-black leading-tight"},qi={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},Bi={class:"text-sm sm:text-base font-black leading-tight"},Ei={class:"bg-gradient-to-br from-red-500 to-red-400 rounded-xl p-3 text-white"},Hi={class:"text-sm sm:text-base font-black leading-tight"},Wi={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},Yi={class:"flex flex-wrap items-center gap-2"},Gi={class:"flex items-center gap-2 flex-1 min-w-0"},Qi={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Ji={class:"min-w-0"},Xi={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Ki={key:0,class:"text-blue-500"},Zi={class:"relative"},ed={class:"flex flex-wrap gap-2 items-center"},td={class:"flex gap-1 flex-wrap"},sd=["onClick"],ad={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},ld=["max"],nd={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},od=["min"],rd={key:0,class:"p-6 space-y-3"},id={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},dd={class:"p-4 bg-gray-100 rounded-2xl mb-4"},cd={key:2},ud={class:"divide-y divide-gray-100/80"},xd=["onClick"],pd={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},md={class:"flex items-center gap-2 flex-wrap"},gd={class:"text-xs font-black text-gray-900"},bd={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold"},fd={class:"text-[10px] text-gray-500 font-medium truncate"},yd={class:"flex items-center gap-3 flex-wrap mt-0.5"},vd={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},hd={class:"text-[10px] font-black text-gray-900"},_d={key:0,class:"text-[9px] font-bold text-red-500"},wd={key:0,class:"mt-1.5 w-full bg-gray-200 rounded-full h-1"},kd={class:"hidden sm:flex items-center gap-1.5 min-w-0"},$d={class:"text-xs font-black text-gray-900 truncate"},Cd={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},Sd={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},Dd={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},Fd={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},jd={class:"hidden sm:flex flex-col items-end gap-1"},Pd={key:0,class:"w-16 bg-gray-200 rounded-full h-1"},Td={class:"hidden sm:flex justify-center"},Od={class:"flex justify-center text-gray-400"},Ad={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},Nd={key:0,class:"space-y-2"},Id={key:1,class:"space-y-4"},Ld={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},Ud={class:"bg-white rounded-xl p-3 border border-gray-100"},Rd={class:"bg-white rounded-xl p-3 border border-gray-100"},Md={class:"text-xs font-black text-green-700"},Vd={class:"bg-white rounded-xl p-3 border border-gray-100"},zd={class:"text-xs font-black text-gray-800"},qd={class:"bg-white rounded-xl p-3 border border-gray-100"},Bd={class:"text-xs font-black text-gray-800 truncate"},Ed={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},Hd={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},Wd={class:"min-w-0"},Yd={class:"text-xs font-semibold text-gray-800 truncate"},Gd={class:"text-[9px] text-gray-400 truncate"},Qd={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},Jd={class:"text-xs text-gray-600 text-center font-medium"},Xd={class:"text-xs text-gray-600 text-center"},Kd={class:"text-xs font-black text-gray-900 text-right"},Zd={class:"border-t border-gray-200 px-4 py-3 space-y-1.5"},ec={key:0,class:"flex justify-between text-xs text-gray-500"},tc={class:"flex justify-between items-center"},sc={class:"text-sm font-black text-gray-900"},ac={key:1,class:"flex justify-between items-center"},lc={class:"text-sm font-black text-red-600"},nc={key:1,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},oc={class:"divide-y divide-gray-100 max-h-36 overflow-y-auto"},rc={class:"text-xs text-gray-600 flex-shrink-0"},ic={class:"text-xs font-bold text-gray-500 truncate"},dc={class:"text-xs font-black text-gray-900 flex-shrink-0"},cc={class:"flex flex-wrap gap-2 justify-end pt-1"},uc=["onClick"],xc=["onClick","disabled"],pc=["onClick","disabled"],mc=["onClick","disabled"],gc=["onClick","disabled"],bc={key:2,class:"space-y-2"},fc={key:0,class:"flex justify-center py-4"},yc=$e({__name:"SalesInvoiceList",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(g){const M=g,k=N(""),O=N(""),A=N(""),S=N("all"),w=N(null),i=N(null),x=N(""),_=N(""),y=N({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),j=N({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),E=N({show:!1,message:""}),se=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Unpaid",label:"Unpaid"},{key:"Paid",label:"Paid"},{key:"Overdue",label:"Overdue"},{key:"Cancelled",label:"Cancelled"}],V=We({doctype:"Sales Invoice",fields:["name","customer","customer_name","status","posting_date","grand_total","outstanding_amount","currency","docstatus","due_date","paid_amount","discount_amount","taxes_and_charges","is_return","return_against"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),Q=le({url:"frappe.client.get",makeParams:u=>({doctype:"Sales Invoice",name:u.name}),onSuccess(u){i.value=u}}),q=le({url:"frappe.client.submit",onSuccess(){x.value="",_.value="",V.reload(),w.value&&Q.fetch({name:w.value})},onError(u){x.value="",_.value="",de((u==null?void 0:u.message)||(u==null?void 0:u.exc_type)||"Submit failed")}}),D=le({url:"frappe.client.cancel",onSuccess(){x.value="",_.value="",V.reload(),w.value&&Q.fetch({name:w.value})},onError(u){x.value="",_.value="",de((u==null?void 0:u.message)||(u==null?void 0:u.exc_type)||"Cancel failed")}}),F=le({url:"frappe.client.delete",onSuccess(){x.value="",_.value="",w.value=null,i.value=null,V.reload()},onError(u){x.value="",_.value="",de((u==null?void 0:u.message)||(u==null?void 0:u.exc_type)||"Delete failed")}});je(()=>[M.customer,M.seller],([u])=>{const o=[];u&&o.push(["customer","=",u]),V.update({filters:o}),V.reload()},{immediate:!0});const J=R(()=>{let u=V.data||[];if(S.value!=="all"&&(S.value==="Draft"?u=u.filter(o=>o.docstatus===0):S.value==="Cancelled"?u=u.filter(o=>o.docstatus===2):u=u.filter(o=>o.status===S.value)),O.value&&(u=u.filter(o=>o.posting_date>=O.value)),A.value&&(u=u.filter(o=>o.posting_date<=A.value)),k.value.trim()){const o=k.value.toLowerCase();u=u.filter(m=>{var U,v;return((U=m.name)==null?void 0:U.toLowerCase().includes(o))||((v=m.customer_name)==null?void 0:v.toLowerCase().includes(o))})}return u}),Y=R(()=>O.value!==""||A.value!==""),G=R(()=>V.loading),K=R(()=>(V.data||[]).length>0),L=R(()=>{const o=(V.data||[]).filter(m=>m.docstatus===1);return{total:o.reduce((m,U)=>m+(U.grand_total||0),0),outstanding:o.reduce((m,U)=>m+(U.outstanding_amount||0),0),paid:o.reduce((m,U)=>m+(U.paid_amount||0),0),overdue:o.filter(m=>m.status==="Overdue").length}});function ne(){O.value="",A.value="",S.value="all",k.value=""}function W(u){return u.docstatus===2?{label:"Cancelled",theme:"gray",icon:Le}:u.docstatus===0?{label:"Draft",theme:"orange",icon:Me}:u.status==="Paid"?{label:"Paid",theme:"green",icon:it}:u.status==="Overdue"?{label:"Overdue",theme:"red",icon:Fe}:u.status==="Unpaid"?{label:"Unpaid",theme:"blue",icon:qe}:u.status==="Partly Paid"?{label:"Part Paid",theme:"purple",icon:vt}:{label:u.status||"Unknown",theme:"gray",icon:we}}const ae={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function me(u){return u.grand_total?Math.round(u.outstanding_amount/u.grand_total*100):0}function ge(u){w.value===u?(w.value=null,i.value=null):(w.value=u,i.value=null,Q.fetch({name:u}))}function de(u){const o=u.replace(/<[^>]*>/g,"").trim().split(`
`)[0];E.value={show:!0,message:o}}function ve(u){return fe(this,null,function*(){var o,m,U,v,r,h;try{const H=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":ce()},body:JSON.stringify({doctype:"Print Format",filters:{doc_type:u,default_format:1,disabled:0},fieldname:"name"})});if(H.ok){const ue=yield H.json(),xe=(m=(o=ue==null?void 0:ue.message)==null?void 0:o.name)==null?void 0:m.trim();if(xe)return console.log(`[PrintFormat] âœ… Step 1a (default_format=1 via POST) â†’ "${xe}"`),xe}}catch(H){console.warn("[PrintFormat] Step 1a error:",H)}try{const H=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":ce()},body:JSON.stringify({doctype:"Property Setter",filters:{doc_type:u,property:"default_print_format"},fieldname:"value"})});if(H.ok){const ue=yield H.json(),xe=(v=(U=ue==null?void 0:ue.message)==null?void 0:U.value)==null?void 0:v.trim();if(xe)return console.log(`[PrintFormat] âœ… Step 1b (Property Setter via POST) â†’ "${xe}"`),xe}}catch(H){console.warn("[PrintFormat] Step 1b error:",H)}try{const H=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":ce()},body:JSON.stringify({doctype:"Print Format",filters:{doc_type:u,disabled:0,standard:"No"},fieldname:"name"})});if(H.ok){const ue=yield H.json(),xe=(h=(r=ue==null?void 0:ue.message)==null?void 0:r.name)==null?void 0:h.trim();if(xe)return console.log(`[PrintFormat] âœ… Step 1c (first custom format via POST) â†’ "${xe}"`),xe}}catch(H){console.warn("[PrintFormat] Step 1c error:",H)}return console.log("[PrintFormat] âš ï¸ All steps failed â€” server default will be used (format=null)"),null})}function ce(){try{const u=document.cookie.match(/csrftoken=([^;]+)/);return u?u[1]:""}catch(u){return""}}function Ce(u){return fe(this,null,function*(){y.value={show:!0,loading:!0,blobUrl:"",docName:u,printFormat:"Detectingâ€¦",error:""};try{const o=yield ve("Sales Invoice");y.value.printFormat=o!=null?o:"Server Default";const m=yield te(u,o);y.value={show:!0,loading:!1,blobUrl:URL.createObjectURL(m),docName:u,printFormat:o!=null?o:"Server Default",error:""}}catch(o){y.value={show:!0,loading:!1,blobUrl:"",docName:u,printFormat:"",error:(o==null?void 0:o.message)||"Failed to load PDF"}}})}function te(u,o){return fe(this,null,function*(){const m=v=>{const r={doctype:"Sales Invoice",name:u,no_letterhead:"0",letterhead:"No Letterhead"};return v&&(r.format=v),"/api/method/frappe.utils.print_format.download_pdf?"+new URLSearchParams(r).toString()};if(o){const v=yield fetch(m(o),{credentials:"include"});if(v.ok){const r=yield v.blob();if(r.size>500)return console.log(`[PDF] âœ… PDF ready using format "${o}"`),r}console.warn(`[PDF] Format "${o}" failed, retrying without formatâ€¦`),y.value.printFormat="Server Default"}const U=yield fetch(m(),{credentials:"include"});if(U.ok){const v=yield U.blob();if(v.size>500)return console.log("[PDF] âœ… PDF ready using server default format"),v}throw new Error(`PDF generation failed â€” HTTP ${U.status}`)})}function be(){y.value.blobUrl&&URL.revokeObjectURL(y.value.blobUrl),y.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function C(){if(!y.value.blobUrl)return;const u=document.createElement("a");u.href=y.value.blobUrl,u.download=`${y.value.docName}.pdf`,u.click()}function d(u){j.value=De({show:!0},u)}function p(u){i.value&&d({title:"Submit Sales Invoice",message:`Submit ${u}? Accounting entries will be posted.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{j.value.show=!1,x.value=u,_.value="submit",q.fetch({doc:i.value})}})}function s(u){d({title:"Cancel Sales Invoice",message:`Cancel ${u}? All accounting entries will be reversed.`,confirmLabel:"Cancel Invoice",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{j.value.show=!1,x.value=u,_.value="cancel",D.fetch({doctype:"Sales Invoice",name:u})}})}function f(u){d({title:"Delete Sales Invoice",message:`Permanently delete ${u}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{j.value.show=!1,x.value=u,_.value="delete",F.fetch({doctype:"Sales Invoice",name:u})}})}return(u,o)=>(t(),a("div",ii,[(t(),P(Pe,{to:"body"},[c(_e,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>[y.value.show?(t(),a("div",di,[e("div",ci,[e("div",ui,[c(n(Ae),{class:"w-4 h-4 text-white"})]),e("div",xi,[e("p",pi,l(y.value.docName),1),e("p",{class:$(["text-[10px] font-medium",y.value.loading?"text-gray-500 animate-pulse":"text-gray-400"])},[o[12]||(o[12]=T(" Format: ",-1)),e("span",mi,l(y.value.printFormat||"â€¦"),1)],2)]),e("div",gi,[y.value.blobUrl?(t(),a("button",{key:0,onClick:C,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[c(n(dt),{class:"w-3.5 h-3.5"}),o[13]||(o[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):b("",!0),e("button",{onClick:be,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[c(n(he),{class:"w-4 h-4"})])])]),y.value.loading?(t(),a("div",bi,[e("div",fi,[e("div",yi,[e("div",vi,[c(n(we),{class:"w-7 h-7 text-white/60"})]),o[14]||(o[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-emerald-400 border-t-transparent animate-spin"},null,-1))]),o[15]||(o[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Detecting default print format")],-1))])])):y.value.error?(t(),a("div",hi,[e("div",_i,[e("div",wi,[c(n(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[o[16]||(o[16]=e("p",{class:"text-sm font-black text-red-300"},"Failed to Load PDF",-1)),e("p",ki,l(y.value.error),1)]),e("button",{onClick:be,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Close ")])])):y.value.blobUrl?(t(),a("iframe",{key:2,src:y.value.blobUrl,class:"flex-1 w-full border-0",title:"Invoice Print Preview"},null,8,$i)):b("",!0)])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[c(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:z(()=>[j.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o[2]||(o[2]=X(m=>j.value.show=!1,["self"]))},[e("div",Ci,[e("div",Si,[e("div",Di,[c(n(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",Fi,l(j.value.title),1),e("p",ji,l(j.value.message),1)])]),e("div",Pi,[e("button",{onClick:o[0]||(o[0]=m=>j.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"},"Go Back"),e("button",{onClick:o[1]||(o[1]=m=>j.value.onConfirm()),class:$(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",j.value.confirmClass])},l(j.value.confirmLabel),3)])])])):b("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[c(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>[E.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o[4]||(o[4]=X(m=>E.value.show=!1,["self"]))},[e("div",Ti,[e("div",Oi,[e("div",Ai,[c(n(Te),{class:"w-5 h-5 text-red-500"})]),e("div",Ni,[o[17]||(o[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Failed",-1)),e("p",Ii,l(E.value.message),1)])]),e("div",Li,[e("button",{onClick:o[3]||(o[3]=m=>E.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"},"OK")])])])):b("",!0)]),_:1})])),e("div",Ui,[e("div",Ri,[o[18]||(o[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total Billed",-1)),e("p",Mi,l(g.formatCurrency(L.value.total)),1)]),e("div",Vi,[o[19]||(o[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Outstanding",-1)),e("p",zi,l(g.formatCurrency(L.value.outstanding)),1)]),e("div",qi,[o[20]||(o[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Collected",-1)),e("p",Bi,l(g.formatCurrency(L.value.paid)),1)]),e("div",Ei,[o[21]||(o[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Overdue",-1)),e("p",Hi,l(L.value.overdue)+" invoice"+l(L.value.overdue!==1?"s":""),1)])]),e("div",Wi,[e("div",Yi,[e("div",Gi,[e("div",Qi,[c(n(we),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Ji,[o[22]||(o[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Invoices",-1)),e("p",Xi,[T(l(J.value.length)+" record"+l(J.value.length!==1?"s":"")+" ",1),Y.value||S.value!=="all"||k.value?(t(),a("span",Ki," (filtered)")):b("",!0)])])]),e("button",{onClick:o[5]||(o[5]=m=>n(V).reload()),class:$(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",G.value?"opacity-60 pointer-events-none":""])},[c(n(ee),{class:$(["w-3.5 h-3.5",G.value?"animate-spin":""])},null,8,["class"]),o[23]||(o[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Zi,[c(n(Ge),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),ie(e("input",{"onUpdate:modelValue":o[6]||(o[6]=m=>k.value=m),type:"text",placeholder:"Search invoice # or customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[pe,k.value]]),k.value?(t(),a("button",{key:0,onClick:o[7]||(o[7]=m=>k.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[c(n(re),{class:"w-3.5 h-3.5"})])):b("",!0)]),e("div",ed,[e("div",td,[(t(),a(I,null,B(se,m=>e("button",{key:m.key,onClick:U=>S.value=m.key,class:$(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",S.value===m.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},l(m.label),11,sd)),64))]),e("div",ad,[o[24]||(o[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),ie(e("input",{type:"date","onUpdate:modelValue":o[8]||(o[8]=m=>O.value=m),max:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,ld),[[pe,O.value]]),O.value?(t(),a("button",{key:0,onClick:o[9]||(o[9]=m=>O.value=""),class:"text-gray-300 hover:text-red-400"},[c(n(re),{class:"w-3 h-3"})])):b("",!0)]),e("div",nd,[o[25]||(o[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),ie(e("input",{type:"date","onUpdate:modelValue":o[10]||(o[10]=m=>A.value=m),min:O.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,od),[[pe,A.value]]),A.value?(t(),a("button",{key:0,onClick:o[11]||(o[11]=m=>A.value=""),class:"text-gray-300 hover:text-red-400"},[c(n(re),{class:"w-3 h-3"})])):b("",!0)]),Y.value||S.value!=="all"||k.value?(t(),a("button",{key:0,onClick:ne,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[c(n(re),{class:"w-3 h-3"}),o[26]||(o[26]=T(" Clear All ",-1))])):b("",!0)])]),G.value&&!K.value?(t(),a("div",rd,[(t(),a(I,null,B(5,m=>e("div",{key:m,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!G.value&&J.value.length===0?(t(),a("div",id,[e("div",dd,[c(n(we),{class:"w-10 h-10 text-gray-300"})]),o[27]||(o[27]=e("p",{class:"text-sm font-black text-gray-300"},"No Invoices Found",-1)),o[28]||(o[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),a("div",cd,[o[43]||(o[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Invoice #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Grand Total"),e("span",{class:"text-right"},"Outstanding"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",ud,[(t(!0),a(I,null,B(J.value,m=>(t(),a("div",{key:m.name},[e("div",{onClick:U=>ge(m.name),class:$(["grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_36px]","gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5","hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none",m.status==="Overdue"?"bg-red-50/30":""])},[e("div",pd,[e("div",md,[e("span",gd,l(m.name),1),m.is_return?(t(),a("span",bd,"Return")):b("",!0),e("span",{class:$(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",ae[W(m).theme]])},[(t(),P(ye(W(m).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(W(m).label),1)],2)]),e("span",fd,l(m.customer_name),1),e("div",yd,[e("span",vd,[c(n(ke),{class:"w-2.5 h-2.5"}),T(l(m.posting_date),1)]),e("span",hd,l(g.formatCurrency(m.grand_total,m.currency)),1),m.outstanding_amount>0?(t(),a("span",_d,"Due: "+l(g.formatCurrency(m.outstanding_amount,m.currency)),1)):b("",!0)]),m.docstatus===1&&m.grand_total>0?(t(),a("div",wd,[e("div",{style:Xe({width:`${100-me(m)}%`}),class:$(["h-1 rounded-full transition-all",m.status==="Paid"?"bg-green-500":m.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):b("",!0)]),e("div",kd,[e("span",$d,l(m.name),1),m.is_return?(t(),a("span",Cd,"Return")):b("",!0)]),e("span",Sd,l(m.customer_name),1),e("span",Dd,[c(n(ke),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),T(l(m.posting_date),1)]),e("span",Fd,l(g.formatCurrency(m.grand_total,m.currency)),1),e("div",jd,[e("span",{class:$(["text-xs font-black",m.outstanding_amount>0?"text-red-600":"text-gray-400"])},l(m.outstanding_amount>0?g.formatCurrency(m.outstanding_amount,m.currency):"â€”"),3),m.docstatus===1&&m.grand_total>0?(t(),a("div",Pd,[e("div",{style:Xe({width:`${100-me(m)}%`}),class:$(["h-1 rounded-full",m.status==="Paid"?"bg-green-500":m.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):b("",!0)]),e("span",Td,[e("span",{class:$(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",ae[W(m).theme]])},[(t(),P(ye(W(m).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),T(" "+l(W(m).label),1)],2)]),e("div",Od,[w.value===m.name?(t(),P(n(Ue),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),P(n(Re),{key:1,class:"w-4 h-4"}))])],10,xd),c(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>{var U,v;return[w.value===m.name?(t(),a("div",Ad,[n(Q).loading&&!i.value?(t(),a("div",Nd,[(t(),a(I,null,B(4,r=>e("div",{key:r,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):i.value&&i.value.name===m.name?(t(),a("div",Id,[e("div",Ld,[e("div",Ud,[o[29]||(o[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Due Date",-1)),e("p",{class:$(["text-xs font-black",i.value.status==="Overdue"?"text-red-600":"text-gray-800"])},l(i.value.due_date||"â€”"),3)]),e("div",Rd,[o[30]||(o[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid Amount",-1)),e("p",Md,l(g.formatCurrency(i.value.paid_amount||0,i.value.currency)),1)]),e("div",Vd,[o[31]||(o[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Discount",-1)),e("p",zd,l(g.formatCurrency(i.value.discount_amount||0,i.value.currency)),1)]),e("div",qd,[o[32]||(o[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Tax Template",-1)),e("p",Bd,l(i.value.taxes_and_charges||"â€”"),1)])]),(U=i.value.items)!=null&&U.length?(t(),a("div",Ed,[o[36]||(o[36]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",Hd,[(t(!0),a(I,null,B(i.value.items,r=>(t(),a("div",{key:r.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",Wd,[e("p",Yd,l(r.item_name),1),e("p",Gd,l(r.item_code),1),r.delivery_note?(t(),a("p",Qd,"DN: "+l(r.delivery_note),1)):b("",!0)]),e("span",Jd,l(r.qty)+" "+l(r.uom),1),e("span",Xd,l(g.formatCurrency(r.rate,i.value.currency)),1),e("span",Kd,l(g.formatCurrency(r.amount,i.value.currency)),1)]))),128))]),e("div",Zd,[i.value.total_taxes_and_charges?(t(),a("div",ec,[o[33]||(o[33]=e("span",null,"Taxes",-1)),e("span",null,l(g.formatCurrency(i.value.total_taxes_and_charges,i.value.currency)),1)])):b("",!0),e("div",tc,[o[34]||(o[34]=e("span",{class:"text-xs font-black text-gray-500 uppercase tracking-wide"},"Grand Total",-1)),e("span",sc,l(g.formatCurrency(i.value.grand_total,i.value.currency)),1)]),i.value.outstanding_amount>0?(t(),a("div",ac,[o[35]||(o[35]=e("span",{class:"text-xs font-bold text-red-500 uppercase tracking-wide"},"Outstanding",-1)),e("span",lc,l(g.formatCurrency(i.value.outstanding_amount,i.value.currency)),1)])):b("",!0)])])):b("",!0),(v=i.value.payment_schedule)!=null&&v.length?(t(),a("div",nc,[o[37]||(o[37]=e("div",{class:"px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[10px] font-black text-gray-500 uppercase tracking-widest"},"Payment Schedule",-1)),e("div",oc,[(t(!0),a(I,null,B(i.value.payment_schedule,r=>(t(),a("div",{key:r.name,class:"flex items-center justify-between gap-2 px-4 py-2.5"},[e("span",rc,l(r.due_date),1),e("span",ic,l(r.payment_term),1),e("span",dc,l(g.formatCurrency(r.payment_amount,i.value.currency)),1),e("span",{class:$(["text-[9px] font-bold px-1.5 py-0.5 rounded-full flex-shrink-0",r.outstanding>0?"bg-red-50 text-red-600":"bg-green-50 text-green-600"])},l(r.outstanding>0?"Due":"Paid"),3)]))),128))])])):b("",!0),e("div",cc,[e("button",{onClick:X(r=>Ce(m.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[c(n(Ae),{class:"w-3.5 h-3.5"}),o[38]||(o[38]=T("Print / PDF ",-1))],8,uc),i.value.docstatus===0?(t(),a("button",{key:0,onClick:X(r=>p(m.name),["stop"]),disabled:x.value===m.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[x.value===m.name&&_.value==="submit"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(ct),{key:1,class:"w-3.5 h-3.5"})),o[39]||(o[39]=T("Submit ",-1))],8,xc)):b("",!0),i.value.docstatus===0?(t(),a("button",{key:1,onClick:X(r=>f(m.name),["stop"]),disabled:x.value===m.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[x.value===m.name&&_.value==="delete"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),o[40]||(o[40]=T("Delete ",-1))],8,pc)):b("",!0),i.value.docstatus===1?(t(),a("button",{key:2,onClick:X(r=>s(m.name),["stop"]),disabled:x.value===m.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[x.value===m.name&&_.value==="cancel"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Le),{key:1,class:"w-3.5 h-3.5"})),o[41]||(o[41]=T("Cancel ",-1))],8,mc)):b("",!0),i.value.docstatus===2?(t(),a("button",{key:3,onClick:X(r=>f(m.name),["stop"]),disabled:x.value===m.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[x.value===m.name&&_.value==="delete"?(t(),P(n(ee),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(n(Ie),{key:1,class:"w-3.5 h-3.5"})),o[42]||(o[42]=T("Delete ",-1))],8,gc)):b("",!0)])])):(t(),a("div",bc,[(t(),a(I,null,B(3,r=>e("div",{key:r,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):b("",!0)]}),_:2},1024)]))),128))]),G.value&&K.value?(t(),a("div",fc,[c(n(ee),{class:"w-5 h-5 text-gray-400 animate-spin"})])):b("",!0)]))]))}}),vc={class:"w-full min-w-0 max-w-7xl mx-auto font-sans text-gray-900 px-0 sm:px-4 md:px-6 pt-[env(safe-area-inset-top,0px)] pb-[calc(120px+env(safe-area-inset-bottom,0px))] sm:pb-[env(safe-area-inset-bottom,16px)] space-y-3 sm:space-y-4 md:space-y-5"},hc={class:"hidden sm:flex items-center justify-between gap-2 pt-1 flex-wrap"},_c={class:"flex gap-1 bg-gray-100 p-1 rounded-xl"},wc=["onClick"],kc={class:"px-2 sm:px-0"},$c={class:"bg-white border-y sm:border border-gray-100 sm:rounded-2xl shadow-sm overflow-hidden w-full min-w-0"},Cc={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24 text-center px-6"},Sc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Dc={class:"hidden sm:block border-b border-gray-100 overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden"},Fc={class:"flex min-w-max"},jc=["onClick"],Pc={key:0,class:"absolute bottom-0 left-0 right-0 h-[2.5px] bg-gray-900 rounded-t-full"},Tc={key:0,class:"sm:hidden flex items-center gap-2 px-3 py-2.5 border-b border-gray-100 bg-gray-50/60"},Oc={class:"text-sm font-black text-gray-800"},Ac={key:1,class:"flex flex-col items-center justify-center py-16 sm:py-24 text-center px-6"},Nc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Ic={key:2,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},Lc={class:"w-full flex justify-end px-3 pb-4"},Uc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Rc={class:"border-b border-gray-100 bg-gray-50/60"},Mc={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pt-3 pb-2"},Vc={class:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0"},zc={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},qc={class:"min-w-0"},Bc={class:"flex items-center gap-1.5 flex-wrap mt-0.5"},Ec={class:"text-[10px] sm:text-xs text-gray-400 font-medium"},Hc={key:0},Wc={key:1},Yc={key:2},Gc={key:3},Qc={class:"text-[9px] font-bold text-blue-600 bg-blue-50 border border-blue-100 px-1.5 py-0.5 rounded-full whitespace-nowrap"},Jc={class:"text-[9px] text-gray-400 font-semibold"},Xc={class:"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end"},Kc={class:"flex items-center justify-center w-5 h-5 bg-white/20 rounded-md flex-shrink-0"},Zc=["title"],e0={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pb-3"},t0={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},s0=["max"],a0={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},l0=["min"],n0={key:1,class:"text-[10px] text-gray-400 font-semibold"},o0={key:6,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},r0={class:"w-full flex justify-end px-3 pb-4"},i0={class:"p-4 bg-gray-100 rounded-2xl mb-4"},d0={key:7,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},c0={class:"w-full flex justify-end px-3 pb-4"},u0={class:"p-4 bg-gray-100 rounded-2xl mb-4"},x0={key:1,class:"px-2 sm:px-0"},p0={class:"sm:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/96 backdrop-blur-xl border-t border-gray-200 pb-[env(safe-area-inset-bottom,0px)] shadow-[0_-4px_32px_rgba(0,0,0,0.10)]",style:{"will-change":"transform"}},m0={class:"flex border-b border-gray-100"},g0=["onClick"],b0={key:0,class:"flex overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden overscroll-x-contain"},f0=["onClick"],y0={key:0,class:"absolute top-0 left-1/2 -translate-x-1/2 w-6 h-[2px] bg-gray-900 rounded-b-full"},v0={class:"leading-tight text-center whitespace-nowrap"},h0={key:1,class:"flex items-center justify-center py-2 px-4"},$0=$e({__name:"SellerHomeComponent",props:{filters:{}},setup(g){const M=g,k=yt("showToast"),O=N("dashboard"),A=[{key:"dashboard",label:"Dashboard",icon:wt},{key:"customers",label:"My Customers",icon:at}],S=N(null),w=[{key:"quotation",label:"Quotation",shortLabel:"Quote",icon:Ke},{key:"salesorder",label:"Sales Order",shortLabel:"SO",icon:Ve},{key:"delivery",label:"Delivery Note",shortLabel:"Delivery",icon:Oe},{key:"invoice",label:"Sales Invoice",shortLabel:"Invoice",icon:we},{key:"payment",label:"Payment",shortLabel:"Payment",icon:qe},{key:"customer_ledger",label:"Customer Ledger",shortLabel:"Ledger",icon:Ze}],i=R(()=>S.value?w.find(v=>v.key===S.value):null),x=R(()=>!!M.filters.customer),_=N("all"),y=N(""),j=N(""),E=R(()=>y.value!==""||j.value!=="");function se(){y.value="",j.value=""}const V=N(!1),Q=N(!1),q=N(""),D=N(""),F=N(null),J=N(null),Y=We({doctype:"Sales Order",fields:["name","customer","customer_name","status","grand_total","currency","docstatus","per_delivered","per_billed","transaction_date","custom_subscription_refereance"],filters:{},orderBy:"transaction_date desc",pageLength:200,auto:!0}),G=le({url:"frappe.client.get",makeParams:v=>({doctype:"Sales Order",name:v.name}),onSuccess(v){J.value=v}}),K=le({url:"my_frappe_app.api.process_order_workflow",auto:!1}),L=le({url:"my_frappe_app.api.get_seller_subscriptions"}),ne=le({url:"my_frappe_app.api.process_subscription",onSuccess(v){D.value="",v.status==="success"?(k(v.message,"success"),L.fetch({seller:W.value})):k(v.message||"Operation failed","error")},onError(v){D.value="",k((v==null?void 0:v.message)||"Error","error")}}),W=R(()=>M.filters.seller||""),ae=R(()=>M.filters.customer||""),me=R(()=>{const v=(M.filters.category||"").toLowerCase();return v.includes("newspaper")||v.includes("news paper")}),ge=R(()=>{var r;return!ae.value||!me.value?[]:(((r=L.data)==null?void 0:r.subscriptions)||[]).filter(h=>h.customer===ae.value||h.customer_name===ae.value)}),de=R(()=>{const v=Y.data||[];return E.value?v.filter(r=>{const h=r.transaction_date||"";return!(y.value&&h<y.value||j.value&&h>j.value)}):v}),ve=R(()=>{const v=[],r=me.value&&!!ae.value;if(r&&(_.value==="all"||_.value==="subscription_pending"))for(const h of ge.value)_.value==="subscription_pending"&&h.status!=="Accept Pending"||v.push(De({row_type:"subscription"},h));if(_.value!=="subscription_pending")for(const h of de.value){const H=!!h.custom_subscription_refereance;H&&!r||_.value==="daily"&&!H||_.value==="normal"&&H||v.push(De({row_type:"order"},h))}return v}),ce=R(()=>ve.value.filter(v=>v.row_type==="order").length),Ce=R(()=>{const v=ge.value,r=Y.data||[];return{subPending:v.filter(h=>h.status==="Accept Pending").length,subActive:v.filter(h=>h.status==="Active").length,orderPending:r.filter(h=>Number(h.docstatus)===0&&!h.custom_subscription_refereance).length,toDeliver:r.filter(h=>{var H;return Number(h.docstatus)===1&&Number((H=h.per_delivered)!=null?H:0)<100}).length,completed:r.filter(h=>{var H;return Number((H=h.per_delivered)!=null?H:0)>=100}).length}}),te=R(()=>(Y.data||[]).filter(v=>{var r,h;return Number(v.docstatus)===1&&Number((r=v.per_delivered)!=null?r:0)>0&&Number((h=v.per_billed)!=null?h:100)<100})),be=R(()=>S.value==="salesorder"?L.loading||Y.loading:!1);je(()=>[M.filters.customer,M.filters.seller],([v,r])=>{v&&(Y.update({filters:{customer:v}}),Y.reload()),r&&L.fetch({seller:r})},{immediate:!0});function C(v){return["Completed","To Bill","To Deliver"].includes(v)?"green":v==="Draft"?"red":v==="Cancelled"?"gray":"orange"}function d(v,r="INR"){return new Intl.NumberFormat("en-IN",{style:"currency",currency:r}).format(v)}function p(v){J.value=null,V.value=!0,G.fetch({name:v.name})}function s(v,r){return fe(this,null,function*(){q.value=v;try{const h=yield K.submit({order_id:v,action:r});(h==null?void 0:h.status)==="success"?(k(h.message,"success"),yield Y.reload(),V.value&&G.fetch({name:v})):k((h==null?void 0:h.message)||"Operation Failed","error")}catch(h){k((h==null?void 0:h.message)||"System Error","error")}finally{q.value=""}})}function f(v,r){D.value=v,ne.fetch({sub_name:v,action:r})}function u(v){F.value=F.value===v?null:v}function o(){S.value=null,L.fetch({seller:W.value}),Y.reload()}function m(v){k(`Invoice ${v} created successfully!`,"success"),Y.reload()}function U(){}return(v,r)=>(t(),a(I,null,[e("div",vc,[e("div",hc,[e("div",_c,[(t(),a(I,null,B(A,h=>e("button",{key:h.key,onClick:H=>O.value=h.key,class:$(["flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-bold transition-all whitespace-nowrap",O.value===h.key?"bg-gray-900 text-white shadow-sm":"text-gray-500 hover:text-gray-700"])},[(t(),P(ye(h.icon),{class:"w-4 h-4 flex-shrink-0"})),T(" "+l(h.label),1)],10,wc)),64))]),c(n(oe),{variant:"outline",size:"sm",loading:n(L).loading||n(Y).loading,class:"text-sm",onClick:o},{prefix:z(()=>[c(n(ee),{class:"w-4 h-4"})]),default:z(()=>[r[10]||(r[10]=T(" Refresh ",-1))]),_:1},8,["loading"])]),O.value==="dashboard"?(t(),a(I,{key:0},[e("div",kc,[c(Rt,{stats:Ce.value,"active-filter":_.value,"onUpdate:activeFilter":r[0]||(r[0]=h=>_.value=h)},null,8,["stats","active-filter"])]),e("div",$c,[x.value?(t(),a(I,{key:1},[e("div",Dc,[e("div",Fc,[(t(),a(I,null,B(w,h=>e("button",{key:h.key,onClick:H=>S.value=h.key,class:$(["relative flex items-center gap-2 px-5 md:px-7 py-3.5 text-sm font-bold transition-all whitespace-nowrap",S.value===h.key?"text-gray-900 bg-gray-50/80":"text-gray-400 hover:text-gray-600 hover:bg-gray-50/40"])},[S.value===h.key?(t(),a("span",Pc)):b("",!0),(t(),P(ye(h.icon),{class:"w-4 h-4 flex-shrink-0"})),T(" "+l(h.label),1)],10,jc)),64))])]),i.value?(t(),a("div",Tc,[(t(),P(ye(i.value.icon),{class:"w-4 h-4 text-gray-700 flex-shrink-0"})),e("span",Oc,l(i.value.label),1)])):b("",!0),S.value===null?(t(),a("div",Ac,[e("div",Nc,[c(n(Ve),{class:"w-10 h-10 text-gray-300"})]),r[13]||(r[13]=e("p",{class:"text-sm font-black text-gray-400"},"Select a Tab",-1)),r[14]||(r[14]=e("p",{class:"text-xs text-gray-300 mt-1.5"}," Choose a section above to get started. ",-1))])):S.value==="quotation"?(t(),a("div",Ic,[e("div",Lc,[e("button",{onClick:o,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[c(n(ee),{class:"w-3.5 h-3.5"}),r[15]||(r[15]=T(" Refresh ",-1))])]),e("div",Uc,[c(n(Ke),{class:"w-10 h-10 text-gray-300"})]),r[16]||(r[16]=e("p",{class:"text-base font-black text-gray-300"},"Quotation",-1)),r[17]||(r[17]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):S.value==="salesorder"?(t(),a(I,{key:3},[e("div",Rc,[e("div",Mc,[e("div",Vc,[e("div",zc,[c(n(Ve),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",qc,[r[19]||(r[19]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Orders",-1)),e("div",Bc,[e("span",Ec,[_.value==="all"?(t(),a("span",Hc,"All â€” Subscriptions & Orders")):_.value==="subscription_pending"?(t(),a("span",Wc,"Subscription Requests")):_.value==="daily"?(t(),a("span",Yc,"Daily Auto-Orders")):_.value==="normal"?(t(),a("span",Gc,"Normal Orders")):b("",!0)]),E.value?(t(),a(I,{key:0},[e("span",Qc,l(y.value||"â€¦")+" â†’ "+l(j.value||"â€¦"),1),e("span",Jc,l(ce.value)+" orders",1),e("button",{onClick:se,class:"flex items-center gap-0.5 text-[9px] font-bold text-red-500 hover:text-red-600 whitespace-nowrap"},[c(n(re),{class:"w-3 h-3"}),r[18]||(r[18]=T(" Clear ",-1))])],64)):b("",!0)])])]),e("div",Xc,[e("button",{onClick:U,class:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-colors whitespace-nowrap shadow-sm"},[e("span",Kc,[c(n(ht),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),r[20]||(r[20]=e("span",{class:"hidden sm:inline"},"Create Sales Order",-1)),r[21]||(r[21]=e("span",{class:"sm:hidden"},"New SO",-1))]),e("button",{onClick:r[1]||(r[1]=h=>te.value.length>0?Q.value=!0:void 0),class:$(["flex items-center gap-1.5 sm:gap-2 font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-all whitespace-nowrap shadow-sm",te.value.length>0?"bg-green-600 hover:bg-green-700 active:bg-green-800 text-white cursor-pointer":"bg-gray-200 hover:bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"]),title:te.value.length===0?"No eligible orders to invoice":`${te.value.length} orders eligible`},[e("span",{class:$(["flex items-center justify-center w-5 h-5 rounded-md flex-shrink-0",te.value.length>0?"bg-white/20":"bg-gray-300/50"])},[c(n(we),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})],2),r[22]||(r[22]=e("span",{class:"hidden sm:inline"},"Create Invoice",-1)),r[23]||(r[23]=e("span",{class:"sm:hidden"},"Invoice",-1)),e("span",{class:$(["text-[10px] font-black px-1.5 py-0.5 rounded-full leading-none",te.value.length>0?"bg-white/25 text-white":"bg-gray-300 text-gray-500"])},l(te.value.length),3)],10,Zc),_.value!=="all"?(t(),a("button",{key:0,onClick:r[2]||(r[2]=h=>_.value="all"),class:"flex items-center gap-1 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-gray-600 text-xs font-semibold px-2.5 py-2 rounded-lg transition-all whitespace-nowrap"},[c(n(re),{class:"w-3.5 h-3.5 flex-shrink-0"}),r[24]||(r[24]=T(" Clear ",-1))])):b("",!0),e("button",{onClick:o,class:$(["flex items-center gap-1.5 px-2.5 sm:px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-xs font-semibold text-gray-600 transition-all",be.value?"opacity-60 pointer-events-none":""])},[c(n(ee),{class:$(["w-3.5 h-3.5 flex-shrink-0",be.value?"animate-spin":""])},null,8,["class"]),r[25]||(r[25]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)])]),e("div",e0,[e("div",t0,[r[26]||(r[26]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"From",-1)),ie(e("input",{type:"date","onUpdate:modelValue":r[3]||(r[3]=h=>y.value=h),max:j.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,s0),[[pe,y.value]]),y.value?(t(),a("button",{key:0,onClick:r[4]||(r[4]=X(h=>y.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[c(n(re),{class:"w-3 h-3"})])):b("",!0)]),e("div",a0,[r[27]||(r[27]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"To",-1)),ie(e("input",{type:"date","onUpdate:modelValue":r[5]||(r[5]=h=>j.value=h),min:y.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,l0),[[pe,j.value]]),j.value?(t(),a("button",{key:0,onClick:r[6]||(r[6]=X(h=>j.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[c(n(re),{class:"w-3 h-3"})])):b("",!0)]),E.value?(t(),a("button",{key:0,onClick:se,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[c(n(re),{class:"w-3 h-3"}),r[28]||(r[28]=T(" Clear Dates ",-1))])):b("",!0),E.value?(t(),a("span",n0,l(ce.value)+" orders ",1)):b("",!0)])]),c($s,{"combined-rows":ve.value,loading:n(L).loading||n(Y).loading,"active-filter":_.value,"expanded-sub-id":F.value,"processing-sub-id":D.value,"processing-id":q.value,"format-currency":d,"get-status-theme":C,onToggleSubExpand:u,onSubAction:f,onOpenOrderDetail:p,onOrderAction:s,onShowAll:r[7]||(r[7]=h=>_.value="all")},null,8,["combined-rows","loading","active-filter","expanded-sub-id","processing-sub-id","processing-id"])],64)):S.value==="delivery"?(t(),P(ri,{key:4,customer:ae.value,seller:W.value,"format-currency":d},null,8,["customer","seller"])):S.value==="invoice"?(t(),P(yc,{key:5,customer:ae.value,seller:W.value,"format-currency":d},null,8,["customer","seller"])):S.value==="payment"?(t(),a("div",o0,[e("div",r0,[e("button",{onClick:o,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[c(n(ee),{class:"w-3.5 h-3.5"}),r[29]||(r[29]=T(" Refresh ",-1))])]),e("div",i0,[c(n(qe),{class:"w-10 h-10 text-gray-300"})]),r[30]||(r[30]=e("p",{class:"text-base font-black text-gray-300"},"Payment",-1)),r[31]||(r[31]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):S.value==="customer_ledger"?(t(),a("div",d0,[e("div",c0,[e("button",{onClick:o,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[c(n(ee),{class:"w-3.5 h-3.5"}),r[32]||(r[32]=T(" Refresh ",-1))])]),e("div",u0,[c(n(Ze),{class:"w-10 h-10 text-gray-300"})]),r[33]||(r[33]=e("p",{class:"text-base font-black text-gray-300"},"Customer Ledger",-1)),r[34]||(r[34]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):b("",!0)],64)):(t(),a("div",Cc,[e("div",Sc,[c(n(Ct),{class:"w-10 h-10 text-gray-300"})]),r[11]||(r[11]=e("p",{class:"text-sm font-black text-gray-400"},"No Customer Selected",-1)),r[12]||(r[12]=e("p",{class:"text-xs text-gray-300 mt-1.5 max-w-xs leading-relaxed"}," Select a customer from the sidebar to view their selling cycle â€” quotations, orders, deliveries, invoices and more. ",-1))]))])],64)):b("",!0),O.value==="customers"?(t(),a("div",x0,[c(xl,{seller:W.value},null,8,["seller"])])):b("",!0),c(ea,{modelValue:V.value,"onUpdate:modelValue":r[8]||(r[8]=h=>V.value=h),"order-details":J.value,"processing-id":q.value,"format-currency":d,"get-status-theme":C,onOrderAction:s},null,8,["modelValue","order-details","processing-id"]),c(Zn,{modelValue:Q.value,"onUpdate:modelValue":r[9]||(r[9]=h=>Q.value=h),"eligible-orders":te.value,seller:W.value,"format-currency":d,onInvoiceCreated:m},null,8,["modelValue","eligible-orders","seller"])]),e("nav",p0,[e("div",m0,[(t(),a(I,null,B(A,h=>e("button",{key:h.key,onClick:H=>O.value=h.key,class:$(["flex-1 flex flex-col items-center justify-center gap-0.5 py-2 px-1 text-[10px] font-bold transition-all active:scale-95",O.value===h.key?"text-gray-900":"text-gray-400"])},[e("div",{class:$(["p-1.5 rounded-xl transition-all",O.value===h.key?"bg-gray-900 text-white":"text-gray-400"])},[(t(),P(ye(h.icon),{class:"w-4 h-4"}))],2),T(" "+l(h.label),1)],10,g0)),64))]),O.value==="dashboard"&&x.value?(t(),a("div",b0,[(t(),a(I,null,B(w,h=>e("button",{key:h.key,onClick:H=>S.value=h.key,class:$(["relative flex-shrink-0 flex flex-col items-center justify-center gap-0.5","px-3 py-2 min-w-[58px] text-[9px] font-bold transition-all active:scale-95",S.value===h.key?"text-gray-900":"text-gray-400"])},[S.value===h.key?(t(),a("span",y0)):b("",!0),(t(),P(ye(h.icon),{class:$(["w-[18px] h-[18px] transition-all",S.value===h.key?"text-gray-900":"text-gray-400"])},null,8,["class"])),e("span",v0,l(h.shortLabel),1)],10,f0)),64))])):O.value==="dashboard"&&!x.value?(t(),a("div",h0,[...r[35]||(r[35]=[e("p",{class:"text-[9px] text-gray-300 font-medium"},"Select a customer to view selling cycle",-1)])])):b("",!0)])],64))}});export{$0 as default};
