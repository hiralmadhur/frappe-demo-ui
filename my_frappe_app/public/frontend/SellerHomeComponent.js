var ut=Object.defineProperty;var Qe=Object.getOwnPropertySymbols;var xt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Ge=(m,U,w)=>U in m?ut(m,U,{enumerable:!0,configurable:!0,writable:!0,value:w}):m[U]=w,De=(m,U)=>{for(var w in U||(U={}))xt.call(U,w)&&Ge(m,w,U[w]);if(Qe)for(var w of Qe(U))pt.call(U,w)&&Ge(m,w,U[w]);return m};var be=(m,U,w)=>new Promise((O,A)=>{var F=c=>{try{i(w.next(c))}catch(h){A(h)}},_=c=>{try{i(w.throw(c))}catch(h){A(h)}},i=c=>c.done?O(c.value):Promise.resolve(c.value).then(F,_);i((w=w.apply(m,U)).next())});import{c as X,d as $e,o as t,a,b as e,n as $,t as l,e as u,u as o,C as Ie,f as mt,_ as Ee,g as f,F as L,r as q,h as j,w as R,i as G,j as oe,k as P,l as Ue,m as Re,p as N,q as se,s as gt,v as ie,x as xe,y as st,U as at,z as I,M as bt,A as je,B as Fe,X as he,D as ft,E as He,T as Pe,G as _e,H as fe,I as Je,S as Ke,J as yt}from"./index.js";import{N as Se,C as Me,T as Oe,P as We,a as lt,S as Ve,_ as nt,b as ke,F as ot,D as rt,R as K,c as re,d as Le,e as vt,f as Xe,g as ht}from"./truck.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=X("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=X("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=X("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=X("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=X("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=X("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=X("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=X("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=X("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=X("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=X("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=X("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=X("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=X("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=X("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=X("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=X("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=X("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Ct={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3 md:gap-4"},St={class:"min-w-0"},Dt={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-green-100 shadow-sm flex items-center justify-between"},Ft={class:"min-w-0"},jt={class:"text-2xl sm:text-3xl font-black text-gray-900"},Pt={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-green-50 flex items-center justify-center text-green-600 flex-shrink-0 ml-2"},Tt={class:"min-w-0"},Ot={class:"min-w-0"},At={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-emerald-100 shadow-sm flex items-center justify-between col-span-2 sm:col-span-1"},It={class:"min-w-0"},Lt={class:"text-2xl sm:text-3xl font-black text-gray-900"},Nt={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-600 flex-shrink-0 ml-2"},Ut=$e({__name:"SellerStatsCards",props:{stats:{},activeFilter:{}},emits:["update:activeFilter"],setup(m,{emit:U}){const w=m,O=U,A=F=>{O("update:activeFilter",w.activeFilter===F?"all":F)};return(F,_)=>(t(),a("div",Ct,[e("button",{onClick:_[0]||(_[0]=i=>A("subscription_pending")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="subscription_pending"?"bg-amber-500 border-amber-500":"bg-white border-amber-100 hover:border-amber-300"])},[e("div",St,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="subscription_pending"?"text-amber-100":"text-amber-400"])}," Sub Pending ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",m.activeFilter==="subscription_pending"?"text-white":"text-gray-900"])},l(m.stats.subPending),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="subscription_pending"?"bg-amber-400 text-white":"bg-amber-50 text-amber-500 hover:bg-amber-500 hover:text-white"])},[u(o(Se),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",Dt,[e("div",Ft,[_[3]||(_[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1 truncate"}," Sub Active ",-1)),e("p",jt,l(m.stats.subActive),1)]),e("div",Pt,[u(o(Ie),{class:"w-4 h-4 sm:w-5 sm:h-5"})])]),e("button",{onClick:_[1]||(_[1]=i=>A("normal")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="normal"?"bg-orange-500 border-orange-500":"bg-white border-orange-100 hover:border-orange-300"])},[e("div",Tt,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="normal"?"text-orange-100":"text-orange-400"])}," To Accept ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",m.activeFilter==="normal"?"text-white":"text-gray-900"])},l(m.stats.orderPending),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="normal"?"bg-orange-400 text-white":"bg-orange-50 text-orange-500 hover:bg-orange-500 hover:text-white"])},[u(o(Me),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("button",{onClick:_[2]||(_[2]=i=>A("daily")),class:$(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="daily"?"bg-blue-600 border-blue-600":"bg-white border-blue-100 hover:border-blue-300"])},[e("div",Ot,[e("p",{class:$(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="daily"?"text-blue-200":"text-blue-400"])}," Daily Orders ",2),e("p",{class:$(["text-2xl sm:text-3xl font-black",m.activeFilter==="daily"?"text-white":"text-gray-900"])},l(m.stats.toDeliver),3)]),e("div",{class:$(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="daily"?"bg-blue-500 text-white":"bg-blue-50 text-blue-500 hover:bg-blue-600 hover:text-white"])},[u(o(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",At,[e("div",It,[_[4]||(_[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-emerald-500 uppercase tracking-widest mb-1 truncate"}," Completed ",-1)),e("p",Lt,l(m.stats.completed),1)]),e("div",Nt,[u(o(Ie),{class:"w-4 h-4 sm:w-5 sm:h-5"})])])]))}}),Rt={class:"w-full min-w-0"},Mt={class:"min-h-[300px] sm:min-h-[400px]"},Vt={key:0,class:"flex flex-col items-center justify-center py-20 sm:py-32"},zt={key:1,class:"flex flex-col items-center justify-center py-20 sm:py-32 px-4 text-center"},qt={key:2,class:"divide-y divide-gray-50"},Bt={class:"flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2"},Et={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},Ht={class:"min-w-0 flex-1"},Wt={class:"flex items-center gap-1.5 flex-wrap"},Yt={class:"font-black text-gray-900 font-mono text-xs sm:text-sm"},Qt={class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-amber-200"},Gt={class:"text-[10px] sm:text-xs text-gray-500 mt-0.5 flex flex-wrap gap-x-1"},Jt={class:"font-semibold text-gray-700 truncate max-w-[140px] sm:max-w-none"},Kt={class:"text-gray-400 text-[9px] sm:text-[10px]"},Xt={class:"text-[9px] sm:text-[10px] text-gray-400 mt-0.5 truncate"},Zt={class:"font-semibold text-gray-600"},es={class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap"},ts={class:"flex items-center gap-1 bg-green-100 border border-green-200 rounded-lg px-2 py-1"},ss=["onClick"],as={key:0,class:"px-3 sm:px-5 pb-4 pt-0 border-t border-amber-100/80 bg-white/50 space-y-3"},ls={key:0,class:"mt-3 flex items-start gap-2 bg-amber-50 border border-amber-200 rounded-xl px-3 py-2.5"},ns={class:"flex items-center justify-between px-3 sm:px-4 py-2 bg-white border-b border-gray-100"},os={class:"text-[11px] sm:text-xs font-bold text-gray-800 truncate mr-2"},rs={key:0,class:"text-[8px] sm:text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded font-bold flex-shrink-0"},is={class:"p-2 sm:p-3 flex gap-1.5 flex-wrap"},ds={class:"text-[8px] sm:text-[9px] uppercase tracking-wide"},cs={key:0,class:"text-xs sm:text-sm font-black leading-tight mt-0.5"},us={key:1,class:"text-[9px] opacity-30 mt-0.5"},xs=["onClick"],ps={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},ms={class:"min-w-0 flex-1"},gs={class:"flex items-center gap-1.5 flex-wrap"},bs={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-blue-200"},fs={key:1,class:"inline-flex items-center gap-1 bg-gray-100 text-gray-500 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-gray-200"},ys={class:"text-[10px] sm:text-xs text-gray-400 mt-0.5 flex items-center gap-1 flex-wrap"},vs={key:0,class:"truncate max-w-[120px] sm:max-w-none"},hs={key:0,class:"text-[9px] sm:text-[10px] text-blue-400 font-mono mt-0.5 truncate"},_s={class:"font-black text-gray-800 font-mono text-xs sm:text-sm whitespace-nowrap"},ws={key:3,class:"text-[9px] sm:text-[10px] text-blue-500 font-semibold bg-blue-50 border border-blue-100 px-1.5 py-1 rounded-lg whitespace-nowrap"},ks=$e({__name:"SalesOrder",props:{combinedRows:{},loading:{type:Boolean},activeFilter:{},expandedSubId:{},processingSubId:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["toggle-sub-expand","sub-action","open-order-detail","order-action","show-all"],setup(m,{emit:U}){const w=U,O=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],A={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},F={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(_,i)=>(t(),a("div",Rt,[i[21]||(i[21]=mt('<div class="flex flex-wrap gap-1.5 px-3 sm:px-5 pt-3 pb-2 overflow-x-auto [scrollbar-width:none] [&amp;::-webkit-scrollbar]:hidden"><div class="flex items-center gap-1.5 bg-amber-50 border border-amber-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-amber-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-amber-700 whitespace-nowrap">Subscription â€” Accept to start daily delivery</span></div><div class="flex items-center gap-1.5 bg-blue-50 border border-blue-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-blue-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-blue-700 whitespace-nowrap">Daily Auto-Order â€” DN auto-created</span></div><div class="flex items-center gap-1.5 bg-gray-50 border border-gray-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-gray-300 flex-shrink-0"></div><span class="text-[10px] font-semibold text-gray-500 whitespace-nowrap">Normal Order</span></div></div>',1)),e("div",Mt,[m.loading?(t(),a("div",Vt,[u(o(Ee),{class:"w-7 h-7 sm:w-8 sm:h-8 mb-4 text-blue-600"}),i[2]||(i[2]=e("p",{class:"text-gray-400 font-medium text-sm animate-pulse"},"Loading...",-1))])):m.combinedRows.length===0?(t(),a("div",zt,[u(o(We),{class:"w-10 h-10 sm:w-12 sm:h-12 text-gray-200 mb-4"}),i[3]||(i[3]=e("p",{class:"text-gray-400 font-medium text-sm"},"Nothing to show",-1)),m.activeFilter!=="all"?(t(),a("button",{key:0,onClick:i[0]||(i[0]=c=>w("show-all")),class:"mt-3 text-sm text-blue-600 hover:underline"}," Show all ")):f("",!0)])):(t(),a("div",qt,[(t(!0),a(L,null,q(m.combinedRows,c=>(t(),a(L,{key:c.row_type+"-"+c.name},[c.row_type==="subscription"?(t(),a("div",{key:0,class:$(["border-l-4 transition-all",c.status==="Accept Pending"?"border-l-amber-400 bg-amber-50/50":"border-l-green-400 bg-green-50/20"])},[e("div",Bt,[e("div",Et,[e("div",{class:$(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 mt-0.5 sm:mt-0",c.status==="Accept Pending"?"bg-amber-100 text-amber-600":"bg-green-100 text-green-600"])},[u(o(Se),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2),e("div",Ht,[e("div",Wt,[e("span",Yt,l(c.name),1),e("span",Qt,[u(o(tt),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),i[4]||(i[4]=j(" Subscription Request ",-1))]),e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border",c.status==="Accept Pending"?"bg-amber-50 text-amber-600 border-amber-200":c.status==="Active"?"bg-green-50 text-green-600 border-green-200":"bg-gray-50 text-gray-500 border-gray-200"])},l(c.status),3)]),e("p",Gt,[i[5]||(i[5]=e("span",null,"Customer:",-1)),e("span",Jt,l(c.customer_name),1),i[6]||(i[6]=e("span",{class:"hidden sm:inline"},"Â·",-1)),e("span",Kt,l(c.formatted_start)+" â†’ "+l(c.formatted_end),1)]),e("p",Xt,[i[7]||(i[7]=j(" Primary: ",-1)),e("span",Zt,l(c.primary_item_name),1)])])]),e("div",es,[c.status==="Accept Pending"?(t(),a(L,{key:0},[u(o(oe),{variant:"solid",class:"!bg-green-600 hover:!bg-green-700 !text-white text-xs",size:"sm",loading:m.processingSubId===c.name,onClick:G(h=>w("sub-action",c.name,"accept"),["stop"])},{prefix:R(()=>[u(o(Ie),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:R(()=>[i[8]||(i[8]=e("span",{class:"hidden sm:inline"},"Accept Plan",-1)),i[9]||(i[9]=e("span",{class:"sm:hidden"},"Accept",-1))]),_:1},8,["loading","onClick"]),u(o(oe),{variant:"subtle",theme:"red",size:"sm",loading:m.processingSubId===c.name,class:"text-xs",onClick:G(h=>w("sub-action",c.name,"reject"),["stop"])},{default:R(()=>[...i[10]||(i[10]=[j("Reject",-1)])]),_:1},8,["loading","onClick"])],64)):c.status==="Active"?(t(),a(L,{key:1},[e("div",ts,[u(o(Be),{class:"w-3 h-3 text-green-600 flex-shrink-0"}),i[11]||(i[11]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-green-700"},"Auto-running",-1))]),u(o(oe),{variant:"subtle",theme:"red",size:"sm",loading:m.processingSubId===c.name,class:"text-xs",onClick:G(h=>w("sub-action",c.name,"reject"),["stop"])},{default:R(()=>[...i[12]||(i[12]=[e("span",{class:"hidden sm:inline"},"Cancel Plan",-1),e("span",{class:"sm:hidden"},"Cancel",-1)])]),_:1},8,["loading","onClick"])],64)):f("",!0),e("button",{onClick:h=>w("toggle-sub-expand",c.name),class:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all flex-shrink-0"},[m.expandedSubId===c.name?(t(),P(o(lt),{key:0,class:"w-4 h-4"})):(t(),P(o(Ue),{key:1,class:"w-4 h-4"}))],8,ss)])]),m.expandedSubId===c.name?(t(),a("div",as,[c.status==="Accept Pending"?(t(),a("div",ls,[u(o(tt),{class:"w-3.5 h-3.5 text-amber-500 mt-0.5 flex-shrink-0"}),i[13]||(i[13]=e("p",{class:"text-[10px] sm:text-xs text-amber-800"},[e("span",{class:"font-bold"},"Accept this plan"),j(" to activate daily delivery. From "),e("strong",null,"next day"),j(", system auto-generates Sales Orders + Delivery Notes. You only handle "),e("strong",null,"invoicing"),j(". ")],-1))])):f("",!0),(t(!0),a(L,null,q(c.schedule_items,h=>(t(),a("div",{key:h.item_code,class:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden"},[e("div",ns,[e("span",os,l(h.item_name),1),h.is_primary_item?(t(),a("span",rs,"Primary")):f("",!0)]),e("div",is,[(t(),a(L,null,q(O,v=>e("div",{key:v,class:$(["flex flex-col items-center px-2 sm:px-3 py-1.5 rounded-xl font-bold min-w-[34px] sm:min-w-[44px] text-center",(h[F[v]]||0)>0?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-400"])},[e("span",ds,l(A[v]),1),(h[F[v]]||0)>0?(t(),a("span",cs,l(h[F[v]]),1)):(t(),a("span",us,"â€”"))],2)),64))])]))),128))])):f("",!0)],2)):(t(),a("div",{key:1,class:$(["flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2 cursor-pointer group transition-all border-l-4",c.custom_subscription_refereance?"border-l-blue-300 bg-blue-50/20 hover:bg-blue-50/50 active:bg-blue-50/70":"border-l-transparent hover:bg-gray-50/70 active:bg-gray-100/50"]),onClick:h=>w("open-order-detail",c)},[e("div",ps,[e("div",{class:$(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 transition-colors mt-0.5 sm:mt-0",c.custom_subscription_refereance?"bg-blue-100 text-blue-600 group-hover:bg-blue-500 group-hover:text-white":"bg-gray-100 text-gray-500 group-hover:bg-blue-100 group-hover:text-blue-600"])},[c.custom_subscription_refereance?(t(),P(o(Se),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),P(o(Ve),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",ms,[e("div",gs,[e("span",{class:$(["font-bold font-mono text-xs sm:text-sm transition-colors",c.custom_subscription_refereance?"text-blue-700":"text-gray-900 group-hover:text-blue-600"])},l(c.name),3),c.custom_subscription_refereance?(t(),a("span",bs,[u(o(Be),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),i[14]||(i[14]=e("span",{class:"hidden xs:inline"},"Daily Sub-Auto-Order",-1)),i[15]||(i[15]=e("span",{class:"xs:hidden"},"Sub",-1))])):(t(),a("span",fs,[u(o(Ve),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),i[16]||(i[16]=e("span",{class:"hidden xs:inline"},"Normal Order",-1)),i[17]||(i[17]=e("span",{class:"xs:hidden"},"Normal",-1))])),u(o(nt),{theme:m.getStatusTheme(c.status),variant:"subtle",label:c.status,size:"sm"},null,8,["theme","label"])]),e("p",ys,[u(o(ke),{class:"w-3 h-3 flex-shrink-0"}),e("span",null,l(c.transaction_date),1),c.customer_name?(t(),a("span",vs,"Â· "+l(c.customer_name),1)):f("",!0)]),c.custom_subscription_refereance?(t(),a("p",hs," ðŸ“‹ "+l(c.custom_subscription_refereance),1)):f("",!0)])]),e("div",{class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap",onClick:i[1]||(i[1]=G(()=>{},["stop"]))},[e("span",_s,l(m.formatCurrency(c.grand_total,c.currency)),1),c.docstatus===0?(t(),P(o(oe),{key:0,variant:"solid",theme:"blue",size:"sm",loading:m.processingId===c.name,onClick:h=>w("order-action",c.name,"accept"),class:"text-xs"},{default:R(()=>[...i[18]||(i[18]=[j("Accept",-1)])]),_:1},8,["loading","onClick"])):f("",!0),c.docstatus===1&&c.per_delivered<100&&!c.custom_subscription_refereance?(t(),P(o(oe),{key:1,variant:"subtle",theme:"gray",size:"sm",loading:m.processingId===c.name,onClick:h=>w("order-action",c.name,"deliver"),class:"text-xs"},{prefix:R(()=>[u(o(Oe),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:R(()=>[i[19]||(i[19]=e("span",{class:"hidden sm:inline"},"Deliver",-1))]),_:1},8,["loading","onClick"])):f("",!0),c.per_delivered>=100&&c.per_billed<100?(t(),P(o(oe),{key:2,variant:"subtle",theme:"gray",size:"sm",loading:m.processingId===c.name,onClick:h=>w("order-action",c.name,"invoice"),class:"text-xs"},{prefix:R(()=>[u(o(ot),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:R(()=>[i[20]||(i[20]=e("span",{class:"hidden sm:inline"},"Invoice",-1))]),_:1},8,["loading","onClick"])):f("",!0),c.custom_subscription_refereance&&c.docstatus===1&&c.per_delivered<100?(t(),a("span",ws," âš¡ Auto-Delivered ")):f("",!0),u(o(Re),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-300 ml-1 flex-shrink-0"})])],10,xs))],64))),128))]))])]))}}),$s={class:"flex items-center justify-between w-full pr-6 sm:pr-8 gap-2 flex-wrap"},Cs={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Ss={class:"min-w-0"},Ds={class:"text-xs sm:text-sm text-gray-500 font-mono mt-1 truncate"},Fs={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},js={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[10px] sm:text-xs font-bold px-2 sm:px-3 py-1 rounded-full truncate max-w-[140px] sm:max-w-none"},Ps={class:"truncate"},Ts={key:0,class:"flex flex-col items-center justify-center h-48 sm:h-80"},Os={key:1,class:"py-4 sm:py-6 space-y-5 sm:space-y-8"},As={key:0,class:"flex items-start gap-2 sm:gap-3 bg-blue-50 border border-blue-200 rounded-xl sm:rounded-2xl p-3 sm:p-4"},Is={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-5"},Ls={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},Ns={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},Us={class:"min-w-0"},Rs={class:"font-bold text-sm sm:text-base truncate"},Ms={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},Vs={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},zs={class:"font-bold text-sm sm:text-base"},qs={class:"bg-blue-600 p-3 sm:p-5 rounded-xl sm:rounded-2xl text-white"},Bs={class:"font-black text-xl sm:text-2xl"},Es={class:"border border-gray-200 rounded-xl overflow-hidden"},Hs={class:"overflow-x-auto"},Ws={class:"w-full text-xs sm:text-sm min-w-[400px]"},Ys={class:"divide-y divide-gray-100"},Qs={class:"px-3 sm:px-5 py-3 sm:py-4 font-bold text-gray-900"},Gs={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Js={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Ks={class:"px-3 sm:px-5 py-3 sm:py-4 text-right font-bold tabular-nums"},Xs={class:"flex flex-col xs:flex-row justify-end gap-2 sm:gap-3 pt-4 sm:pt-6 border-t border-gray-100"},Zs=$e({__name:"SellerOrderDetailDialog",props:{modelValue:{type:Boolean},orderDetails:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["update:modelValue","order-action"],setup(m,{emit:U}){const w=m,O=U,A=N({get:()=>w.modelValue,set:F=>O("update:modelValue",F)});return(F,_)=>(t(),P(o(rt),{modelValue:A.value,"onUpdate:modelValue":_[3]||(_[3]=i=>A.value=i),options:{size:"4xl"}},{"body-title":R(()=>{var i,c,h,v;return[e("div",$s,[e("div",Cs,[e("div",{class:$(["h-8 w-8 sm:h-10 sm:w-10 rounded-full flex items-center justify-center flex-shrink-0",(i=m.orderDetails)!=null&&i.custom_subscription_refereance?"bg-blue-50 text-blue-600":"bg-gray-50 text-gray-600"])},[(c=m.orderDetails)!=null&&c.custom_subscription_refereance?(t(),P(o(Se),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),P(o(We),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",Ss,[_[4]||(_[4]=e("h3",{class:"text-base sm:text-xl font-black leading-none"},"Order Details",-1)),e("p",Ds,l((h=m.orderDetails)==null?void 0:h.name),1)])]),e("div",Fs,[(v=m.orderDetails)!=null&&v.custom_subscription_refereance?(t(),a("span",js,[u(o(Se),{class:"w-3 h-3 flex-shrink-0"}),e("span",Ps,l(m.orderDetails.custom_subscription_refereance),1)])):f("",!0),m.orderDetails?(t(),P(o(nt),{key:1,theme:m.getStatusTheme(m.orderDetails.status),size:"lg",label:m.orderDetails.status},null,8,["theme","label"])):f("",!0)])])]}),"body-content":R(()=>[m.orderDetails?(t(),a("div",Os,[m.orderDetails.custom_subscription_refereance&&m.orderDetails.docstatus===1?(t(),a("div",As,[u(o(Be),{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 mt-0.5 flex-shrink-0"}),_[5]||(_[5]=e("p",{class:"text-[10px] sm:text-xs text-blue-700"},[e("span",{class:"font-bold"},"Daily Subscription Order."),j(" Auto-generated by cron. Delivery note created automatically. Only invoice needed manually. ")],-1))])):f("",!0),e("div",Is,[e("div",Ls,[e("div",Ns,[u(o(qe),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",Us,[_[6]||(_[6]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Customer",-1)),e("p",Rs,l(m.orderDetails.customer_name),1)])]),e("div",Ms,[e("div",Vs,[u(o(ke),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",null,[_[7]||(_[7]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Date",-1)),e("p",zs,l(m.orderDetails.transaction_date),1)])]),e("div",qs,[_[8]||(_[8]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Grand Total",-1)),e("p",Bs,l(m.formatCurrency(m.orderDetails.grand_total,m.orderDetails.currency)),1)])]),e("div",Es,[e("div",Hs,[e("table",Ws,[_[9]||(_[9]=e("thead",{class:"bg-gray-50 text-[9px] sm:text-[10px] uppercase font-bold text-gray-500"},[e("tr",null,[e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-left"},"Item"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Qty"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Rate"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Amount")])],-1)),e("tbody",Ys,[(t(!0),a(L,null,q(m.orderDetails.items,i=>(t(),a("tr",{key:i.name},[e("td",Qs,l(i.item_name),1),e("td",Gs,l(i.qty),1),e("td",Js,l(m.formatCurrency(i.rate,m.orderDetails.currency)),1),e("td",Ks,l(m.formatCurrency(i.amount,m.orderDetails.currency)),1)]))),128))])])])]),e("div",Xs,[m.orderDetails.docstatus===0?(t(),P(o(oe),{key:0,variant:"solid",theme:"blue",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:_[0]||(_[0]=i=>O("order-action",m.orderDetails.name,"accept"))},{default:R(()=>[..._[10]||(_[10]=[j("Accept Order",-1)])]),_:1},8,["loading"])):f("",!0),m.orderDetails.docstatus===1&&m.orderDetails.per_delivered<100&&!m.orderDetails.custom_subscription_refereance?(t(),P(o(oe),{key:1,variant:"solid",theme:"gray",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:_[1]||(_[1]=i=>O("order-action",m.orderDetails.name,"deliver"))},{prefix:R(()=>[u(o(Oe),{class:"w-4 h-4"})]),default:R(()=>[_[11]||(_[11]=j(" Generate Delivery Note ",-1))]),_:1},8,["loading"])):f("",!0),m.orderDetails.per_delivered>=100&&m.orderDetails.per_billed<100?(t(),P(o(oe),{key:2,variant:"solid",theme:"gray",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:_[2]||(_[2]=i=>O("order-action",m.orderDetails.name,"invoice"))},{prefix:R(()=>[u(o(ot),{class:"w-4 h-4"})]),default:R(()=>[_[12]||(_[12]=j(" Generate Invoice ",-1))]),_:1},8,["loading"])):f("",!0)])])):(t(),a("div",Ts,[u(o(Ee),{class:"w-8 h-8 sm:w-10 sm:h-10 text-blue-500"})]))]),_:1},8,["modelValue"]))}}),ea={class:"space-y-4 sm:space-y-5"},ta={class:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4"},sa={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-gray-100 shadow-sm"},aa={class:"text-2xl sm:text-3xl font-black text-gray-900"},la={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-green-100 shadow-sm"},na={class:"text-2xl sm:text-3xl font-black text-gray-900"},oa={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-blue-100 shadow-sm"},ra={class:"text-2xl sm:text-3xl font-black text-gray-900"},ia={class:"bg-blue-600 p-3 sm:p-4 rounded-xl sm:rounded-2xl shadow-sm"},da={class:"text-xl sm:text-2xl font-black text-white"},ca={class:"flex flex-col sm:flex-row gap-2 sm:gap-3"},ua={class:"relative flex-1"},xa={class:"flex gap-2 sm:gap-3"},pa=["value"],ma={key:0,class:"flex justify-center py-16 sm:py-20"},ga={key:1,class:"bg-gray-50 rounded-2xl sm:rounded-3xl border-2 border-dashed border-gray-200 py-16 sm:py-24 text-center px-4"},ba={class:"text-xs sm:text-sm text-gray-400 mt-1"},fa={key:2,class:"space-y-2 sm:space-y-3"},ya=["onClick"],va={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},ha={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-lg sm:rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 text-white flex items-center justify-center font-black text-base sm:text-lg flex-shrink-0 shadow-sm"},_a={class:"min-w-0 flex-1"},wa={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},ka={class:"font-bold text-gray-900 text-xs sm:text-sm"},$a={class:"font-mono text-[9px] sm:text-[10px] text-gray-400 hidden xs:inline"},Ca={key:0,class:"inline-flex items-center gap-1 bg-green-100 text-green-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-green-200"},Sa={key:1,class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-amber-200"},Da={class:"flex items-center gap-2 sm:gap-3 mt-0.5 flex-wrap"},Fa={key:0,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},ja={class:"truncate max-w-[110px] sm:max-w-none"},Pa={key:1,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Ta={key:2,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},Oa={class:"flex items-center gap-3 sm:gap-4 flex-shrink-0"},Aa={class:"text-right hidden md:block"},Ia={class:"font-black text-gray-900"},La={class:"text-right hidden md:block"},Na={class:"font-black text-gray-900 text-sm"},Ua={key:0,class:"border-t border-gray-100 px-3 sm:px-4 pb-4 sm:pb-5 pt-3 sm:pt-4 space-y-3 sm:space-y-4 bg-gray-50/30"},Ra={class:"flex gap-3 md:hidden"},Ma={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},Va={class:"font-black text-gray-900 text-sm sm:text-base"},za={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},qa={class:"font-black text-gray-900 text-xs sm:text-sm"},Ba={key:0},Ea={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},Ha={class:"space-y-2"},Wa={class:"flex flex-col xs:flex-row xs:items-center justify-between gap-1 mb-2"},Ya={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},Qa={class:"font-mono text-[10px] sm:text-xs font-bold text-gray-700"},Ga={class:"text-[9px] sm:text-[10px] text-gray-400 whitespace-nowrap"},Ja={class:"text-[9px] sm:text-[10px] text-gray-500 font-semibold mb-1"},Ka={class:"flex gap-1 flex-wrap"},Xa={key:0,class:"opacity-80 text-[7px] sm:text-[8px]"},Za={key:1,class:"text-center py-3 sm:py-4 text-[10px] sm:text-xs text-gray-400 bg-white rounded-lg sm:rounded-xl border border-dashed border-gray-200"},el={key:2},tl={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},sl={class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 overflow-hidden"},al={class:"overflow-x-auto"},ll={class:"w-full text-xs min-w-[360px]"},nl={class:"divide-y divide-gray-50"},ol={class:"px-2.5 sm:px-3 py-2 font-mono font-bold text-gray-700 text-[10px] sm:text-xs"},rl={key:0,class:"ml-1 text-[8px] bg-blue-100 text-blue-600 px-1 py-0.5 rounded font-bold"},il={class:"px-2.5 sm:px-3 py-2 text-gray-500 text-[10px] sm:text-xs"},dl={class:"px-2.5 sm:px-3 py-2"},cl={class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-800 text-[10px] sm:text-xs tabular-nums"},ul=$e({__name:"SellerCustomersTab",props:{seller:{}},setup(m){const U=m,w=I(""),O=I(null),A=I(""),F=se({url:"my_frappe_app.api.get_seller_customers",onSuccess(){}});gt(()=>{U.seller&&F.fetch({seller:U.seller})});const _=N(()=>{var V;return((V=F.data)==null?void 0:V.customers)||[]}),i=N(()=>{var V;return((V=F.data)==null?void 0:V.pincodes)||[]}),c=N(()=>{let V=_.value;if(A.value&&(V=V.filter(C=>C.pincode===A.value)),w.value.trim()){const C=w.value.toLowerCase();V=V.filter(S=>{var B,ee,Y,W;return((B=S.customer_name)==null?void 0:B.toLowerCase().includes(C))||((ee=S.name)==null?void 0:ee.toLowerCase().includes(C))||((Y=S.email)==null?void 0:Y.toLowerCase().includes(C))||((W=S.mobile)==null?void 0:W.toLowerCase().includes(C))})}return V}),h=N(()=>{const V=_.value;return{total:V.length,withActiveSub:V.filter(C=>C.active_subs>0).length,totalOrders:V.reduce((C,S)=>C+(S.total_orders||0),0),totalRevenue:V.reduce((C,S)=>C+(S.total_revenue||0),0)}}),v=V=>{O.value=O.value===V?null:V},T=V=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(V),E={Active:"bg-green-100 text-green-700 border-green-200","Accept Pending":"bg-amber-100 text-amber-700 border-amber-200",Expired:"bg-gray-100 text-gray-500 border-gray-200",Cancelled:"bg-red-100 text-red-600 border-red-200"},Z=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],M={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},H={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(V,C)=>(t(),a("div",ea,[e("div",ta,[e("div",sa,[C[3]||(C[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Total Customers",-1)),e("p",aa,l(h.value.total),1)]),e("div",la,[C[4]||(C[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1"},"With Active Plan",-1)),e("p",na,l(h.value.withActiveSub),1)]),e("div",oa,[C[5]||(C[5]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-500 uppercase tracking-widest mb-1"},"Total Orders",-1)),e("p",ra,l(h.value.totalOrders),1)]),e("div",ia,[C[6]||(C[6]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Total Revenue",-1)),e("p",da,l(T(h.value.totalRevenue)),1)])]),e("div",ca,[e("div",ua,[u(o(Ye),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),ie(e("input",{"onUpdate:modelValue":C[0]||(C[0]=S=>w.value=S),type:"text",placeholder:"Search by name, email, mobile...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[xe,w.value]])]),e("div",xa,[ie(e("select",{"onUpdate:modelValue":C[1]||(C[1]=S=>A.value=S),class:"flex-1 sm:flex-none border border-gray-200 rounded-xl px-3 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"},[C[7]||(C[7]=e("option",{value:""},"All Pincodes",-1)),(t(!0),a(L,null,q(i.value,S=>(t(),a("option",{key:S,value:S},l(S),9,pa))),128))],512),[[st,A.value]]),u(o(oe),{variant:"outline",loading:o(F).loading,class:"text-xs sm:text-sm flex-shrink-0",onClick:C[2]||(C[2]=S=>o(F).fetch({seller:U.seller}))},{prefix:R(()=>[u(o(K),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:R(()=>[C[8]||(C[8]=e("span",{class:"hidden sm:inline"},"Refresh",-1))]),_:1},8,["loading"])])]),o(F).loading?(t(),a("div",ma,[u(o(Ee),{class:"w-7 h-7 sm:w-8 sm:h-8 text-blue-600"})])):c.value.length===0?(t(),a("div",ga,[u(o(at),{class:"w-9 h-9 sm:w-10 sm:h-10 text-gray-300 mx-auto mb-3"}),C[9]||(C[9]=e("h3",{class:"text-sm sm:text-base font-bold text-gray-700"},"No Customers Found",-1)),e("p",ba,l(w.value||A.value?"Try different filters":"No customers in your area yet"),1)])):(t(),a("div",fa,[(t(!0),a(L,null,q(c.value,S=>{var B,ee,Y,W;return t(),a("div",{key:S.name,class:"bg-white rounded-xl sm:rounded-2xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow"},[e("div",{class:"flex items-center justify-between p-3 sm:p-4 gap-2 sm:gap-3 cursor-pointer",onClick:z=>v(S.name)},[e("div",va,[e("div",ha,l(((ee=(B=S.customer_name)==null?void 0:B[0])==null?void 0:ee.toUpperCase())||"?"),1),e("div",_a,[e("div",wa,[e("span",ka,l(S.customer_name),1),e("span",$a,l(S.name),1),S.active_subs>0?(t(),a("span",Ca,[u(o(Ie),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),j(" "+l(S.active_subs)+" Active ",1)])):S.pending_subs>0?(t(),a("span",Sa,[u(o(Me),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),j(" "+l(S.pending_subs)+" Pending ",1)])):f("",!0)]),e("div",Da,[S.email?(t(),a("span",Fa,[u(o(kt),{class:"w-3 h-3 flex-shrink-0"}),e("span",ja,l(S.email),1)])):f("",!0),S.mobile?(t(),a("span",Pa,[u(o($t),{class:"w-3 h-3 flex-shrink-0"}),j(" "+l(S.mobile),1)])):f("",!0),S.pincode?(t(),a("span",Ta,[u(o(bt),{class:"w-3 h-3 flex-shrink-0"}),j(" "+l(S.pincode),1)])):f("",!0)])])]),e("div",Oa,[e("div",Aa,[C[10]||(C[10]=e("p",{class:"text-xs text-gray-400 font-medium"},"Orders",-1)),e("p",Ia,l(S.total_orders||0),1)]),e("div",La,[C[11]||(C[11]=e("p",{class:"text-xs text-gray-400 font-medium"},"Revenue",-1)),e("p",Na,l(T(S.total_revenue||0)),1)]),O.value===S.name?(t(),P(o(lt),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"})):(t(),P(o(Ue),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"}))])],8,ya),O.value===S.name?(t(),a("div",Ua,[e("div",Ra,[e("div",Ma,[C[12]||(C[12]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Orders",-1)),e("p",Va,l(S.total_orders||0),1)]),e("div",za,[C[13]||(C[13]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Revenue",-1)),e("p",qa,l(T(S.total_revenue||0)),1)])]),((Y=S.subscriptions)==null?void 0:Y.length)>0?(t(),a("div",Ba,[e("h4",Ea,[u(o(Se),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),C[14]||(C[14]=j(" Subscription Plans ",-1))]),e("div",Ha,[(t(!0),a(L,null,q(S.subscriptions,z=>(t(),a("div",{key:z.name,class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 p-2.5 sm:p-3"},[e("div",Wa,[e("div",Ya,[e("span",Qa,l(z.name),1),e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border",E[z.status]||"bg-gray-100 text-gray-500 border-gray-200"])},l(z.status),3)]),e("span",Ga,l(z.formatted_start)+" â†’ "+l(z.formatted_end),1)]),(t(!0),a(L,null,q(z.schedule_items,J=>(t(),a("div",{key:J.item_code,class:"mt-2"},[e("p",Ja,l(J.item_name),1),e("div",Ka,[(t(),a(L,null,q(Z,Q=>e("div",{key:Q,class:$(["flex flex-col items-center px-1.5 sm:px-2 py-1 rounded-lg text-[8px] sm:text-[9px] font-bold min-w-[28px] sm:min-w-[32px] text-center",(J[H[Q]]||0)>0?"bg-blue-600 text-white":"bg-gray-100 text-gray-400"])},[e("span",null,l(M[Q]),1),(J[H[Q]]||0)>0?(t(),a("span",Xa," Ã—"+l(J[H[Q]]),1)):f("",!0)],2)),64))])]))),128))]))),128))])])):(t(),a("div",Za,[u(o(Se),{class:"w-5 h-5 sm:w-6 sm:h-6 text-gray-200 mx-auto mb-1"}),C[15]||(C[15]=j(" No subscription plans yet ",-1))])),((W=S.recent_orders)==null?void 0:W.length)>0?(t(),a("div",el,[e("h4",tl,[u(o(Ve),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),C[16]||(C[16]=j(" Recent Orders (last 5) ",-1))]),e("div",sl,[e("div",al,[e("table",ll,[C[17]||(C[17]=e("thead",{class:"bg-gray-50 border-b border-gray-100"},[e("tr",null,[e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Order"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Date"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Status"),e("th",{class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Amount")])],-1)),e("tbody",nl,[(t(!0),a(L,null,q(S.recent_orders,z=>(t(),a("tr",{key:z.name},[e("td",ol,[j(l(z.name)+" ",1),z.custom_subscription_refereance?(t(),a("span",rl,"SUB")):f("",!0)]),e("td",il,l(z.transaction_date),1),e("td",dl,[e("span",{class:$(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full",z.docstatus===2?"bg-red-100 text-red-600":z.status==="Completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"])},l(z.status),3)]),e("td",cl,l(T(z.grand_total)),1)]))),128))])])])])])):f("",!0)])):f("",!0)])}),128))]))]))}}),xl={class:"flex items-center gap-2 sm:gap-3"},pl={class:"p-2 sm:p-2.5 bg-emerald-600 rounded-lg sm:rounded-xl text-white shadow-md flex-shrink-0"},ml={class:"space-y-3"},gl={key:0,class:"flex items-start gap-3 bg-red-50 border border-red-200 rounded-xl px-4 py-3 shadow-sm"},bl={class:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0 mt-0.5"},fl={class:"flex-1 min-w-0"},yl={class:"text-xs text-red-600 mt-0.5 leading-relaxed"},vl={key:1,class:"flex items-start gap-3 bg-amber-50 border border-amber-200 rounded-xl px-4 py-3 shadow-sm"},hl={class:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0 mt-0.5"},_l={class:"flex-1 min-w-0"},wl={class:"text-[10px] text-amber-600 mt-0.5 font-mono break-all"},kl={class:"filter-card"},$l={class:"filter-header"},Cl={class:"filter-title-group"},Sl={class:"filter-icon-wrap"},Dl={key:0,class:"filter-active-badge"},Fl=["disabled"],jl={class:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 mt-3"},Pl={class:"filter-field"},Tl=["max"],Ol={class:"filter-field"},Al=["min","max"],Il={class:"filter-field"},Ll={value:""},Nl=["value"],Ul={class:"filter-pills-row"},Rl={class:"pill pill-date"},Ml={class:"pill-text"},Vl={class:"pill-text"},zl={key:0,class:"pill pill-customer"},ql={class:"pill-text truncate max-w-[110px]"},Bl={class:"pill pill-count ml-auto"},El={class:"pill-count-num"},Hl={class:"summary-table-wrapper border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},Wl={class:"flex items-center gap-3 px-4 py-3.5 bg-gradient-to-r from-emerald-700 to-emerald-600 flex-shrink-0"},Yl={key:1,class:"flex items-center gap-1.5 bg-white/20 border border-white/20 rounded-full px-3 py-1 flex-shrink-0"},Ql={class:"text-[11px] font-black text-white"},Gl={key:0,class:"flex flex-col items-center justify-center gap-2 py-10 bg-white"},Jl={class:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center"},Kl={key:1,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},Xl={key:2,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},Zl={class:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center"},en={key:3,class:"summary-scroll-area"},tn={class:"summary-table"},sn=["title"],an=["title"],ln={key:0,class:"cell-value"},nn={key:1,class:"cell-empty"},on={class:"col-total td-total-cell"},rn={class:"total-amt"},dn={class:"total-qty"},cn={class:"footer-row"},un={class:"col-total td-foot-amount"},xn={class:"border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},pn={class:"flex items-center gap-2.5 px-4 py-3 bg-gradient-to-r from-gray-700 to-gray-600"},mn={key:0,class:"w-2.5 h-2.5 text-white",viewBox:"0 0 12 12",fill:"none"},gn={key:1,class:"w-2 h-0.5 bg-white rounded-full"},bn={class:"text-[10px] font-bold text-white whitespace-nowrap"},fn={key:0,class:"flex flex-col items-center justify-center py-10 text-center bg-white px-4"},yn={class:"w-12 h-12 rounded-2xl bg-gray-100 flex items-center justify-center mb-3"},vn={key:1,class:"divide-y divide-gray-50 max-h-52 overflow-y-auto bg-white orders-scroll"},hn=["onClick"],_n={class:"hidden sm:grid items-center gap-2 px-4 py-3",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},wn={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},kn={class:"text-[10px] text-gray-400 font-mono font-bold"},$n={class:"min-w-0"},Cn={class:"flex items-center gap-1.5 flex-wrap"},Sn={class:"font-bold font-mono text-[11px] text-gray-800 truncate"},Dn={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold"},Fn={class:"text-[10px] text-gray-400 mt-0.5 truncate"},jn={class:"min-w-0"},Pn={class:"font-mono text-[10px] text-gray-500 truncate block"},Tn={class:"text-right"},On={class:"text-[10px] font-bold text-emerald-700 bg-emerald-50 px-1.5 py-0.5 rounded-lg border border-emerald-100"},An={class:"text-right"},In={class:"text-[10px] font-bold text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded-lg border border-orange-100"},Ln={class:"font-black text-gray-800 font-mono text-xs text-right tabular-nums block"},Nn={class:"flex sm:hidden items-center gap-3 px-4 py-3"},Un={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},Rn={class:"flex-1 min-w-0"},Mn={class:"flex items-center gap-1"},Vn={class:"font-bold font-mono text-[10px] text-gray-800 truncate"},zn={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},qn={class:"flex items-center gap-2 mt-0.5"},Bn={class:"text-[9px] text-gray-400 truncate flex-1"},En={class:"text-[9px] font-bold text-emerald-700 bg-emerald-50 px-1 py-0.5 rounded flex-shrink-0"},Hn={class:"font-black text-gray-800 font-mono text-[11px] text-right tabular-nums flex-shrink-0"},Wn={class:"flex flex-col xs:flex-row items-start xs:items-center w-full gap-3"},Yn={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Qn={class:"text-[10px] sm:text-xs text-gray-500 font-semibold whitespace-nowrap"},Gn={class:"font-black text-gray-900 text-sm sm:text-base"},Jn={class:"flex items-center gap-2 sm:gap-3 ml-auto flex-shrink-0"},Kn=$e({__name:"SellerCreateInvoiceDialog",props:{modelValue:{type:Boolean},eligibleOrders:{},seller:{},formatCurrency:{type:Function}},emits:["update:modelValue","invoice-created"],setup(m,{emit:U}){const w=m,O=U,A=N({get:()=>w.modelValue,set:k=>O("update:modelValue",k)}),F=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],_={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},i=new Date().toISOString().split("T")[0],c=I(""),h=I(i),v=I(new Set),T=I(""),E=I(""),Z=I({}),M=I(!1),H=I(""),V=se({url:"my_frappe_app.api.get_sales_order_items",onError(k){console.error("[InvoiceDialog] soItemsResource error:",k)}}),C=N(()=>{const k=new Map;return w.eligibleOrders.forEach(d=>{const p=d.customer||d.customer_name,s=d.customer_name||d.customer;p&&s&&k.set(p,s)}),Array.from(k.entries()).map(([d,p])=>({value:d,label:p}))}),S=N(()=>w.eligibleOrders.filter(k=>{const d=k.transaction_date;return!(c.value&&d<c.value||h.value&&d>h.value||E.value&&!(k.customer===E.value||k.customer_name===E.value))}));let B=!0;je(S,k=>{B&&(v.value=new Set(k.map(d=>d.name)),B=!1)},{immediate:!0});const ee=()=>{c.value="",h.value=i,E.value="",v.value=new Set,T.value=""},Y=N(()=>!!c.value||!!E.value||h.value!==i),W=N(()=>S.value.length>0&&S.value.every(k=>v.value.has(k.name))),z=N(()=>S.value.some(k=>v.value.has(k.name))&&!W.value),J=()=>{const k=new Set(v.value);W.value?S.value.forEach(d=>k.delete(d.name)):S.value.forEach(d=>k.add(d.name)),v.value=k},Q=k=>{const d=new Set(v.value);d.has(k)?d.delete(k):d.add(k),v.value=d,T.value=""},de=N(()=>w.eligibleOrders.filter(k=>v.value.has(k.name))),ge=N(()=>de.value.reduce((k,d)=>k+(d.grand_total||0),0));function pe(k){return be(this,null,function*(){const d=k.filter(p=>!Z.value[p]);if(d.length){M.value=!0,H.value="";try{const p=yield V.submit({order_names:JSON.stringify(d)});if(!Array.isArray(p))throw new Error(`Unexpected response format. Got: ${JSON.stringify(p)}`);const s={};for(const y of p)s[y.parent]||(s[y.parent]=[]),s[y.parent].push(y);for(const y of d)Z.value[y]=s[y]||[]}catch(p){const s=(p==null?void 0:p.message)||(p==null?void 0:p.exception)||(p==null?void 0:p.exc_type)||String(p);H.value=s;for(const y of d)Z.value[y]||(Z.value[y]=[])}finally{M.value=!1}}})}je(v,k=>be(this,null,function*(){k.size>0&&(yield pe([...k]))}),{deep:!0});const ae=N(()=>{const k=new Map;for(const d of de.value){const p=d.transaction_date;if(!p)continue;const s=new Date(p+"T00:00:00").toLocaleDateString("en-US",{weekday:"long"}),y=Z.value[d.name]||[];for(const x of y){const r=x.item_code;if(!r)continue;k.has(r)||k.set(r,{item_name:x.item_name||r,days:{},total_qty:0,total_amt:0});const n=k.get(r),g=Number(x.qty)||0,D=Number(x.rate)||0;n.days[s]||(n.days[s]={qty:0,price:0}),n.days[s].qty+=g,D>0&&n.days[s].price===0&&(n.days[s].price=D),n.total_qty+=g,n.total_amt+=g*D}}return Array.from(k.entries()).map(([d,p])=>De({item_code:d},p))});function Ce(k,d){const p=String(k).padStart(3,"0"),s=Number.isInteger(d)?String(d):d.toFixed(2);return`${p}(${s})`}const le=se({url:"my_frappe_app.api.create_invoice_from_sales_orders",onSuccess(k){T.value="",A.value=!1,O("invoice-created",k.invoice_name),ne()},onError(k){const d=((k==null?void 0:k.exception)||(k==null?void 0:k.message)||"").toLowerCase();if(d.includes("already been billed")||d.includes("billed amount"))T.value="This order has already been billed. Please select a different order.";else if(d.includes("not submitted")||d.includes("draft"))T.value="Order has not been submitted yet. Please submit the order first.";else if(d.includes("permission")||d.includes("not permitted"))T.value="You do not have permission to create this invoice.";else if(d.includes("no orders")||d.includes("select at least"))T.value="Please select at least one order.";else if(d.includes("delivery")&&d.includes("not"))T.value="Delivery has not been completed yet. Please confirm delivery first.";else if(d.includes("customer")&&d.includes("match"))T.value="All selected orders must belong to the same customer.";else if(d.includes("internal server error")||d.includes("operationalerror")||d.includes("traceback"))T.value="A server error occurred. Please try again later or contact the admin.";else{const p=((k==null?void 0:k.exception)||(k==null?void 0:k.message)||"").replace(/<[^>]+>/g,"").replace(/^[\w.]+Error:\s*/i,"").replace(/Traceback[\s\S]*/i,"").trim();T.value=p||"An error occurred while creating the invoice. Please try again."}}}),ye=N(()=>le.loading),me=()=>{v.value.size!==0&&(T.value="",le.submit({sales_orders:[...v.value]}))},ne=()=>{c.value="",h.value=i,v.value=new Set,T.value="",E.value="",Z.value={},H.value="",B=!0};return je(A,k=>{k||ne()}),(k,d)=>(t(),P(o(rt),{modelValue:A.value,"onUpdate:modelValue":d[9]||(d[9]=p=>A.value=p),options:{size:"5xl"}},{"body-title":R(()=>[e("div",xl,[e("div",pl,[u(o(we),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),d[10]||(d[10]=e("div",null,[e("h3",{class:"text-base sm:text-xl font-black leading-none text-gray-900"},"Create Invoice"),e("p",{class:"text-[10px] sm:text-sm text-gray-400 font-medium mt-0.5"}," Select delivered orders to generate a combined invoice ")],-1))])]),"body-content":R(()=>{var p;return[e("div",ml,[T.value?(t(),a("div",gl,[e("div",bl,[u(o(Fe),{class:"w-4 h-4 text-red-500"})]),e("div",fl,[d[11]||(d[11]=e("p",{class:"text-sm text-red-800 font-bold"},"Invoice Could Not Be Created",-1)),e("p",yl,l(T.value),1)]),e("button",{onClick:d[0]||(d[0]=s=>T.value=""),class:"text-red-300 hover:text-red-500 transition-colors mt-0.5"},[u(o(he),{class:"w-4 h-4"})])])):f("",!0),H.value?(t(),a("div",vl,[e("div",hl,[u(o(Fe),{class:"w-4 h-4 text-amber-500"})]),e("div",_l,[d[12]||(d[12]=e("p",{class:"text-xs text-amber-800 font-bold"},"Could not load item details",-1)),e("p",wl,l(H.value),1)]),e("button",{onClick:d[1]||(d[1]=s=>H.value=""),class:"text-amber-300 hover:text-amber-500 transition-colors"},[u(o(he),{class:"w-3.5 h-3.5"})])])):f("",!0),e("div",kl,[e("div",$l,[e("div",Cl,[e("div",Sl,[u(o(_t),{class:"w-3.5 h-3.5 text-indigo-600"})]),d[13]||(d[13]=e("span",{class:"filter-title"},"Filters",-1)),Y.value?(t(),a("span",Dl,l((c.value?1:0)+(E.value?1:0)+(h.value!==o(i)?1:0))+" active ",1)):f("",!0)]),e("button",{onClick:ee,disabled:!Y.value,class:$(["clear-btn",Y.value?"clear-btn-active":"clear-btn-disabled"])},[u(o(he),{class:"w-3 h-3"}),d[14]||(d[14]=e("span",null,"Clear Filters",-1))],10,Fl)]),e("div",jl,[e("div",Pl,[d[15]||(d[15]=e("label",{class:"filter-label"},"From Date",-1)),e("div",{class:$(["filter-input-wrap",c.value?"input-active":""])},[u(o(ke),{class:"filter-input-icon"}),ie(e("input",{type:"date","onUpdate:modelValue":d[2]||(d[2]=s=>c.value=s),max:h.value||o(i),class:"filter-input"},null,8,Tl),[[xe,c.value]]),c.value?(t(),a("button",{key:0,onClick:d[3]||(d[3]=G(s=>c.value="",["stop"])),class:"input-clear-btn"},[u(o(he),{class:"w-3 h-3"})])):f("",!0)],2)]),e("div",Ol,[d[16]||(d[16]=e("label",{class:"filter-label"},"To Date",-1)),e("div",{class:$(["filter-input-wrap",h.value!==o(i)?"input-active":""])},[u(o(ke),{class:"filter-input-icon"}),ie(e("input",{type:"date","onUpdate:modelValue":d[4]||(d[4]=s=>h.value=s),min:c.value,max:o(i),class:"filter-input"},null,8,Al),[[xe,h.value]]),h.value!==o(i)?(t(),a("button",{key:0,onClick:d[5]||(d[5]=G(s=>h.value=o(i),["stop"])),class:"input-clear-btn"},[u(o(he),{class:"w-3 h-3"})])):f("",!0)],2)]),e("div",Il,[d[18]||(d[18]=e("label",{class:"filter-label"},"Customer",-1)),e("div",{class:$(["filter-input-wrap",E.value?"input-active":""])},[u(o(qe),{class:"filter-input-icon",style:{"z-index":"2"}}),ie(e("select",{"onUpdate:modelValue":d[6]||(d[6]=s=>E.value=s),class:"filter-input filter-select"},[e("option",Ll,"All Customers ("+l(C.value.length)+")",1),(t(!0),a(L,null,q(C.value,s=>(t(),a("option",{key:s.value,value:s.value},l(s.label),9,Nl))),128))],512),[[st,E.value]]),d[17]||(d[17]=e("svg",{class:"absolute right-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1))],2)])]),e("div",Ul,[e("div",Rl,[e("span",{class:$(["pill-dot",Y.value?"pill-dot-active":"pill-dot-idle"])},null,2),e("span",Ml,l(c.value||"Any"),1),u(o(Re),{class:"w-3 h-3 opacity-40"}),e("span",Vl,l(h.value||o(i)),1)]),E.value?(t(),a("div",zl,[u(o(qe),{class:"w-2.5 h-2.5"}),e("span",ql,l((p=C.value.find(s=>s.value===E.value))==null?void 0:p.label),1),e("button",{onClick:d[7]||(d[7]=s=>{E.value="",v.value=new Set}),class:"pill-remove"},[u(o(he),{class:"w-2.5 h-2.5"})])])):f("",!0),e("div",Bl,[e("span",El,l(S.value.length),1),d[19]||(d[19]=e("span",{class:"pill-count-label"},"orders found",-1))])])]),e("div",Hl,[e("div",Wl,[d[21]||(d[21]=e("div",{class:"w-8 h-8 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0 shadow-inner"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7"})])],-1)),d[22]||(d[22]=e("div",{class:"flex-1 min-w-0"},[e("p",{class:"text-sm font-black text-white leading-tight tracking-tight"},"Day-wise Item Summary"),e("p",{class:"text-[11px] text-emerald-200 mt-0.5 font-semibold"},"qty(â‚¹rate) â€” e.g. 002(35)")],-1)),M.value?(t(),P(o(et),{key:0,class:"w-4 h-4 text-white/80 animate-spin flex-shrink-0"})):(t(),a("div",Yl,[e("span",Ql,l(ae.value.length),1),d[20]||(d[20]=e("span",{class:"text-[11px] text-emerald-200 font-semibold"},"items",-1))]))]),M.value&&ae.value.length===0?(t(),a("div",Gl,[e("div",Jl,[u(o(et),{class:"w-5 h-5 text-emerald-500 animate-spin"})]),d[23]||(d[23]=e("p",{class:"text-xs font-semibold text-gray-400"},"Fetching item details...",-1))])):v.value.size===0?(t(),a("div",Kl,[...d[24]||(d[24]=[e("div",{class:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1),e("p",{class:"text-xs font-semibold text-gray-400"},"Select orders below to see item summary",-1)])])):!M.value&&ae.value.length===0?(t(),a("div",Xl,[e("div",Zl,[u(o(Fe),{class:"w-5 h-5 text-amber-400"})]),d[25]||(d[25]=e("p",{class:"text-xs font-semibold text-gray-400"},"No item data found for selected orders",-1)),d[26]||(d[26]=e("p",{class:"text-[10px] text-gray-300"},"Check browser console (F12) for details",-1))])):(t(),a("div",en,[e("table",tn,[e("thead",null,[e("tr",null,[d[27]||(d[27]=e("th",{class:"col-item th-item"},[e("span",{class:"th-label"},"Item")],-1)),(t(),a(L,null,q(F,s=>e("th",{key:s,class:$(["col-day th-day",s==="Saturday"||s==="Sunday"?"th-weekend":""])},l(_[s]),3)),64)),d[28]||(d[28]=e("th",{class:"col-total th-total"},[e("span",{class:"th-label"},"Total")],-1))])]),e("tbody",null,[(t(!0),a(L,null,q(ae.value,(s,y)=>(t(),a("tr",{key:s.item_code,class:$(["data-row",y%2===1?"row-alt":"row-base"])},[e("td",{class:$(["col-item td-item",y%2===1?"td-item-alt":"td-item-base"])},[e("div",{class:"item-name",title:s.item_name},l(s.item_name),9,sn),e("div",{class:"item-code",title:s.item_code},l(s.item_code),9,an)],2),(t(),a(L,null,q(F,x=>e("td",{key:x,class:$(["col-day td-day",x==="Saturday"||x==="Sunday"?"td-weekend":""])},[s.days[x]&&s.days[x].qty>0?(t(),a("span",ln,l(Ce(s.days[x].qty,s.days[x].price)),1)):(t(),a("span",nn,"Â·"))],2)),64)),e("td",on,[e("div",rn,l(m.formatCurrency(s.total_amt)),1),e("div",dn,"qty: "+l(s.total_qty),1)])],2))),128))]),e("tfoot",null,[e("tr",cn,[d[29]||(d[29]=e("td",{class:"col-item td-foot-label"},"Grand Total",-1)),(t(),a(L,null,q(F,s=>e("td",{key:s,class:$(["col-day td-foot-day",s==="Saturday"||s==="Sunday"?"td-foot-weekend":""])},null,2)),64)),e("td",un,l(m.formatCurrency(ge.value)),1)])])])]))]),e("div",xn,[e("div",pn,[d[31]||(d[31]=e("div",{class:"w-7 h-7 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),d[32]||(d[32]=e("div",{class:"flex-1"},[e("p",{class:"text-sm font-black text-white leading-none"},"Select Orders"),e("p",{class:"text-[10px] text-gray-300 mt-0.5"},"Click to select/deselect orders for invoicing")],-1)),e("button",{onClick:J,class:"flex items-center gap-1.5 bg-white/15 hover:bg-white/25 transition-colors rounded-lg px-2.5 py-1.5 flex-shrink-0"},[e("div",{class:$(["checkbox-circle-sm",W.value?"checkbox-sm-selected":z.value?"checkbox-sm-indeterminate":"checkbox-sm-unselected"])},[W.value?(t(),a("svg",mn,[...d[30]||(d[30]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):z.value?(t(),a("div",gn)):f("",!0)],2),e("span",bn,l(W.value?"Deselect All":"Select All"),1)])]),d[37]||(d[37]=e("div",{class:"hidden sm:grid items-center gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},[e("span"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"#"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Sales Order"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Delivery Note"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Delivered"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Billed"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Amount")],-1)),S.value.length===0?(t(),a("div",fn,[e("div",yn,[u(o(Fe),{class:"w-6 h-6 text-gray-300"})]),d[33]||(d[33]=e("p",{class:"text-sm font-bold text-gray-400"},"No eligible orders found",-1)),d[34]||(d[34]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting the date range or customer filter",-1))])):(t(),a("div",vn,[(t(!0),a(L,null,q(S.value,(s,y)=>(t(),a("div",{key:s.name,onClick:x=>Q(s.name),class:$(["order-row cursor-pointer select-none transition-all duration-100",v.value.has(s.name)?"order-row-selected":"order-row-unselected"])},[e("div",_n,[e("div",{class:$(["checkbox-circle",v.value.has(s.name)?"checkbox-selected":"checkbox-unselected"])},[v.value.has(s.name)?(t(),a("svg",wn,[...d[35]||(d[35]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):f("",!0)],2),e("span",kn,l(y+1),1),e("div",$n,[e("div",Cn,[e("span",Sn,l(s.name),1),s.custom_subscription_refereance?(t(),a("span",Dn,"Sub")):f("",!0)]),e("p",Fn,l(s.customer_name),1)]),e("div",jn,[e("span",Pn,l(s.delivery_note||"â€”"),1)]),e("div",Tn,[e("span",On,l(s.per_delivered)+"% ",1)]),e("div",An,[e("span",In,l(s.per_billed)+"% ",1)]),e("span",Ln,l(m.formatCurrency(s.grand_total,s.currency)),1)]),e("div",Nn,[e("div",{class:$(["checkbox-circle",v.value.has(s.name)?"checkbox-selected":"checkbox-unselected"])},[v.value.has(s.name)?(t(),a("svg",Un,[...d[36]||(d[36]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):f("",!0)],2),e("div",Rn,[e("div",Mn,[e("span",Vn,l(s.name),1),s.custom_subscription_refereance?(t(),a("span",zn,"Sub")):f("",!0)]),e("div",qn,[e("p",Bn,l(s.customer_name),1),e("span",En,l(s.per_delivered)+"%",1)])]),e("span",Hn,l(m.formatCurrency(s.grand_total,s.currency)),1)])],10,hn))),128))]))])])]}),actions:R(()=>[e("div",Wn,[e("div",Yn,[v.value.size>0?(t(),a(L,{key:0},[e("span",Qn,l(v.value.size)+" orders ",1),d[38]||(d[38]=e("div",{class:"h-4 w-px bg-gray-200 flex-shrink-0"},null,-1)),e("span",Gn,l(m.formatCurrency(ge.value)),1)],64)):f("",!0)]),e("div",Jn,[u(o(oe),{variant:"outline",class:"text-xs sm:text-sm",onClick:d[8]||(d[8]=p=>A.value=!1)},{default:R(()=>[...d[39]||(d[39]=[j("Cancel",-1)])]),_:1}),u(o(oe),{variant:"solid",theme:"green",loading:ye.value,disabled:v.value.size===0,class:"text-xs sm:text-sm",onClick:me},{prefix:R(()=>[u(o(we),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:R(()=>[d[40]||(d[40]=j(" Create Invoice ",-1))]),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"]))}}),Xn=ft(Kn,[["__scopeId","data-v-bf1c7c7e"]]),Zn={class:"w-full min-w-0"},eo={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},to={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},so={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},ao={class:"flex-1 min-w-0"},lo={class:"text-sm font-black text-white truncate"},no={key:0,class:"text-[10px] text-gray-400 font-medium"},oo={class:"text-blue-400"},ro={class:"flex items-center gap-2 flex-shrink-0"},io={key:0,class:"flex-1 flex items-center justify-center"},co={class:"flex flex-col items-center gap-4"},uo={class:"relative"},xo={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},po={key:1,class:"flex-1 flex items-center justify-center p-6"},mo={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},go={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},bo={class:"text-xs text-red-500 mt-1 break-words"},fo=["src"],yo={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},vo={class:"flex items-start gap-3"},ho={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},_o={class:"text-sm font-black text-gray-900"},wo={class:"text-xs text-gray-500 mt-1 leading-relaxed"},ko={class:"flex gap-2 justify-end"},$o={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Co={class:"flex items-start gap-3"},So={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},Do={class:"flex-1 min-w-0"},Fo={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},jo={class:"flex justify-end"},Po={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},To={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},Oo={class:"text-sm sm:text-base font-black leading-tight"},Ao={class:"bg-gradient-to-br from-orange-500 to-amber-400 rounded-xl p-3 text-white"},Io={class:"text-sm sm:text-base font-black leading-tight"},Lo={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},No={class:"text-sm sm:text-base font-black leading-tight"},Uo={class:"bg-gradient-to-br from-gray-500 to-gray-400 rounded-xl p-3 text-white"},Ro={class:"text-sm sm:text-base font-black leading-tight"},Mo={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},Vo={class:"flex flex-wrap items-center gap-2"},zo={class:"flex items-center gap-2 flex-1 min-w-0"},qo={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Bo={class:"min-w-0"},Eo={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Ho={key:0,class:"text-blue-500"},Wo={class:"relative"},Yo={class:"flex flex-wrap gap-2 items-center"},Qo={class:"flex gap-1 flex-wrap"},Go=["onClick"],Jo={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Ko=["max"],Xo={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Zo=["min"],er={key:0,class:"p-6 space-y-3"},tr={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},sr={class:"p-4 bg-gray-100 rounded-2xl mb-4"},ar={key:2},lr={class:"divide-y divide-gray-100/80"},nr=["onClick"],or={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},rr={class:"flex items-center gap-2 flex-wrap"},ir={class:"text-xs font-black text-gray-900 truncate"},dr={class:"text-[10px] text-gray-500 font-medium truncate"},cr={class:"flex items-center gap-2 flex-wrap mt-0.5"},ur={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},xr={class:"text-[10px] font-black text-gray-800"},pr={key:0,class:"text-[9px] text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded font-semibold"},mr={class:"hidden sm:block text-xs font-black text-gray-900 truncate"},gr={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},br={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},fr={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},yr={class:"hidden sm:flex justify-center"},vr={class:"flex justify-center text-gray-400"},hr={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},_r={key:0,class:"space-y-2"},wr={key:1,class:"space-y-4"},kr={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},$r={class:"col-span-2 sm:col-span-1 bg-white rounded-xl p-3 border border-gray-100"},Cr={class:"text-xs font-black text-blue-700 truncate"},Sr={class:"bg-white rounded-xl p-3 border border-gray-100"},Dr={class:"text-xs font-black text-gray-800"},Fr={class:"bg-white rounded-xl p-3 border border-gray-100"},jr={class:"text-xs font-black text-gray-800"},Pr={class:"bg-white rounded-xl p-3 border border-gray-100"},Tr={class:"text-xs font-black text-gray-800"},Or={class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},Ar={class:"bg-white rounded-xl p-3 border border-gray-100"},Ir={class:"text-xs font-black text-gray-800 truncate"},Lr={class:"bg-white rounded-xl p-3 border border-gray-100"},Nr={class:"text-xs font-black text-gray-800"},Ur={class:"bg-white rounded-xl p-3 border border-gray-100"},Rr={class:"text-xs font-black text-gray-800"},Mr={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},Vr={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},zr={class:"min-w-0"},qr={class:"text-xs font-semibold text-gray-800 truncate"},Br={class:"text-[9px] text-gray-400 truncate"},Er={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},Hr={class:"text-xs text-gray-600 text-center font-medium"},Wr={class:"text-xs text-gray-600 text-center"},Yr={class:"text-xs font-black text-gray-900 text-right"},Qr={class:"border-t border-gray-200 px-4 py-3 flex justify-between items-center"},Gr={key:0,class:"text-xs text-gray-500"},Jr={class:"text-right ml-auto"},Kr={class:"text-sm font-black text-gray-900"},Xr={class:"flex flex-wrap gap-2 justify-end pt-1"},Zr=["onClick"],ei=["onClick","disabled"],ti=["onClick","disabled"],si=["onClick","disabled"],ai=["onClick","disabled"],li={key:2,class:"space-y-2"},ni={key:0,class:"flex justify-center py-4"},oi=$e({__name:"Deliverynote",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(m){const U=m,w=I(""),O=I(""),A=I(""),F=I("all"),_=I(null),i=I(null),c=I(""),h=I(""),v=I({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),T=I({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),E=I({show:!1,message:""}),Z=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Submitted",label:"Submitted"},{key:"Cancelled",label:"Cancelled"}],M=He({doctype:"Delivery Note",fields:["name","customer","customer_name","status","posting_date","grand_total","currency","docstatus","lr_no","lr_date","per_billed","per_returned","set_warehouse","shipping_address_name"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),H=se({url:"frappe.client.get",makeParams:p=>({doctype:"Delivery Note",name:p.name}),onSuccess(p){i.value=p}}),V=se({url:"frappe.client.submit",onSuccess(){c.value="",h.value="",M.reload(),_.value&&H.fetch({name:_.value})},onError(p){c.value="",h.value="",pe((p==null?void 0:p.message)||(p==null?void 0:p.exc_type)||"Submit failed")}}),C=se({url:"frappe.client.cancel",onSuccess(){c.value="",h.value="",M.reload(),_.value&&H.fetch({name:_.value})},onError(p){c.value="",h.value="",pe((p==null?void 0:p.message)||(p==null?void 0:p.exc_type)||"Cancel failed")}}),S=se({url:"frappe.client.delete",onSuccess(){c.value="",h.value="",_.value=null,i.value=null,M.reload()},onError(p){c.value="",h.value="",pe((p==null?void 0:p.message)||(p==null?void 0:p.exc_type)||"Delete failed")}});je(()=>[U.customer,U.seller],([p])=>{const s=[];p&&s.push(["customer","=",p]),M.update({filters:s}),M.reload()},{immediate:!0});const B=N(()=>{let p=M.data||[];if(F.value!=="all"&&(p=p.filter(s=>F.value==="Draft"?s.docstatus===0:F.value==="Submitted"?s.docstatus===1:F.value==="Cancelled"?s.docstatus===2:!0)),O.value&&(p=p.filter(s=>s.posting_date>=O.value)),A.value&&(p=p.filter(s=>s.posting_date<=A.value)),w.value.trim()){const s=w.value.toLowerCase();p=p.filter(y=>{var x,r;return((x=y.name)==null?void 0:x.toLowerCase().includes(s))||((r=y.customer_name)==null?void 0:r.toLowerCase().includes(s))})}return p}),ee=N(()=>O.value!==""||A.value!==""),Y=N(()=>M.loading),W=N(()=>(M.data||[]).length>0),z=N(()=>{const p=M.data||[];return{total:p.length,draft:p.filter(s=>s.docstatus===0).length,submitted:p.filter(s=>s.docstatus===1).length,cancelled:p.filter(s=>s.docstatus===2).length}});function J(){O.value="",A.value="",F.value="all",w.value=""}function Q(p){return p.docstatus===2?{label:"Cancelled",theme:"gray",icon:Ne}:p.docstatus===0?{label:"Draft",theme:"orange",icon:Me}:p.per_billed>=100?{label:"Completed",theme:"green",icon:it}:p.per_billed>0?{label:"Partly Billed",theme:"blue",icon:Fe}:{label:"To Bill",theme:"purple",icon:We}}const de={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function ge(p){_.value===p?(_.value=null,i.value=null):(_.value=p,i.value=null,H.fetch({name:p}))}function pe(p){const s=p.replace(/<[^>]*>/g,"").trim().split(`
`)[0];E.value={show:!0,message:s}}function ae(p){return be(this,null,function*(){var s,y;try{const x=yield fetch(`/api/method/frappe.client.get_value?doctype=Property+Setter&filters=${encodeURIComponent(JSON.stringify([["doc_type","=",p],["property","=","default_print_format"]]))}&fieldname=value`,{credentials:"include"});if(x.ok){const r=yield x.json(),n=(s=r==null?void 0:r.message)==null?void 0:s.value;if(n&&n.trim())return n.trim()}}catch(x){}try{const x=yield fetch(`/api/resource/Print+Format?filters=${encodeURIComponent(JSON.stringify([["doc_type","=",p],["disabled","=",0]]))}&fields=${encodeURIComponent(JSON.stringify(["name","default_format"]))}&order_by=modified+desc&limit=50`,{credentials:"include"});if(x.ok){const r=yield x.json(),n=(r==null?void 0:r.data)||[],g=n.find(D=>D.default_format===1);if(g!=null&&g.name)return g.name;if((y=n[0])!=null&&y.name)return n[0].name}}catch(x){}return"Standard"})}function Ce(p){return be(this,null,function*(){v.value={show:!0,loading:!0,blobUrl:"",docName:p,printFormat:"",error:""};try{const s=yield ae("Delivery Note");v.value.printFormat=s;const y=`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(p)}&format=${encodeURIComponent(s)}&no_letterhead=0&letterhead=No+Letterhead`,x=yield fetch(y,{credentials:"include"});if(!x.ok){if(s!=="Standard"){const g=yield fetch(`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(p)}&format=Standard&no_letterhead=0`,{credentials:"include"});if(!g.ok)throw new Error(`HTTP ${g.status} â€” PDF generation failed`);const D=yield g.blob(),b=URL.createObjectURL(D);v.value={show:!0,loading:!1,blobUrl:b,docName:p,printFormat:"Standard (fallback)",error:""};return}throw new Error(`HTTP ${x.status} â€” PDF generation failed`)}const r=yield x.blob(),n=URL.createObjectURL(r);v.value={show:!0,loading:!1,blobUrl:n,docName:p,printFormat:s,error:""}}catch(s){const y=(s==null?void 0:s.message)||"Could not load PDF";v.value={show:!0,loading:!1,blobUrl:"",docName:p,printFormat:"",error:y}}})}function le(){v.value.blobUrl&&URL.revokeObjectURL(v.value.blobUrl),v.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function ye(){if(!v.value.blobUrl)return;const p=document.createElement("a");p.href=v.value.blobUrl,p.download=`${v.value.docName}.pdf`,p.click()}function me(p){T.value=De({show:!0},p)}function ne(p){i.value&&me({title:"Submit Delivery Note",message:`Submit ${p}? Stock entries will be posted and cannot be easily undone.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{T.value.show=!1,c.value=p,h.value="submit",V.fetch({doc:i.value})}})}function k(p){me({title:"Cancel Delivery Note",message:`Cancel ${p}? Stock entries will be reversed.`,confirmLabel:"Cancel DN",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{T.value.show=!1,c.value=p,h.value="cancel",C.fetch({doctype:"Delivery Note",name:p})}})}function d(p){me({title:"Delete Delivery Note",message:`Permanently delete ${p}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{T.value.show=!1,c.value=p,h.value="delete",S.fetch({doctype:"Delivery Note",name:p})}})}return(p,s)=>(t(),a("div",Zn,[(t(),P(Pe,{to:"body"},[u(_e,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:R(()=>[v.value.show?(t(),a("div",eo,[e("div",to,[e("div",so,[u(o(Ae),{class:"w-4 h-4 text-white"})]),e("div",ao,[e("p",lo,l(v.value.docName),1),v.value.printFormat?(t(),a("p",no,[s[12]||(s[12]=j(" Format: ",-1)),e("span",oo,l(v.value.printFormat),1)])):f("",!0)]),e("div",ro,[v.value.blobUrl?(t(),a("button",{key:0,onClick:ye,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[u(o(dt),{class:"w-3.5 h-3.5"}),s[13]||(s[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):f("",!0),e("button",{onClick:le,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[u(o(he),{class:"w-4 h-4"})])])]),v.value.loading?(t(),a("div",io,[e("div",co,[e("div",uo,[e("div",xo,[u(o(Ae),{class:"w-7 h-7 text-white/60"})]),s[14]||(s[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-blue-400 border-t-transparent animate-spin"},null,-1))]),s[15]||(s[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Detecting default print format")],-1))])])):v.value.error?(t(),a("div",po,[e("div",mo,[e("div",go,[u(o(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[s[16]||(s[16]=e("p",{class:"text-sm font-black text-red-300"},"PDF Load Failed",-1)),e("p",bo,l(v.value.error),1)]),e("button",{onClick:le,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Close ")])])):v.value.blobUrl?(t(),a("iframe",{key:2,src:v.value.blobUrl,class:"flex-1 w-full border-0",title:"Print Preview"},null,8,fo)):f("",!0)])):f("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[u(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:R(()=>[T.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s[2]||(s[2]=G(y=>T.value.show=!1,["self"]))},[e("div",yo,[e("div",vo,[e("div",ho,[u(o(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",_o,l(T.value.title),1),e("p",wo,l(T.value.message),1)])]),e("div",ko,[e("button",{onClick:s[0]||(s[0]=y=>T.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"}," Go Back "),e("button",{onClick:s[1]||(s[1]=y=>T.value.onConfirm()),class:$(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",T.value.confirmClass])},l(T.value.confirmLabel),3)])])])):f("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[u(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:R(()=>[E.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s[4]||(s[4]=G(y=>E.value.show=!1,["self"]))},[e("div",$o,[e("div",Co,[e("div",So,[u(o(Te),{class:"w-5 h-5 text-red-500"})]),e("div",Do,[s[17]||(s[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Failed",-1)),e("p",Fo,l(E.value.message),1)])]),e("div",jo,[e("button",{onClick:s[3]||(s[3]=y=>E.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"}," OK ")])])])):f("",!0)]),_:1})])),e("div",Po,[e("div",To,[s[18]||(s[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total DNs",-1)),e("p",Oo,l(z.value.total),1)]),e("div",Ao,[s[19]||(s[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Draft",-1)),e("p",Io,l(z.value.draft),1)]),e("div",Lo,[s[20]||(s[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Submitted",-1)),e("p",No,l(z.value.submitted),1)]),e("div",Uo,[s[21]||(s[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Cancelled",-1)),e("p",Ro,l(z.value.cancelled),1)])]),e("div",Mo,[e("div",Vo,[e("div",zo,[e("div",qo,[u(o(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Bo,[s[22]||(s[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Delivery Notes",-1)),e("p",Eo,[j(l(B.value.length)+" record"+l(B.value.length!==1?"s":"")+" ",1),ee.value||F.value!=="all"||w.value?(t(),a("span",Ho," (filtered)")):f("",!0)])])]),e("button",{onClick:s[5]||(s[5]=y=>o(M).reload()),class:$(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",Y.value?"opacity-60 pointer-events-none":""])},[u(o(K),{class:$(["w-3.5 h-3.5",Y.value?"animate-spin":""])},null,8,["class"]),s[23]||(s[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Wo,[u(o(Ye),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),ie(e("input",{"onUpdate:modelValue":s[6]||(s[6]=y=>w.value=y),type:"text",placeholder:"Search by DN #, customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[xe,w.value]]),w.value?(t(),a("button",{key:0,onClick:s[7]||(s[7]=y=>w.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[u(o(re),{class:"w-3.5 h-3.5"})])):f("",!0)]),e("div",Yo,[e("div",Qo,[(t(),a(L,null,q(Z,y=>e("button",{key:y.key,onClick:x=>F.value=y.key,class:$(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",F.value===y.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},l(y.label),11,Go)),64))]),e("div",Jo,[s[24]||(s[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),ie(e("input",{type:"date","onUpdate:modelValue":s[8]||(s[8]=y=>O.value=y),max:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Ko),[[xe,O.value]]),O.value?(t(),a("button",{key:0,onClick:s[9]||(s[9]=y=>O.value=""),class:"text-gray-300 hover:text-red-400"},[u(o(re),{class:"w-3 h-3"})])):f("",!0)]),e("div",Xo,[s[25]||(s[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),ie(e("input",{type:"date","onUpdate:modelValue":s[10]||(s[10]=y=>A.value=y),min:O.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Zo),[[xe,A.value]]),A.value?(t(),a("button",{key:0,onClick:s[11]||(s[11]=y=>A.value=""),class:"text-gray-300 hover:text-red-400"},[u(o(re),{class:"w-3 h-3"})])):f("",!0)]),ee.value||F.value!=="all"||w.value?(t(),a("button",{key:0,onClick:J,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[u(o(re),{class:"w-3 h-3"}),s[26]||(s[26]=j(" Clear All ",-1))])):f("",!0)])]),Y.value&&!W.value?(t(),a("div",er,[(t(),a(L,null,q(5,y=>e("div",{key:y,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!Y.value&&B.value.length===0?(t(),a("div",tr,[e("div",sr,[u(o(Oe),{class:"w-10 h-10 text-gray-300"})]),s[27]||(s[27]=e("p",{class:"text-sm font-black text-gray-300"},"No Delivery Notes Found",-1)),s[28]||(s[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),a("div",ar,[s[43]||(s[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"DN #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Amount"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",lr,[(t(!0),a(L,null,q(B.value,y=>{var x;return t(),a("div",{key:y.name},[e("div",{onClick:r=>ge(y.name),class:"grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5 hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none"},[e("div",or,[e("div",rr,[e("span",ir,l(y.name),1),e("span",{class:$(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",de[Q(y).theme]])},[(t(),P(fe(Q(y).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+l(Q(y).label),1)],2)]),e("span",dr,l(y.customer_name),1),e("div",cr,[e("span",ur,[u(o(ke),{class:"w-2.5 h-2.5"}),j(l(y.posting_date),1)]),e("span",xr,l(m.formatCurrency(y.grand_total,y.currency)),1),y.per_billed>0&&y.per_billed<100?(t(),a("span",pr,l((x=y.per_billed)==null?void 0:x.toFixed(0))+"% billed ",1)):f("",!0)])]),e("span",mr,l(y.name),1),e("span",gr,l(y.customer_name),1),e("span",br,[u(o(ke),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),j(l(y.posting_date),1)]),e("span",fr,l(m.formatCurrency(y.grand_total,y.currency)),1),e("span",yr,[e("span",{class:$(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",de[Q(y).theme]])},[(t(),P(fe(Q(y).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+l(Q(y).label),1)],2)]),e("div",vr,[_.value===y.name?(t(),P(o(Ue),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),P(o(Re),{key:1,class:"w-4 h-4"}))])],8,nr),u(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:R(()=>{var r,n,g,D;return[_.value===y.name?(t(),a("div",hr,[o(H).loading&&!i.value?(t(),a("div",_r,[(t(),a(L,null,q(4,b=>e("div",{key:b,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):i.value&&i.value.name===y.name?(t(),a("div",wr,[e("div",kr,[e("div",$r,[s[29]||(s[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Against Sales Order",-1)),e("p",Cr,l(((r=i.value.items)==null?void 0:r.map(b=>b.against_sales_order).filter(Boolean).filter((b,ve,te)=>te.indexOf(b)===ve).join(", "))||"â€”"),1)]),e("div",Sr,[s[30]||(s[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Number",-1)),e("p",Dr,l(i.value.lr_no||"â€”"),1)]),e("div",Fr,[s[31]||(s[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Date",-1)),e("p",jr,l(i.value.lr_date||"â€”"),1)]),e("div",Pr,[s[32]||(s[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Billed %",-1)),e("p",Tr,l((n=i.value.per_billed)!=null?n:0)+"%",1)])]),e("div",Or,[e("div",Ar,[s[33]||(s[33]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Warehouse",-1)),e("p",Ir,l(i.value.set_warehouse||"â€”"),1)]),e("div",Lr,[s[34]||(s[34]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"% Returned",-1)),e("p",Nr,l((g=i.value.per_returned)!=null?g:0)+"%",1)]),e("div",Ur,[s[35]||(s[35]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Vehicle No",-1)),e("p",Rr,l(i.value.vehicle_no||"â€”"),1)])]),(D=i.value.items)!=null&&D.length?(t(),a("div",Mr,[s[37]||(s[37]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",Vr,[(t(!0),a(L,null,q(i.value.items,b=>(t(),a("div",{key:b.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",zr,[e("p",qr,l(b.item_name),1),e("p",Br,l(b.item_code),1),b.against_sales_order?(t(),a("p",Er," SO: "+l(b.against_sales_order),1)):f("",!0)]),e("span",Hr,l(b.qty)+" "+l(b.uom),1),e("span",Wr,l(m.formatCurrency(b.rate,i.value.currency)),1),e("span",Yr,l(m.formatCurrency(b.amount,i.value.currency)),1)]))),128))]),e("div",Qr,[i.value.total_taxes_and_charges?(t(),a("div",Gr," Tax: "+l(m.formatCurrency(i.value.total_taxes_and_charges,i.value.currency)),1)):f("",!0),e("div",Jr,[s[36]||(s[36]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase"},"Grand Total",-1)),e("p",Kr,l(m.formatCurrency(i.value.grand_total,i.value.currency)),1)])])])):f("",!0),e("div",Xr,[e("button",{onClick:G(b=>Ce(y.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[u(o(Ae),{class:"w-3.5 h-3.5"}),s[38]||(s[38]=j(" Print / PDF ",-1))],8,Zr),i.value.docstatus===0?(t(),a("button",{key:0,onClick:G(b=>ne(y.name),["stop"]),disabled:c.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[c.value===y.name&&h.value==="submit"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(ct),{key:1,class:"w-3.5 h-3.5"})),s[39]||(s[39]=j(" Submit ",-1))],8,ei)):f("",!0),i.value.docstatus===0?(t(),a("button",{key:1,onClick:G(b=>d(y.name),["stop"]),disabled:c.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[c.value===y.name&&h.value==="delete"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(Le),{key:1,class:"w-3.5 h-3.5"})),s[40]||(s[40]=j(" Delete ",-1))],8,ti)):f("",!0),i.value.docstatus===1?(t(),a("button",{key:2,onClick:G(b=>k(y.name),["stop"]),disabled:c.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[c.value===y.name&&h.value==="cancel"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(Ne),{key:1,class:"w-3.5 h-3.5"})),s[41]||(s[41]=j(" Cancel ",-1))],8,si)):f("",!0),i.value.docstatus===2?(t(),a("button",{key:3,onClick:G(b=>d(y.name),["stop"]),disabled:c.value===y.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[c.value===y.name&&h.value==="delete"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(Le),{key:1,class:"w-3.5 h-3.5"})),s[42]||(s[42]=j(" Delete ",-1))],8,ai)):f("",!0)])])):(t(),a("div",li,[(t(),a(L,null,q(3,b=>e("div",{key:b,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):f("",!0)]}),_:2},1024)])}),128))]),Y.value&&W.value?(t(),a("div",ni,[u(o(K),{class:"w-5 h-5 text-gray-400 animate-spin"})])):f("",!0)]))]))}}),ri={class:"w-full min-w-0"},ii={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},di={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},ci={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},ui={class:"flex-1 min-w-0"},xi={class:"text-sm font-black text-white truncate"},pi={class:"text-emerald-400"},mi={class:"flex items-center gap-2 flex-shrink-0"},gi={key:0,class:"flex-1 flex items-center justify-center"},bi={class:"flex flex-col items-center gap-4"},fi={class:"relative"},yi={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},vi={key:1,class:"flex-1 flex items-center justify-center p-6"},hi={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},_i={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},wi={class:"text-xs text-red-500 mt-1 break-words"},ki=["src"],$i={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Ci={class:"flex items-start gap-3"},Si={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},Di={class:"text-sm font-black text-gray-900"},Fi={class:"text-xs text-gray-500 mt-1 leading-relaxed"},ji={class:"flex gap-2 justify-end"},Pi={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Ti={class:"flex items-start gap-3"},Oi={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},Ai={class:"flex-1 min-w-0"},Ii={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},Li={class:"flex justify-end"},Ni={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},Ui={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},Ri={class:"text-sm sm:text-base font-black leading-tight"},Mi={class:"bg-gradient-to-br from-blue-600 to-blue-500 rounded-xl p-3 text-white"},Vi={class:"text-sm sm:text-base font-black leading-tight"},zi={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},qi={class:"text-sm sm:text-base font-black leading-tight"},Bi={class:"bg-gradient-to-br from-red-500 to-red-400 rounded-xl p-3 text-white"},Ei={class:"text-sm sm:text-base font-black leading-tight"},Hi={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},Wi={class:"flex flex-wrap items-center gap-2"},Yi={class:"flex items-center gap-2 flex-1 min-w-0"},Qi={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Gi={class:"min-w-0"},Ji={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Ki={key:0,class:"text-blue-500"},Xi={class:"relative"},Zi={class:"flex flex-wrap gap-2 items-center"},ed={class:"flex gap-1 flex-wrap"},td=["onClick"],sd={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},ad=["max"],ld={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},nd=["min"],od={key:0,class:"p-6 space-y-3"},rd={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},id={class:"p-4 bg-gray-100 rounded-2xl mb-4"},dd={key:2},cd={class:"divide-y divide-gray-100/80"},ud=["onClick"],xd={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},pd={class:"flex items-center gap-2 flex-wrap"},md={class:"text-xs font-black text-gray-900"},gd={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold"},bd={class:"text-[10px] text-gray-500 font-medium truncate"},fd={class:"flex items-center gap-3 flex-wrap mt-0.5"},yd={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},vd={class:"text-[10px] font-black text-gray-900"},hd={key:0,class:"text-[9px] font-bold text-red-500"},_d={key:0,class:"mt-1.5 w-full bg-gray-200 rounded-full h-1"},wd={class:"hidden sm:flex items-center gap-1.5 min-w-0"},kd={class:"text-xs font-black text-gray-900 truncate"},$d={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},Cd={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},Sd={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},Dd={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},Fd={class:"hidden sm:flex flex-col items-end gap-1"},jd={key:0,class:"w-16 bg-gray-200 rounded-full h-1"},Pd={class:"hidden sm:flex justify-center"},Td={class:"flex justify-center text-gray-400"},Od={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},Ad={key:0,class:"space-y-2"},Id={key:1,class:"space-y-4"},Ld={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},Nd={class:"bg-white rounded-xl p-3 border border-gray-100"},Ud={class:"bg-white rounded-xl p-3 border border-gray-100"},Rd={class:"text-xs font-black text-green-700"},Md={class:"bg-white rounded-xl p-3 border border-gray-100"},Vd={class:"text-xs font-black text-gray-800"},zd={class:"bg-white rounded-xl p-3 border border-gray-100"},qd={class:"text-xs font-black text-gray-800 truncate"},Bd={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},Ed={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},Hd={class:"min-w-0"},Wd={class:"text-xs font-semibold text-gray-800 truncate"},Yd={class:"text-[9px] text-gray-400 truncate"},Qd={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},Gd={class:"text-xs text-gray-600 text-center font-medium"},Jd={class:"text-xs text-gray-600 text-center"},Kd={class:"text-xs font-black text-gray-900 text-right"},Xd={class:"border-t border-gray-200 px-4 py-3 space-y-1.5"},Zd={key:0,class:"flex justify-between text-xs text-gray-500"},ec={class:"flex justify-between items-center"},tc={class:"text-sm font-black text-gray-900"},sc={key:1,class:"flex justify-between items-center"},ac={class:"text-sm font-black text-red-600"},lc={key:1,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},nc={class:"divide-y divide-gray-100 max-h-36 overflow-y-auto"},oc={class:"text-xs text-gray-600 flex-shrink-0"},rc={class:"text-xs font-bold text-gray-500 truncate"},ic={class:"text-xs font-black text-gray-900 flex-shrink-0"},dc={class:"flex flex-wrap gap-2 justify-end pt-1"},cc=["onClick"],uc=["onClick","disabled"],xc=["onClick","disabled"],pc=["onClick","disabled"],mc=["onClick","disabled"],gc={key:2,class:"space-y-2"},bc={key:0,class:"flex justify-center py-4"},fc=$e({__name:"SalesInvoiceList",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(m){const U=m,w=I(""),O=I(""),A=I(""),F=I("all"),_=I(null),i=I(null),c=I(""),h=I(""),v=I({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),T=I({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),E=I({show:!1,message:""}),Z=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Unpaid",label:"Unpaid"},{key:"Paid",label:"Paid"},{key:"Overdue",label:"Overdue"},{key:"Cancelled",label:"Cancelled"}],M=He({doctype:"Sales Invoice",fields:["name","customer","customer_name","status","posting_date","grand_total","outstanding_amount","currency","docstatus","due_date","paid_amount","discount_amount","taxes_and_charges","is_return","return_against"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),H=se({url:"frappe.client.get",makeParams:x=>({doctype:"Sales Invoice",name:x.name}),onSuccess(x){i.value=x}}),V=se({url:"frappe.client.submit",onSuccess(){c.value="",h.value="",M.reload(),_.value&&H.fetch({name:_.value})},onError(x){c.value="",h.value="",ae((x==null?void 0:x.message)||(x==null?void 0:x.exc_type)||"Submit failed")}}),C=se({url:"frappe.client.cancel",onSuccess(){c.value="",h.value="",M.reload(),_.value&&H.fetch({name:_.value})},onError(x){c.value="",h.value="",ae((x==null?void 0:x.message)||(x==null?void 0:x.exc_type)||"Cancel failed")}}),S=se({url:"frappe.client.delete",onSuccess(){c.value="",h.value="",_.value=null,i.value=null,M.reload()},onError(x){c.value="",h.value="",ae((x==null?void 0:x.message)||(x==null?void 0:x.exc_type)||"Delete failed")}});je(()=>[U.customer,U.seller],([x])=>{const r=[];x&&r.push(["customer","=",x]),M.update({filters:r}),M.reload()},{immediate:!0});const B=N(()=>{let x=M.data||[];if(F.value!=="all"&&(F.value==="Draft"?x=x.filter(r=>r.docstatus===0):F.value==="Cancelled"?x=x.filter(r=>r.docstatus===2):x=x.filter(r=>r.status===F.value)),O.value&&(x=x.filter(r=>r.posting_date>=O.value)),A.value&&(x=x.filter(r=>r.posting_date<=A.value)),w.value.trim()){const r=w.value.toLowerCase();x=x.filter(n=>{var g,D;return((g=n.name)==null?void 0:g.toLowerCase().includes(r))||((D=n.customer_name)==null?void 0:D.toLowerCase().includes(r))})}return x}),ee=N(()=>O.value!==""||A.value!==""),Y=N(()=>M.loading),W=N(()=>(M.data||[]).length>0),z=N(()=>{const r=(M.data||[]).filter(n=>n.docstatus===1);return{total:r.reduce((n,g)=>n+(g.grand_total||0),0),outstanding:r.reduce((n,g)=>n+(g.outstanding_amount||0),0),paid:r.reduce((n,g)=>n+(g.paid_amount||0),0),overdue:r.filter(n=>n.status==="Overdue").length}});function J(){O.value="",A.value="",F.value="all",w.value=""}function Q(x){return x.docstatus===2?{label:"Cancelled",theme:"gray",icon:Ne}:x.docstatus===0?{label:"Draft",theme:"orange",icon:Me}:x.status==="Paid"?{label:"Paid",theme:"green",icon:it}:x.status==="Overdue"?{label:"Overdue",theme:"red",icon:Fe}:x.status==="Unpaid"?{label:"Unpaid",theme:"blue",icon:ze}:x.status==="Partly Paid"?{label:"Part Paid",theme:"purple",icon:vt}:{label:x.status||"Unknown",theme:"gray",icon:we}}const de={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function ge(x){return x.grand_total?Math.round(x.outstanding_amount/x.grand_total*100):0}function pe(x){_.value===x?(_.value=null,i.value=null):(_.value=x,i.value=null,H.fetch({name:x}))}function ae(x){const r=x.replace(/<[^>]*>/g,"").trim().split(`
`)[0];E.value={show:!0,message:r}}function Ce(x){return be(this,null,function*(){var r,n,g,D,b,ve;try{const te=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":le()},body:JSON.stringify({doctype:"Print Format",filters:{doc_type:x,default_format:1,disabled:0},fieldname:"name"})});if(te.ok){const ce=yield te.json(),ue=(n=(r=ce==null?void 0:ce.message)==null?void 0:r.name)==null?void 0:n.trim();if(ue)return console.log(`[PrintFormat] âœ… Step 1a (default_format=1 via POST) â†’ "${ue}"`),ue}}catch(te){console.warn("[PrintFormat] Step 1a error:",te)}try{const te=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":le()},body:JSON.stringify({doctype:"Property Setter",filters:{doc_type:x,property:"default_print_format"},fieldname:"value"})});if(te.ok){const ce=yield te.json(),ue=(D=(g=ce==null?void 0:ce.message)==null?void 0:g.value)==null?void 0:D.trim();if(ue)return console.log(`[PrintFormat] âœ… Step 1b (Property Setter via POST) â†’ "${ue}"`),ue}}catch(te){console.warn("[PrintFormat] Step 1b error:",te)}try{const te=yield fetch("/api/method/frappe.client.get_value",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":le()},body:JSON.stringify({doctype:"Print Format",filters:{doc_type:x,disabled:0,standard:"No"},fieldname:"name"})});if(te.ok){const ce=yield te.json(),ue=(ve=(b=ce==null?void 0:ce.message)==null?void 0:b.name)==null?void 0:ve.trim();if(ue)return console.log(`[PrintFormat] âœ… Step 1c (first custom via POST) â†’ "${ue}"`),ue}}catch(te){console.warn("[PrintFormat] Step 1c error:",te)}return console.log("[PrintFormat] âš ï¸ Sab steps fail â€” server default use karega (format=null)"),null})}function le(){try{const x=document.cookie.match(/csrftoken=([^;]+)/);return x?x[1]:""}catch(x){return""}}function ye(x){return be(this,null,function*(){v.value={show:!0,loading:!0,blobUrl:"",docName:x,printFormat:"Detectingâ€¦",error:""};try{const r=yield Ce("Sales Invoice");v.value.printFormat=r!=null?r:"Server Default";const n=yield me(x,r);v.value={show:!0,loading:!1,blobUrl:URL.createObjectURL(n),docName:x,printFormat:r!=null?r:"Server Default",error:""}}catch(r){v.value={show:!0,loading:!1,blobUrl:"",docName:x,printFormat:"",error:(r==null?void 0:r.message)||"PDF load fail ho gaya"}}})}function me(x,r){return be(this,null,function*(){const n=D=>{const b={doctype:"Sales Invoice",name:x,no_letterhead:"0",letterhead:"No Letterhead"};return D&&(b.format=D),"/api/method/frappe.utils.print_format.download_pdf?"+new URLSearchParams(b).toString()};if(r){const D=yield fetch(n(r),{credentials:"include"});if(D.ok){const b=yield D.blob();if(b.size>500)return console.log(`[PDF] âœ… Format "${r}" se PDF ready`),b}console.warn(`[PDF] Format "${r}" fail, format-less retry...`),v.value.printFormat="Server Default"}const g=yield fetch(n(),{credentials:"include"});if(g.ok){const D=yield g.blob();if(D.size>500)return console.log("[PDF] âœ… Server default format se PDF ready"),D}throw new Error(`PDF generate nahi hua â€” HTTP ${g.status}`)})}function ne(){v.value.blobUrl&&URL.revokeObjectURL(v.value.blobUrl),v.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function k(){if(!v.value.blobUrl)return;const x=document.createElement("a");x.href=v.value.blobUrl,x.download=`${v.value.docName}.pdf`,x.click()}function d(x){T.value=De({show:!0},x)}function p(x){i.value&&d({title:"Sales Invoice Submit Karo",message:`${x} submit karein? Accounting entries post ho jaayengi.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{T.value.show=!1,c.value=x,h.value="submit",V.fetch({doc:i.value})}})}function s(x){d({title:"Sales Invoice Cancel Karo",message:`${x} cancel karein? Saari accounting entries reverse ho jaayengi.`,confirmLabel:"Cancel Invoice",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{T.value.show=!1,c.value=x,h.value="cancel",C.fetch({doctype:"Sales Invoice",name:x})}})}function y(x){d({title:"Sales Invoice Delete Karo",message:`${x} permanently delete karein? Yeh undo nahi ho sakta.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{T.value.show=!1,c.value=x,h.value="delete",S.fetch({doctype:"Sales Invoice",name:x})}})}return(x,r)=>(t(),a("div",ri,[(t(),P(Pe,{to:"body"},[u(_e,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:R(()=>[v.value.show?(t(),a("div",ii,[e("div",di,[e("div",ci,[u(o(Ae),{class:"w-4 h-4 text-white"})]),e("div",ui,[e("p",xi,l(v.value.docName),1),e("p",{class:$(["text-[10px] font-medium",v.value.loading?"text-gray-500 animate-pulse":"text-gray-400"])},[r[12]||(r[12]=j(" Format: ",-1)),e("span",pi,l(v.value.printFormat||"â€¦"),1)],2)]),e("div",mi,[v.value.blobUrl?(t(),a("button",{key:0,onClick:k,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[u(o(dt),{class:"w-3.5 h-3.5"}),r[13]||(r[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):f("",!0),e("button",{onClick:ne,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[u(o(he),{class:"w-4 h-4"})])])]),v.value.loading?(t(),a("div",gi,[e("div",bi,[e("div",fi,[e("div",yi,[u(o(we),{class:"w-7 h-7 text-white/60"})]),r[14]||(r[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-emerald-400 border-t-transparent animate-spin"},null,-1))]),r[15]||(r[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"PDF Prepare Ho Raha Haiâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Default print format detect ho raha hai")],-1))])])):v.value.error?(t(),a("div",vi,[e("div",hi,[e("div",_i,[u(o(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[r[16]||(r[16]=e("p",{class:"text-sm font-black text-red-300"},"PDF Load Fail Hua",-1)),e("p",wi,l(v.value.error),1)]),e("button",{onClick:ne,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Band Karo ")])])):v.value.blobUrl?(t(),a("iframe",{key:2,src:v.value.blobUrl,class:"flex-1 w-full border-0",title:"Invoice Print Preview"},null,8,ki)):f("",!0)])):f("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[u(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:R(()=>[T.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:r[2]||(r[2]=G(n=>T.value.show=!1,["self"]))},[e("div",$i,[e("div",Ci,[e("div",Si,[u(o(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",Di,l(T.value.title),1),e("p",Fi,l(T.value.message),1)])]),e("div",ji,[e("button",{onClick:r[0]||(r[0]=n=>T.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"},"Wapas Jao"),e("button",{onClick:r[1]||(r[1]=n=>T.value.onConfirm()),class:$(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",T.value.confirmClass])},l(T.value.confirmLabel),3)])])])):f("",!0)]),_:1})])),(t(),P(Pe,{to:"body"},[u(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:R(()=>[E.value.show?(t(),a("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:r[4]||(r[4]=G(n=>E.value.show=!1,["self"]))},[e("div",Pi,[e("div",Ti,[e("div",Oi,[u(o(Te),{class:"w-5 h-5 text-red-500"})]),e("div",Ai,[r[17]||(r[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Fail Hua",-1)),e("p",Ii,l(E.value.message),1)])]),e("div",Li,[e("button",{onClick:r[3]||(r[3]=n=>E.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"},"OK")])])])):f("",!0)]),_:1})])),e("div",Ni,[e("div",Ui,[r[18]||(r[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total Billed",-1)),e("p",Ri,l(m.formatCurrency(z.value.total)),1)]),e("div",Mi,[r[19]||(r[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Outstanding",-1)),e("p",Vi,l(m.formatCurrency(z.value.outstanding)),1)]),e("div",zi,[r[20]||(r[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Collected",-1)),e("p",qi,l(m.formatCurrency(z.value.paid)),1)]),e("div",Bi,[r[21]||(r[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Overdue",-1)),e("p",Ei,l(z.value.overdue)+" invoice"+l(z.value.overdue!==1?"s":""),1)])]),e("div",Hi,[e("div",Wi,[e("div",Yi,[e("div",Qi,[u(o(we),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Gi,[r[22]||(r[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Invoices",-1)),e("p",Ji,[j(l(B.value.length)+" record"+l(B.value.length!==1?"s":"")+" ",1),ee.value||F.value!=="all"||w.value?(t(),a("span",Ki," (filtered)")):f("",!0)])])]),e("button",{onClick:r[5]||(r[5]=n=>o(M).reload()),class:$(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",Y.value?"opacity-60 pointer-events-none":""])},[u(o(K),{class:$(["w-3.5 h-3.5",Y.value?"animate-spin":""])},null,8,["class"]),r[23]||(r[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Xi,[u(o(Ye),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),ie(e("input",{"onUpdate:modelValue":r[6]||(r[6]=n=>w.value=n),type:"text",placeholder:"Invoice # ya customer dhundoâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[xe,w.value]]),w.value?(t(),a("button",{key:0,onClick:r[7]||(r[7]=n=>w.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[u(o(re),{class:"w-3.5 h-3.5"})])):f("",!0)]),e("div",Zi,[e("div",ed,[(t(),a(L,null,q(Z,n=>e("button",{key:n.key,onClick:g=>F.value=n.key,class:$(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",F.value===n.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},l(n.label),11,td)),64))]),e("div",sd,[r[24]||(r[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),ie(e("input",{type:"date","onUpdate:modelValue":r[8]||(r[8]=n=>O.value=n),max:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,ad),[[xe,O.value]]),O.value?(t(),a("button",{key:0,onClick:r[9]||(r[9]=n=>O.value=""),class:"text-gray-300 hover:text-red-400"},[u(o(re),{class:"w-3 h-3"})])):f("",!0)]),e("div",ld,[r[25]||(r[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),ie(e("input",{type:"date","onUpdate:modelValue":r[10]||(r[10]=n=>A.value=n),min:O.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,nd),[[xe,A.value]]),A.value?(t(),a("button",{key:0,onClick:r[11]||(r[11]=n=>A.value=""),class:"text-gray-300 hover:text-red-400"},[u(o(re),{class:"w-3 h-3"})])):f("",!0)]),ee.value||F.value!=="all"||w.value?(t(),a("button",{key:0,onClick:J,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[u(o(re),{class:"w-3 h-3"}),r[26]||(r[26]=j(" Sab Clear Karo ",-1))])):f("",!0)])]),Y.value&&!W.value?(t(),a("div",od,[(t(),a(L,null,q(5,n=>e("div",{key:n,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!Y.value&&B.value.length===0?(t(),a("div",rd,[e("div",id,[u(o(we),{class:"w-10 h-10 text-gray-300"})]),r[27]||(r[27]=e("p",{class:"text-sm font-black text-gray-300"},"Koi Invoice Nahi Mila",-1)),r[28]||(r[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Filters change karke dekho",-1))])):(t(),a("div",dd,[r[43]||(r[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Invoice #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Grand Total"),e("span",{class:"text-right"},"Outstanding"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",cd,[(t(!0),a(L,null,q(B.value,n=>(t(),a("div",{key:n.name},[e("div",{onClick:g=>pe(n.name),class:$(["grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_36px]","gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5","hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none",n.status==="Overdue"?"bg-red-50/30":""])},[e("div",xd,[e("div",pd,[e("span",md,l(n.name),1),n.is_return?(t(),a("span",gd,"Return")):f("",!0),e("span",{class:$(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",de[Q(n).theme]])},[(t(),P(fe(Q(n).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+l(Q(n).label),1)],2)]),e("span",bd,l(n.customer_name),1),e("div",fd,[e("span",yd,[u(o(ke),{class:"w-2.5 h-2.5"}),j(l(n.posting_date),1)]),e("span",vd,l(m.formatCurrency(n.grand_total,n.currency)),1),n.outstanding_amount>0?(t(),a("span",hd,"Due: "+l(m.formatCurrency(n.outstanding_amount,n.currency)),1)):f("",!0)]),n.docstatus===1&&n.grand_total>0?(t(),a("div",_d,[e("div",{style:Je({width:`${100-ge(n)}%`}),class:$(["h-1 rounded-full transition-all",n.status==="Paid"?"bg-green-500":n.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):f("",!0)]),e("div",wd,[e("span",kd,l(n.name),1),n.is_return?(t(),a("span",$d,"Return")):f("",!0)]),e("span",Cd,l(n.customer_name),1),e("span",Sd,[u(o(ke),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),j(l(n.posting_date),1)]),e("span",Dd,l(m.formatCurrency(n.grand_total,n.currency)),1),e("div",Fd,[e("span",{class:$(["text-xs font-black",n.outstanding_amount>0?"text-red-600":"text-gray-400"])},l(n.outstanding_amount>0?m.formatCurrency(n.outstanding_amount,n.currency):"â€”"),3),n.docstatus===1&&n.grand_total>0?(t(),a("div",jd,[e("div",{style:Je({width:`${100-ge(n)}%`}),class:$(["h-1 rounded-full",n.status==="Paid"?"bg-green-500":n.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):f("",!0)]),e("span",Pd,[e("span",{class:$(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",de[Q(n).theme]])},[(t(),P(fe(Q(n).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+l(Q(n).label),1)],2)]),e("div",Td,[_.value===n.name?(t(),P(o(Ue),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),P(o(Re),{key:1,class:"w-4 h-4"}))])],10,ud),u(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:R(()=>{var g,D;return[_.value===n.name?(t(),a("div",Od,[o(H).loading&&!i.value?(t(),a("div",Ad,[(t(),a(L,null,q(4,b=>e("div",{key:b,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):i.value&&i.value.name===n.name?(t(),a("div",Id,[e("div",Ld,[e("div",Nd,[r[29]||(r[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Due Date",-1)),e("p",{class:$(["text-xs font-black",i.value.status==="Overdue"?"text-red-600":"text-gray-800"])},l(i.value.due_date||"â€”"),3)]),e("div",Ud,[r[30]||(r[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid Amount",-1)),e("p",Rd,l(m.formatCurrency(i.value.paid_amount||0,i.value.currency)),1)]),e("div",Md,[r[31]||(r[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Discount",-1)),e("p",Vd,l(m.formatCurrency(i.value.discount_amount||0,i.value.currency)),1)]),e("div",zd,[r[32]||(r[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Tax Template",-1)),e("p",qd,l(i.value.taxes_and_charges||"â€”"),1)])]),(g=i.value.items)!=null&&g.length?(t(),a("div",Bd,[r[36]||(r[36]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",Ed,[(t(!0),a(L,null,q(i.value.items,b=>(t(),a("div",{key:b.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",Hd,[e("p",Wd,l(b.item_name),1),e("p",Yd,l(b.item_code),1),b.delivery_note?(t(),a("p",Qd,"DN: "+l(b.delivery_note),1)):f("",!0)]),e("span",Gd,l(b.qty)+" "+l(b.uom),1),e("span",Jd,l(m.formatCurrency(b.rate,i.value.currency)),1),e("span",Kd,l(m.formatCurrency(b.amount,i.value.currency)),1)]))),128))]),e("div",Xd,[i.value.total_taxes_and_charges?(t(),a("div",Zd,[r[33]||(r[33]=e("span",null,"Taxes",-1)),e("span",null,l(m.formatCurrency(i.value.total_taxes_and_charges,i.value.currency)),1)])):f("",!0),e("div",ec,[r[34]||(r[34]=e("span",{class:"text-xs font-black text-gray-500 uppercase tracking-wide"},"Grand Total",-1)),e("span",tc,l(m.formatCurrency(i.value.grand_total,i.value.currency)),1)]),i.value.outstanding_amount>0?(t(),a("div",sc,[r[35]||(r[35]=e("span",{class:"text-xs font-bold text-red-500 uppercase tracking-wide"},"Outstanding",-1)),e("span",ac,l(m.formatCurrency(i.value.outstanding_amount,i.value.currency)),1)])):f("",!0)])])):f("",!0),(D=i.value.payment_schedule)!=null&&D.length?(t(),a("div",lc,[r[37]||(r[37]=e("div",{class:"px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[10px] font-black text-gray-500 uppercase tracking-widest"},"Payment Schedule",-1)),e("div",nc,[(t(!0),a(L,null,q(i.value.payment_schedule,b=>(t(),a("div",{key:b.name,class:"flex items-center justify-between gap-2 px-4 py-2.5"},[e("span",oc,l(b.due_date),1),e("span",rc,l(b.payment_term),1),e("span",ic,l(m.formatCurrency(b.payment_amount,i.value.currency)),1),e("span",{class:$(["text-[9px] font-bold px-1.5 py-0.5 rounded-full flex-shrink-0",b.outstanding>0?"bg-red-50 text-red-600":"bg-green-50 text-green-600"])},l(b.outstanding>0?"Due":"Paid"),3)]))),128))])])):f("",!0),e("div",dc,[e("button",{onClick:G(b=>ye(n.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[u(o(Ae),{class:"w-3.5 h-3.5"}),r[38]||(r[38]=j("Print / PDF ",-1))],8,cc),i.value.docstatus===0?(t(),a("button",{key:0,onClick:G(b=>p(n.name),["stop"]),disabled:c.value===n.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[c.value===n.name&&h.value==="submit"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(ct),{key:1,class:"w-3.5 h-3.5"})),r[39]||(r[39]=j("Submit ",-1))],8,uc)):f("",!0),i.value.docstatus===0?(t(),a("button",{key:1,onClick:G(b=>y(n.name),["stop"]),disabled:c.value===n.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[c.value===n.name&&h.value==="delete"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(Le),{key:1,class:"w-3.5 h-3.5"})),r[40]||(r[40]=j("Delete ",-1))],8,xc)):f("",!0),i.value.docstatus===1?(t(),a("button",{key:2,onClick:G(b=>s(n.name),["stop"]),disabled:c.value===n.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[c.value===n.name&&h.value==="cancel"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(Ne),{key:1,class:"w-3.5 h-3.5"})),r[41]||(r[41]=j("Cancel ",-1))],8,pc)):f("",!0),i.value.docstatus===2?(t(),a("button",{key:3,onClick:G(b=>y(n.name),["stop"]),disabled:c.value===n.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[c.value===n.name&&h.value==="delete"?(t(),P(o(K),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),P(o(Le),{key:1,class:"w-3.5 h-3.5"})),r[42]||(r[42]=j("Delete ",-1))],8,mc)):f("",!0)])])):(t(),a("div",gc,[(t(),a(L,null,q(3,b=>e("div",{key:b,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):f("",!0)]}),_:2},1024)]))),128))]),Y.value&&W.value?(t(),a("div",bc,[u(o(K),{class:"w-5 h-5 text-gray-400 animate-spin"})])):f("",!0)]))]))}}),yc={class:"w-full min-w-0 max-w-7xl mx-auto font-sans text-gray-900 px-0 sm:px-4 md:px-6 pt-[env(safe-area-inset-top,0px)] pb-[calc(120px+env(safe-area-inset-bottom,0px))] sm:pb-[env(safe-area-inset-bottom,16px)] space-y-3 sm:space-y-4 md:space-y-5"},vc={class:"hidden sm:flex items-center justify-between gap-2 pt-1 flex-wrap"},hc={class:"flex gap-1 bg-gray-100 p-1 rounded-xl"},_c=["onClick"],wc={class:"px-2 sm:px-0"},kc={class:"bg-white border-y sm:border border-gray-100 sm:rounded-2xl shadow-sm overflow-hidden w-full min-w-0"},$c={class:"hidden sm:block border-b border-gray-100 overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden"},Cc={class:"flex min-w-max"},Sc=["onClick"],Dc={key:0,class:"absolute bottom-0 left-0 right-0 h-[2.5px] bg-gray-900 rounded-t-full"},Fc={class:"sm:hidden flex items-center gap-2 px-3 py-2.5 border-b border-gray-100 bg-gray-50/60"},jc={class:"text-sm font-black text-gray-800"},Pc={key:0,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},Tc={class:"w-full flex justify-end px-3 pb-4"},Oc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Ac={class:"border-b border-gray-100 bg-gray-50/60"},Ic={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pt-3 pb-2"},Lc={class:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0"},Nc={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Uc={class:"min-w-0"},Rc={class:"flex items-center gap-1.5 flex-wrap mt-0.5"},Mc={class:"text-[10px] sm:text-xs text-gray-400 font-medium"},Vc={key:0},zc={key:1},qc={key:2},Bc={key:3},Ec={class:"text-[9px] font-bold text-blue-600 bg-blue-50 border border-blue-100 px-1.5 py-0.5 rounded-full whitespace-nowrap"},Hc={class:"text-[9px] text-gray-400 font-semibold"},Wc={class:"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end"},Yc={class:"flex items-center justify-center w-5 h-5 bg-white/20 rounded-md flex-shrink-0"},Qc={class:"flex items-center justify-center w-5 h-5 bg-white/20 rounded-md flex-shrink-0"},Gc={class:"bg-white/25 text-white text-[10px] font-black px-1.5 py-0.5 rounded-full leading-none"},Jc={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pb-3"},Kc={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},Xc=["max"],Zc={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},e0=["min"],t0={key:1,class:"text-[10px] text-gray-400 font-semibold"},s0={key:4,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},a0={class:"w-full flex justify-end px-3 pb-4"},l0={class:"p-4 bg-gray-100 rounded-2xl mb-4"},n0={key:5,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},o0={class:"w-full flex justify-end px-3 pb-4"},r0={class:"p-4 bg-gray-100 rounded-2xl mb-4"},i0={key:1,class:"px-2 sm:px-0"},d0={class:"sm:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/96 backdrop-blur-xl border-t border-gray-200 pb-[env(safe-area-inset-bottom,0px)] shadow-[0_-4px_32px_rgba(0,0,0,0.10)]",style:{"will-change":"transform"}},c0={class:"flex border-b border-gray-100"},u0=["onClick"],x0={key:0,class:"flex overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden overscroll-x-contain"},p0=["onClick"],m0={key:0,class:"absolute top-0 left-1/2 -translate-x-1/2 w-6 h-[2px] bg-gray-900 rounded-b-full"},g0={class:"leading-tight text-center whitespace-nowrap"},v0=$e({__name:"SellerHomeComponent",props:{filters:{}},setup(m){const U=m,w=yt("showToast"),O=I("dashboard"),A=[{key:"dashboard",label:"Dashboard",icon:wt},{key:"customers",label:"My Customers",icon:at}],F=I("salesorder"),_=[{key:"quotation",label:"Quotation",shortLabel:"Quote",icon:Xe},{key:"salesorder",label:"Sales Order",shortLabel:"SO",icon:Ke},{key:"delivery",label:"Delivery Note",shortLabel:"Delivery",icon:Oe},{key:"invoice",label:"Sales Invoice",shortLabel:"Invoice",icon:we},{key:"payment",label:"Payment",shortLabel:"Payment",icon:ze},{key:"customer_ledger",label:"Customer Ledger",shortLabel:"Ledger",icon:Ze}],i=N(()=>_.find(n=>n.key===F.value)),c=I("all"),h=I(""),v=I(""),T=N(()=>h.value!==""||v.value!=="");function E(){h.value="",v.value=""}const Z=I(!1),M=I(!1),H=I(""),V=I(""),C=I(null),S=I(null),B=He({doctype:"Sales Order",fields:["name","customer","customer_name","status","grand_total","currency","docstatus","per_delivered","per_billed","transaction_date","custom_subscription_refereance"],filters:{},orderBy:"transaction_date desc",pageLength:200,auto:!0}),ee=se({url:"frappe.client.get",makeParams:n=>({doctype:"Sales Order",name:n.name}),onSuccess(n){S.value=n}}),Y=se({url:"my_frappe_app.api.process_order_workflow",auto:!1}),W=se({url:"my_frappe_app.api.get_seller_subscriptions"}),z=se({url:"my_frappe_app.api.process_subscription",onSuccess(n){V.value="",n.status==="success"?(w(n.message,"success"),W.fetch({seller:J.value})):w(n.message||"Operation failed","error")},onError(n){V.value="",w((n==null?void 0:n.message)||"Error","error")}}),J=N(()=>U.filters.seller||""),Q=N(()=>U.filters.customer||""),de=N(()=>{var n;return((n=W.data)==null?void 0:n.subscriptions)||[]}),ge=N(()=>{const n=B.data||[];return T.value?n.filter(g=>{const D=g.transaction_date||"";return!(h.value&&D<h.value||v.value&&D>v.value)}):n}),pe=N(()=>{const n=[];if(c.value==="all"||c.value==="subscription_pending")for(const g of de.value)c.value==="subscription_pending"&&g.status!=="Accept Pending"||n.push(De({row_type:"subscription"},g));if(c.value!=="subscription_pending")for(const g of ge.value){const D=!!g.custom_subscription_refereance;c.value==="daily"&&!D||c.value==="normal"&&D||n.push(De({row_type:"order"},g))}return n}),ae=N(()=>pe.value.filter(n=>n.row_type==="order").length),Ce=N(()=>{const n=de.value,g=B.data||[];return{subPending:n.filter(D=>D.status==="Accept Pending").length,subActive:n.filter(D=>D.status==="Active").length,orderPending:g.filter(D=>D.docstatus===0&&!D.custom_subscription_refereance).length,toDeliver:g.filter(D=>D.docstatus===1&&D.per_delivered<100).length,completed:g.filter(D=>D.per_delivered>=100).length}}),le=N(()=>(B.data||[]).filter(n=>n.docstatus===1&&n.per_delivered>0&&n.per_billed<100)),ye=N(()=>F.value==="salesorder"?W.loading||B.loading:!1);je(()=>[U.filters.customer,U.filters.seller],([n,g])=>{n&&(B.update({filters:{customer:n}}),B.reload()),g&&W.fetch({seller:g})},{immediate:!0});function me(n){return["Completed","To Bill","To Deliver"].includes(n)?"green":n==="Draft"?"red":n==="Cancelled"?"gray":"orange"}function ne(n,g="INR"){return new Intl.NumberFormat("en-IN",{style:"currency",currency:g}).format(n)}function k(n){S.value=null,Z.value=!0,ee.fetch({name:n.name})}function d(n,g){return be(this,null,function*(){H.value=n;try{const D=yield Y.submit({order_id:n,action:g});(D==null?void 0:D.status)==="success"?(w(D.message,"success"),yield B.reload(),Z.value&&ee.fetch({name:n})):w((D==null?void 0:D.message)||"Operation Failed","error")}catch(D){w((D==null?void 0:D.message)||"System Error","error")}finally{H.value=""}})}function p(n,g){V.value=n,z.fetch({sub_name:n,action:g})}function s(n){C.value=C.value===n?null:n}function y(){W.fetch({seller:J.value}),B.reload()}function x(n){w(`Invoice ${n} created successfully!`,"success"),B.reload()}function r(){}return(n,g)=>{var D;return t(),a(L,null,[e("div",yc,[e("div",vc,[e("div",hc,[(t(),a(L,null,q(A,b=>e("button",{key:b.key,onClick:ve=>O.value=b.key,class:$(["flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-bold transition-all whitespace-nowrap",O.value===b.key?"bg-gray-900 text-white shadow-sm":"text-gray-500 hover:text-gray-700"])},[(t(),P(fe(b.icon),{class:"w-4 h-4 flex-shrink-0"})),j(" "+l(b.label),1)],10,_c)),64))]),u(o(oe),{variant:"outline",size:"sm",loading:o(W).loading||o(B).loading,class:"text-sm",onClick:y},{prefix:R(()=>[u(o(K),{class:"w-4 h-4"})]),default:R(()=>[g[10]||(g[10]=j(" Refresh ",-1))]),_:1},8,["loading"])]),O.value==="dashboard"?(t(),a(L,{key:0},[e("div",wc,[u(Ut,{stats:Ce.value,"active-filter":c.value,"onUpdate:activeFilter":g[0]||(g[0]=b=>c.value=b)},null,8,["stats","active-filter"])]),e("div",kc,[e("div",$c,[e("div",Cc,[(t(),a(L,null,q(_,b=>e("button",{key:b.key,onClick:ve=>F.value=b.key,class:$(["relative flex items-center gap-2 px-5 md:px-7 py-3.5 text-sm font-bold transition-all whitespace-nowrap",F.value===b.key?"text-gray-900 bg-gray-50/80":"text-gray-400 hover:text-gray-600 hover:bg-gray-50/40"])},[F.value===b.key?(t(),a("span",Dc)):f("",!0),(t(),P(fe(b.icon),{class:"w-4 h-4 flex-shrink-0"})),j(" "+l(b.label),1)],10,Sc)),64))])]),e("div",Fc,[i.value?(t(),P(fe(i.value.icon),{key:0,class:"w-4 h-4 text-gray-700 flex-shrink-0"})):f("",!0),e("span",jc,l((D=i.value)==null?void 0:D.label),1)]),F.value==="quotation"?(t(),a("div",Pc,[e("div",Tc,[e("button",{onClick:y,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[u(o(K),{class:"w-3.5 h-3.5"}),g[11]||(g[11]=j(" Refresh ",-1))])]),e("div",Oc,[u(o(Xe),{class:"w-10 h-10 text-gray-300"})]),g[12]||(g[12]=e("p",{class:"text-base font-black text-gray-300"},"Quotation",-1)),g[13]||(g[13]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):F.value==="salesorder"?(t(),a(L,{key:1},[e("div",Ac,[e("div",Ic,[e("div",Lc,[e("div",Nc,[u(o(Ke),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Uc,[g[15]||(g[15]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Orders",-1)),e("div",Rc,[e("span",Mc,[c.value==="all"?(t(),a("span",Vc,"All â€” Subscriptions & Orders")):c.value==="subscription_pending"?(t(),a("span",zc,"Subscription Requests")):c.value==="daily"?(t(),a("span",qc,"Daily Auto-Orders")):c.value==="normal"?(t(),a("span",Bc,"Normal Orders")):f("",!0)]),T.value?(t(),a(L,{key:0},[e("span",Ec,l(h.value||"â€¦")+" â†’ "+l(v.value||"â€¦"),1),e("span",Hc,l(ae.value)+" orders",1),e("button",{onClick:E,class:"flex items-center gap-0.5 text-[9px] font-bold text-red-500 hover:text-red-600 whitespace-nowrap"},[u(o(re),{class:"w-3 h-3"}),g[14]||(g[14]=j(" Clear ",-1))])],64)):f("",!0)])])]),e("div",Wc,[e("button",{onClick:r,class:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-colors whitespace-nowrap shadow-sm"},[e("span",Yc,[u(o(ht),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),g[16]||(g[16]=e("span",{class:"hidden sm:inline"},"Create Sales Order",-1)),g[17]||(g[17]=e("span",{class:"sm:hidden"},"New SO",-1))]),le.value.length>0?(t(),a("button",{key:0,onClick:g[1]||(g[1]=b=>M.value=!0),class:"flex items-center gap-2 bg-[#3a9e5f] hover:bg-[#2e8a50] active:bg-[#257342] text-white font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-colors whitespace-nowrap shadow-sm"},[e("span",Qc,[u(o(we),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),g[18]||(g[18]=j(" Create Invoice ",-1)),e("span",Gc,l(le.value.length),1)])):f("",!0),c.value!=="all"?(t(),a("button",{key:1,onClick:g[2]||(g[2]=b=>c.value="all"),class:"flex items-center gap-1 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-gray-600 text-xs font-semibold px-2.5 py-2 rounded-lg transition-all whitespace-nowrap"},[u(o(re),{class:"w-3.5 h-3.5 flex-shrink-0"}),g[19]||(g[19]=j(" Clear ",-1))])):f("",!0),e("button",{onClick:y,class:$(["flex items-center gap-1.5 px-2.5 sm:px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-xs font-semibold text-gray-600 transition-all",ye.value?"opacity-60 pointer-events-none":""])},[u(o(K),{class:$(["w-3.5 h-3.5 flex-shrink-0",ye.value?"animate-spin":""])},null,8,["class"]),g[20]||(g[20]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)])]),e("div",Jc,[e("div",Kc,[g[21]||(g[21]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"From",-1)),ie(e("input",{type:"date","onUpdate:modelValue":g[3]||(g[3]=b=>h.value=b),max:v.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Xc),[[xe,h.value]]),h.value?(t(),a("button",{key:0,onClick:g[4]||(g[4]=G(b=>h.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[u(o(re),{class:"w-3 h-3"})])):f("",!0)]),e("div",Zc,[g[22]||(g[22]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"To",-1)),ie(e("input",{type:"date","onUpdate:modelValue":g[5]||(g[5]=b=>v.value=b),min:h.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,e0),[[xe,v.value]]),v.value?(t(),a("button",{key:0,onClick:g[6]||(g[6]=G(b=>v.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[u(o(re),{class:"w-3 h-3"})])):f("",!0)]),T.value?(t(),a("button",{key:0,onClick:E,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[u(o(re),{class:"w-3 h-3"}),g[23]||(g[23]=j(" Clear Dates ",-1))])):f("",!0),T.value?(t(),a("span",t0,l(ae.value)+" orders ",1)):f("",!0)])]),u(ks,{"combined-rows":pe.value,loading:o(W).loading||o(B).loading,"active-filter":c.value,"expanded-sub-id":C.value,"processing-sub-id":V.value,"processing-id":H.value,"format-currency":ne,"get-status-theme":me,onToggleSubExpand:s,onSubAction:p,onOpenOrderDetail:k,onOrderAction:d,onShowAll:g[7]||(g[7]=b=>c.value="all")},null,8,["combined-rows","loading","active-filter","expanded-sub-id","processing-sub-id","processing-id"])],64)):F.value==="delivery"?(t(),P(oi,{key:2,customer:Q.value,seller:J.value,"format-currency":ne},null,8,["customer","seller"])):F.value==="invoice"?(t(),P(fc,{key:3,customer:Q.value,seller:J.value,"format-currency":ne},null,8,["customer","seller"])):F.value==="payment"?(t(),a("div",s0,[e("div",a0,[e("button",{onClick:y,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[u(o(K),{class:"w-3.5 h-3.5"}),g[24]||(g[24]=j(" Refresh ",-1))])]),e("div",l0,[u(o(ze),{class:"w-10 h-10 text-gray-300"})]),g[25]||(g[25]=e("p",{class:"text-base font-black text-gray-300"},"Payment",-1)),g[26]||(g[26]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):F.value==="customer_ledger"?(t(),a("div",n0,[e("div",o0,[e("button",{onClick:y,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[u(o(K),{class:"w-3.5 h-3.5"}),g[27]||(g[27]=j(" Refresh ",-1))])]),e("div",r0,[u(o(Ze),{class:"w-10 h-10 text-gray-300"})]),g[28]||(g[28]=e("p",{class:"text-base font-black text-gray-300"},"Customer Ledger",-1)),g[29]||(g[29]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):f("",!0)])],64)):f("",!0),O.value==="customers"?(t(),a("div",i0,[u(ul,{seller:J.value},null,8,["seller"])])):f("",!0),u(Zs,{modelValue:Z.value,"onUpdate:modelValue":g[8]||(g[8]=b=>Z.value=b),"order-details":S.value,"processing-id":H.value,"format-currency":ne,"get-status-theme":me,onOrderAction:d},null,8,["modelValue","order-details","processing-id"]),u(Xn,{modelValue:M.value,"onUpdate:modelValue":g[9]||(g[9]=b=>M.value=b),"eligible-orders":le.value,seller:J.value,"format-currency":ne,onInvoiceCreated:x},null,8,["modelValue","eligible-orders","seller"])]),e("nav",d0,[e("div",c0,[(t(),a(L,null,q(A,b=>e("button",{key:b.key,onClick:ve=>O.value=b.key,class:$(["flex-1 flex flex-col items-center justify-center gap-0.5 py-2 px-1 text-[10px] font-bold transition-all active:scale-95",O.value===b.key?"text-gray-900":"text-gray-400"])},[e("div",{class:$(["p-1.5 rounded-xl transition-all",O.value===b.key?"bg-gray-900 text-white":"text-gray-400"])},[(t(),P(fe(b.icon),{class:"w-4 h-4"}))],2),j(" "+l(b.label),1)],10,u0)),64))]),O.value==="dashboard"?(t(),a("div",x0,[(t(),a(L,null,q(_,b=>e("button",{key:b.key,onClick:ve=>F.value=b.key,class:$(["relative flex-shrink-0 flex flex-col items-center justify-center gap-0.5","px-3 py-2 min-w-[58px] text-[9px] font-bold transition-all active:scale-95",F.value===b.key?"text-gray-900":"text-gray-400"])},[F.value===b.key?(t(),a("span",m0)):f("",!0),(t(),P(fe(b.icon),{class:$(["w-[18px] h-[18px] transition-all",F.value===b.key?"text-gray-900":"text-gray-400"])},null,8,["class"])),e("span",g0,l(b.shortLabel),1)],10,p0)),64))])):f("",!0)])],64)}}});export{v0 as default};
