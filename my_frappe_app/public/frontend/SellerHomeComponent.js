var At=Object.defineProperty,Mt=Object.defineProperties;var Lt=Object.getOwnPropertyDescriptors;var ft=Object.getOwnPropertySymbols;var Ut=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable;var vt=(m,B,T)=>B in m?At(m,B,{enumerable:!0,configurable:!0,writable:!0,value:T}):m[B]=T,Ae=(m,B)=>{for(var T in B||(B={}))Ut.call(B,T)&&vt(m,T,B[T]);if(ft)for(var T of ft(B))Ot.call(B,T)&&vt(m,T,B[T]);return m},ht=(m,B)=>Mt(m,Lt(B));var we=(m,B,T)=>new Promise((H,L)=>{var P=x=>{try{d(T.next(x))}catch(N){L(N)}},k=x=>{try{d(T.throw(x))}catch(N){L(N)}},d=x=>x.done?H(x.value):Promise.resolve(x.value).then(P,k);d((T=T.apply(m,B)).next())});import{c as se,d as Ne,o as t,a as s,b as e,n as C,t as a,e as r,u as l,C as Qe,f as ut,_ as xt,g as p,F as q,r as Y,h as j,w as Q,i as le,j as $e,k as D,l as We,m as Ye,p as V,q as ge,s as qt,v as pe,x as me,y as Ct,U as St,z as U,M as Et,A as je,B as Le,X as Fe,D as Dt,E as Ke,T as Me,G as De,H as Ce,I as Pt,J as _t,S as at,K as Vt}from"./index.js";import{N as Ue,C as Ze,T as Oe,P as pt,a as Ft,S as nt,_ as Tt,b as Re,F as qe,D as Nt,R as ue,c as he,d as ze,e as zt,f as kt,g as Bt}from"./truck.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=se("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=se("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=se("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=se("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=se("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=se("circle-arrow-down",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=se("circle-arrow-up",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=se("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=se("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=se("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=se("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=se("indian-rupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=se("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=se("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=se("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=se("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=se("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=se("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=se("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=se("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=se("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=se("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=se("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=se("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=se("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=se("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=se("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=se("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=se("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=se("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ss={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3 md:gap-4"},as={class:"min-w-0"},ls={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-green-100 shadow-sm flex items-center justify-between"},ns={class:"min-w-0"},os={class:"text-2xl sm:text-3xl font-black text-gray-900"},rs={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-green-50 flex items-center justify-center text-green-600 flex-shrink-0 ml-2"},is={class:"min-w-0"},ds={class:"min-w-0"},cs={class:"bg-white p-3 sm:p-4 rounded-2xl sm:rounded-3xl border border-emerald-100 shadow-sm flex items-center justify-between col-span-2 sm:col-span-1"},us={class:"min-w-0"},xs={class:"text-2xl sm:text-3xl font-black text-gray-900"},ps={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl bg-emerald-50 flex items-center justify-center text-emerald-600 flex-shrink-0 ml-2"},ms=Ne({__name:"SellerStatsCards",props:{stats:{},activeFilter:{}},emits:["update:activeFilter"],setup(m,{emit:B}){const T=m,H=B,L=P=>{H("update:activeFilter",T.activeFilter===P?"all":P)};return(P,k)=>(t(),s("div",ss,[e("button",{onClick:k[0]||(k[0]=d=>L("subscription_pending")),class:C(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="subscription_pending"?"bg-amber-500 border-amber-500":"bg-white border-amber-100 hover:border-amber-300"])},[e("div",as,[e("p",{class:C(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="subscription_pending"?"text-amber-100":"text-amber-400"])}," Sub Pending ",2),e("p",{class:C(["text-2xl sm:text-3xl font-black",m.activeFilter==="subscription_pending"?"text-white":"text-gray-900"])},a(m.stats.subPending),3)]),e("div",{class:C(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="subscription_pending"?"bg-amber-400 text-white":"bg-amber-50 text-amber-500 hover:bg-amber-500 hover:text-white"])},[r(l(Ue),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",ls,[e("div",ns,[k[3]||(k[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1 truncate"}," Sub Active ",-1)),e("p",os,a(m.stats.subActive),1)]),e("div",rs,[r(l(Qe),{class:"w-4 h-4 sm:w-5 sm:h-5"})])]),e("button",{onClick:k[1]||(k[1]=d=>L("normal")),class:C(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="normal"?"bg-orange-500 border-orange-500":"bg-white border-orange-100 hover:border-orange-300"])},[e("div",is,[e("p",{class:C(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="normal"?"text-orange-100":"text-orange-400"])}," To Accept ",2),e("p",{class:C(["text-2xl sm:text-3xl font-black",m.activeFilter==="normal"?"text-white":"text-gray-900"])},a(m.stats.orderPending),3)]),e("div",{class:C(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="normal"?"bg-orange-400 text-white":"bg-orange-50 text-orange-500 hover:bg-orange-500 hover:text-white"])},[r(l(Ze),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("button",{onClick:k[2]||(k[2]=d=>L("daily")),class:C(["p-3 sm:p-4 rounded-2xl sm:rounded-3xl border shadow-sm flex items-center justify-between transition-all text-left",m.activeFilter==="daily"?"bg-blue-600 border-blue-600":"bg-white border-blue-100 hover:border-blue-300"])},[e("div",ds,[e("p",{class:C(["text-[9px] sm:text-[10px] font-bold uppercase tracking-widest mb-1 truncate",m.activeFilter==="daily"?"text-blue-200":"text-blue-400"])}," Daily Orders ",2),e("p",{class:C(["text-2xl sm:text-3xl font-black",m.activeFilter==="daily"?"text-white":"text-gray-900"])},a(m.stats.toDeliver),3)]),e("div",{class:C(["h-9 w-9 sm:h-11 sm:w-11 rounded-xl sm:rounded-2xl flex items-center justify-center transition-colors flex-shrink-0 ml-2",m.activeFilter==="daily"?"bg-blue-500 text-white":"bg-blue-50 text-blue-500 hover:bg-blue-600 hover:text-white"])},[r(l(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2)],2),e("div",cs,[e("div",us,[k[4]||(k[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-emerald-500 uppercase tracking-widest mb-1 truncate"}," Completed ",-1)),e("p",xs,a(m.stats.completed),1)]),e("div",ps,[r(l(Qe),{class:"w-4 h-4 sm:w-5 sm:h-5"})])])]))}}),gs={class:"w-full min-w-0"},ys={class:"min-h-[300px] sm:min-h-[400px]"},bs={key:0,class:"flex flex-col items-center justify-center py-20 sm:py-32"},fs={key:1,class:"flex flex-col items-center justify-center py-20 sm:py-32 px-4 text-center"},vs={key:2,class:"divide-y divide-gray-50"},hs={class:"flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2"},_s={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},ks={class:"min-w-0 flex-1"},ws={class:"flex items-center gap-1.5 flex-wrap"},$s={class:"font-black text-gray-900 font-mono text-xs sm:text-sm"},Cs={class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-amber-200"},Ss={class:"text-[10px] sm:text-xs text-gray-500 mt-0.5 flex flex-wrap gap-x-1"},Ds={class:"font-semibold text-gray-700 truncate max-w-[140px] sm:max-w-none"},Ps={class:"text-gray-400 text-[9px] sm:text-[10px]"},Fs={class:"text-[9px] sm:text-[10px] text-gray-400 mt-0.5 truncate"},Ts={class:"font-semibold text-gray-600"},Ns={class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap"},Is={class:"flex items-center gap-1 bg-green-100 border border-green-200 rounded-lg px-2 py-1"},js=["onClick"],Rs={key:0,class:"px-3 sm:px-5 pb-4 pt-0 border-t border-amber-100/80 bg-white/50 space-y-3"},As={key:0,class:"mt-3 flex items-start gap-2 bg-amber-50 border border-amber-200 rounded-xl px-3 py-2.5"},Ms={class:"flex items-center justify-between px-3 sm:px-4 py-2 bg-white border-b border-gray-100"},Ls={class:"text-[11px] sm:text-xs font-bold text-gray-800 truncate mr-2"},Us={key:0,class:"text-[8px] sm:text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded font-bold flex-shrink-0"},Os={class:"p-2 sm:p-3 flex gap-1.5 flex-wrap"},qs={class:"text-[8px] sm:text-[9px] uppercase tracking-wide"},Es={key:0,class:"text-xs sm:text-sm font-black leading-tight mt-0.5"},Vs={key:1,class:"text-[9px] opacity-30 mt-0.5"},zs=["onClick"],Bs={class:"flex items-start sm:items-center gap-2 sm:gap-3 min-w-0 flex-1"},Hs={class:"min-w-0 flex-1"},Ws={class:"flex items-center gap-1.5 flex-wrap"},Ys={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-blue-200"},Gs={key:1,class:"inline-flex items-center gap-1 bg-gray-100 text-gray-500 text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border border-gray-200"},Qs={class:"text-[10px] sm:text-xs text-gray-400 mt-0.5 flex items-center gap-1 flex-wrap"},Js={key:0,class:"truncate max-w-[120px] sm:max-w-none"},Xs={key:0,class:"text-[9px] sm:text-[10px] text-blue-400 font-mono mt-0.5 truncate"},Ks={class:"font-black text-gray-800 font-mono text-xs sm:text-sm whitespace-nowrap"},Zs={key:3,class:"text-[9px] sm:text-[10px] text-blue-500 font-semibold bg-blue-50 border border-blue-100 px-1.5 py-1 rounded-lg whitespace-nowrap"},ea=Ne({__name:"SalesOrder",props:{combinedRows:{},loading:{type:Boolean},activeFilter:{},expandedSubId:{},processingSubId:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["toggle-sub-expand","sub-action","open-order-detail","order-action","show-all"],setup(m,{emit:B}){const T=B,H=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],L={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},P={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(k,d)=>(t(),s("div",gs,[d[21]||(d[21]=ut('<div class="flex flex-wrap gap-1.5 px-3 sm:px-5 pt-3 pb-2 overflow-x-auto [scrollbar-width:none] [&amp;::-webkit-scrollbar]:hidden"><div class="flex items-center gap-1.5 bg-amber-50 border border-amber-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-amber-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-amber-700 whitespace-nowrap">Subscription â€” Accept to start daily delivery</span></div><div class="flex items-center gap-1.5 bg-blue-50 border border-blue-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-blue-400 flex-shrink-0"></div><span class="text-[10px] font-semibold text-blue-700 whitespace-nowrap">Daily Auto-Order â€” DN auto-created</span></div><div class="flex items-center gap-1.5 bg-gray-50 border border-gray-200 rounded-lg px-2.5 py-1 flex-shrink-0"><div class="w-2 h-2 rounded-full bg-gray-300 flex-shrink-0"></div><span class="text-[10px] font-semibold text-gray-500 whitespace-nowrap">Normal Order</span></div></div>',1)),e("div",ys,[m.loading?(t(),s("div",bs,[r(l(xt),{class:"w-7 h-7 sm:w-8 sm:h-8 mb-4 text-blue-600"}),d[2]||(d[2]=e("p",{class:"text-gray-400 font-medium text-sm animate-pulse"},"Loading...",-1))])):m.combinedRows.length===0?(t(),s("div",fs,[r(l(pt),{class:"w-10 h-10 sm:w-12 sm:h-12 text-gray-200 mb-4"}),d[3]||(d[3]=e("p",{class:"text-gray-400 font-medium text-sm"},"Nothing to show",-1)),m.activeFilter!=="all"?(t(),s("button",{key:0,onClick:d[0]||(d[0]=x=>T("show-all")),class:"mt-3 text-sm text-blue-600 hover:underline"}," Show all ")):p("",!0)])):(t(),s("div",vs,[(t(!0),s(q,null,Y(m.combinedRows,x=>{var N,g;return t(),s(q,{key:x.row_type+"-"+x.name},[x.row_type==="subscription"?(t(),s("div",{key:0,class:C(["border-l-4 transition-all",x.status==="Accept Pending"?"border-l-amber-400 bg-amber-50/50":"border-l-green-400 bg-green-50/20"])},[e("div",hs,[e("div",_s,[e("div",{class:C(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 mt-0.5 sm:mt-0",x.status==="Accept Pending"?"bg-amber-100 text-amber-600":"bg-green-100 text-green-600"])},[r(l(Ue),{class:"w-4 h-4 sm:w-5 sm:h-5"})],2),e("div",ks,[e("div",ws,[e("span",$s,a(x.name),1),e("span",Cs,[r(l($t),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),d[4]||(d[4]=j(" Subscription Request ",-1))]),e("span",{class:C(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full border",x.status==="Accept Pending"?"bg-amber-50 text-amber-600 border-amber-200":x.status==="Active"?"bg-green-50 text-green-600 border-green-200":"bg-gray-50 text-gray-500 border-gray-200"])},a(x.status),3)]),e("p",Ss,[d[5]||(d[5]=e("span",null,"Customer:",-1)),e("span",Ds,a(x.customer_name),1),d[6]||(d[6]=e("span",{class:"hidden sm:inline"},"Â·",-1)),e("span",Ps,a(x.formatted_start)+" â†’ "+a(x.formatted_end),1)]),e("p",Fs,[d[7]||(d[7]=j(" Primary: ",-1)),e("span",Ts,a(x.primary_item_name),1)])])]),e("div",Ns,[x.status==="Accept Pending"?(t(),s(q,{key:0},[r(l($e),{variant:"solid",class:"!bg-green-600 hover:!bg-green-700 !text-white text-xs",size:"sm",loading:m.processingSubId===x.name,onClick:le(v=>T("sub-action",x.name,"accept"),["stop"])},{prefix:Q(()=>[r(l(Qe),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:Q(()=>[d[8]||(d[8]=e("span",{class:"hidden sm:inline"},"Accept Plan",-1)),d[9]||(d[9]=e("span",{class:"sm:hidden"},"Accept",-1))]),_:1},8,["loading","onClick"]),r(l($e),{variant:"subtle",theme:"red",size:"sm",loading:m.processingSubId===x.name,class:"text-xs",onClick:le(v=>T("sub-action",x.name,"reject"),["stop"])},{default:Q(()=>[...d[10]||(d[10]=[j("Reject",-1)])]),_:1},8,["loading","onClick"])],64)):x.status==="Active"?(t(),s(q,{key:1},[e("div",Is,[r(l(ct),{class:"w-3 h-3 text-green-600 flex-shrink-0"}),d[11]||(d[11]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-green-700"},"Auto-running",-1))]),r(l($e),{variant:"subtle",theme:"red",size:"sm",loading:m.processingSubId===x.name,class:"text-xs",onClick:le(v=>T("sub-action",x.name,"reject"),["stop"])},{default:Q(()=>[...d[12]||(d[12]=[e("span",{class:"hidden sm:inline"},"Cancel Plan",-1),e("span",{class:"sm:hidden"},"Cancel",-1)])]),_:1},8,["loading","onClick"])],64)):p("",!0),e("button",{onClick:v=>T("toggle-sub-expand",x.name),class:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all flex-shrink-0"},[m.expandedSubId===x.name?(t(),D(l(Ft),{key:0,class:"w-4 h-4"})):(t(),D(l(We),{key:1,class:"w-4 h-4"}))],8,js)])]),m.expandedSubId===x.name?(t(),s("div",Rs,[x.status==="Accept Pending"?(t(),s("div",As,[r(l($t),{class:"w-3.5 h-3.5 text-amber-500 mt-0.5 flex-shrink-0"}),d[13]||(d[13]=e("p",{class:"text-[10px] sm:text-xs text-amber-800"},[e("span",{class:"font-bold"},"Accept this plan"),j(" to activate daily delivery. From "),e("strong",null,"next day"),j(", system auto-generates Sales Orders + Delivery Notes. You only handle "),e("strong",null,"invoicing"),j(". ")],-1))])):p("",!0),(t(!0),s(q,null,Y(x.schedule_items,v=>(t(),s("div",{key:v.item_code,class:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden"},[e("div",Ms,[e("span",Ls,a(v.item_name),1),v.is_primary_item?(t(),s("span",Us,"Primary")):p("",!0)]),e("div",Os,[(t(),s(q,null,Y(H,A=>e("div",{key:A,class:C(["flex flex-col items-center px-2 sm:px-3 py-1.5 rounded-xl font-bold min-w-[34px] sm:min-w-[44px] text-center",(v[P[A]]||0)>0?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-400"])},[e("span",qs,a(L[A]),1),(v[P[A]]||0)>0?(t(),s("span",Es,a(v[P[A]]),1)):(t(),s("span",Vs,"â€”"))],2)),64))])]))),128))])):p("",!0)],2)):(t(),s("div",{key:1,class:C(["flex flex-col sm:flex-row sm:items-center justify-between px-3 sm:px-5 py-3 gap-2 cursor-pointer group transition-all border-l-4",x.custom_subscription_refereance?"border-l-blue-300 bg-blue-50/20 hover:bg-blue-50/50 active:bg-blue-50/70":"border-l-transparent hover:bg-gray-50/70 active:bg-gray-100/50"]),onClick:v=>T("open-order-detail",x)},[e("div",Bs,[e("div",{class:C(["p-2 sm:p-2.5 rounded-xl flex-shrink-0 transition-colors mt-0.5 sm:mt-0",x.custom_subscription_refereance?"bg-blue-100 text-blue-600 group-hover:bg-blue-500 group-hover:text-white":"bg-gray-100 text-gray-500 group-hover:bg-blue-100 group-hover:text-blue-600"])},[x.custom_subscription_refereance?(t(),D(l(Ue),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),D(l(nt),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",Hs,[e("div",Ws,[e("span",{class:C(["font-bold font-mono text-xs sm:text-sm transition-colors",x.custom_subscription_refereance?"text-blue-700":"text-gray-900 group-hover:text-blue-600"])},a(x.name),3),x.custom_subscription_refereance?(t(),s("span",Ys,[r(l(ct),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),d[14]||(d[14]=e("span",{class:"hidden xs:inline"},"Daily Sub-Auto-Order",-1)),d[15]||(d[15]=e("span",{class:"xs:hidden"},"Sub",-1))])):(t(),s("span",Gs,[r(l(nt),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),d[16]||(d[16]=e("span",{class:"hidden xs:inline"},"Normal Order",-1)),d[17]||(d[17]=e("span",{class:"xs:hidden"},"Normal",-1))])),r(l(Tt),{theme:m.getStatusTheme(x.status),variant:"subtle",label:x.status,size:"sm"},null,8,["theme","label"])]),e("p",Qs,[r(l(Re),{class:"w-3 h-3 flex-shrink-0"}),e("span",null,a(x.transaction_date),1),x.customer_name?(t(),s("span",Js,"Â· "+a(x.customer_name),1)):p("",!0)]),x.custom_subscription_refereance?(t(),s("p",Xs," ðŸ“‹ "+a(x.custom_subscription_refereance),1)):p("",!0)])]),e("div",{class:"flex items-center gap-1.5 flex-shrink-0 pl-9 sm:pl-0 flex-wrap sm:flex-nowrap",onClick:d[1]||(d[1]=le(()=>{},["stop"]))},[e("span",Ks,a(m.formatCurrency(x.grand_total,x.currency)),1),x.docstatus===0?(t(),D(l($e),{key:0,variant:"solid",theme:"blue",size:"sm",loading:m.processingId===x.name,onClick:v=>T("order-action",x.name,"accept"),class:"text-xs"},{default:Q(()=>[...d[18]||(d[18]=[j("Accept",-1)])]),_:1},8,["loading","onClick"])):p("",!0),x.docstatus===1&&x.per_delivered<100&&!x.custom_subscription_refereance?(t(),D(l($e),{key:1,variant:"subtle",theme:"gray",size:"sm",loading:m.processingId===x.name,onClick:v=>T("order-action",x.name,"deliver"),class:"text-xs"},{prefix:Q(()=>[r(l(Oe),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:Q(()=>[d[19]||(d[19]=e("span",{class:"hidden sm:inline"},"Deliver",-1))]),_:1},8,["loading","onClick"])):p("",!0),x.docstatus===1&&Number((N=x.per_delivered)!=null?N:0)>=100&&Number((g=x.per_billed)!=null?g:100)<100?(t(),D(l($e),{key:2,variant:"subtle",theme:"gray",size:"sm",loading:m.processingId===x.name,onClick:v=>T("order-action",x.name,"invoice"),class:"text-xs"},{prefix:Q(()=>[r(l(qe),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),default:Q(()=>[d[20]||(d[20]=e("span",{class:"hidden sm:inline"},"Invoice",-1))]),_:1},8,["loading","onClick"])):p("",!0),x.custom_subscription_refereance&&x.docstatus===1&&x.per_delivered<100?(t(),s("span",Zs," âš¡ Auto-Delivered ")):p("",!0),r(l(Ye),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-300 ml-1 flex-shrink-0"})])],10,zs))],64)}),128))]))])]))}}),ta={class:"flex items-center justify-between w-full pr-6 sm:pr-8 gap-2 flex-wrap"},sa={class:"flex items-center gap-2 sm:gap-3 min-w-0"},aa={class:"min-w-0"},la={class:"text-xs sm:text-sm text-gray-500 font-mono mt-1 truncate"},na={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},oa={key:0,class:"inline-flex items-center gap-1 bg-blue-100 text-blue-700 text-[10px] sm:text-xs font-bold px-2 sm:px-3 py-1 rounded-full truncate max-w-[140px] sm:max-w-none"},ra={class:"truncate"},ia={key:0,class:"flex flex-col items-center justify-center h-48 sm:h-80"},da={key:1,class:"py-4 sm:py-6 space-y-5 sm:space-y-8"},ca={key:0,class:"flex items-start gap-2 sm:gap-3 bg-blue-50 border border-blue-200 rounded-xl sm:rounded-2xl p-3 sm:p-4"},ua={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-5"},xa={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},pa={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},ma={class:"min-w-0"},ga={class:"font-bold text-sm sm:text-base truncate"},ya={class:"bg-gray-50 p-3 sm:p-5 rounded-xl sm:rounded-2xl border border-gray-100 flex items-start gap-2 sm:gap-3"},ba={class:"bg-white p-1.5 sm:p-2 rounded-lg shadow-sm text-gray-500 flex-shrink-0"},fa={class:"font-bold text-sm sm:text-base"},va={class:"bg-blue-600 p-3 sm:p-5 rounded-xl sm:rounded-2xl text-white"},ha={class:"font-black text-xl sm:text-2xl"},_a={class:"border border-gray-200 rounded-xl overflow-hidden"},ka={class:"overflow-x-auto"},wa={class:"w-full text-xs sm:text-sm min-w-[400px]"},$a={class:"divide-y divide-gray-100"},Ca={class:"px-3 sm:px-5 py-3 sm:py-4 font-bold text-gray-900"},Sa={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Da={class:"px-3 sm:px-5 py-3 sm:py-4 text-right tabular-nums"},Pa={class:"px-3 sm:px-5 py-3 sm:py-4 text-right font-bold tabular-nums"},Fa={class:"flex flex-col xs:flex-row justify-end gap-2 sm:gap-3 pt-4 sm:pt-6 border-t border-gray-100"},Ta=Ne({__name:"SellerOrderDetailDialog",props:{modelValue:{type:Boolean},orderDetails:{},processingId:{},formatCurrency:{type:Function},getStatusTheme:{type:Function}},emits:["update:modelValue","order-action"],setup(m,{emit:B}){const T=m,H=B,L=V({get:()=>T.modelValue,set:P=>H("update:modelValue",P)});return(P,k)=>(t(),D(l(Nt),{modelValue:L.value,"onUpdate:modelValue":k[3]||(k[3]=d=>L.value=d),options:{size:"4xl"}},{"body-title":Q(()=>{var d,x,N,g;return[e("div",ta,[e("div",sa,[e("div",{class:C(["h-8 w-8 sm:h-10 sm:w-10 rounded-full flex items-center justify-center flex-shrink-0",(d=m.orderDetails)!=null&&d.custom_subscription_refereance?"bg-blue-50 text-blue-600":"bg-gray-50 text-gray-600"])},[(x=m.orderDetails)!=null&&x.custom_subscription_refereance?(t(),D(l(Ue),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5"})):(t(),D(l(pt),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5"}))],2),e("div",aa,[k[4]||(k[4]=e("h3",{class:"text-base sm:text-xl font-black leading-none"},"Order Details",-1)),e("p",la,a((N=m.orderDetails)==null?void 0:N.name),1)])]),e("div",na,[(g=m.orderDetails)!=null&&g.custom_subscription_refereance?(t(),s("span",oa,[r(l(Ue),{class:"w-3 h-3 flex-shrink-0"}),e("span",ra,a(m.orderDetails.custom_subscription_refereance),1)])):p("",!0),m.orderDetails?(t(),D(l(Tt),{key:1,theme:m.getStatusTheme(m.orderDetails.status),size:"lg",label:m.orderDetails.status},null,8,["theme","label"])):p("",!0)])])]}),"body-content":Q(()=>[m.orderDetails?(t(),s("div",da,[m.orderDetails.custom_subscription_refereance&&m.orderDetails.docstatus===1?(t(),s("div",ca,[r(l(ct),{class:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 mt-0.5 flex-shrink-0"}),k[5]||(k[5]=e("p",{class:"text-[10px] sm:text-xs text-blue-700"},[e("span",{class:"font-bold"},"Daily Subscription Order."),j(" Auto-generated by cron. Delivery note created automatically. Only invoice needed manually. ")],-1))])):p("",!0),e("div",ua,[e("div",xa,[e("div",pa,[r(l(dt),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",ma,[k[6]||(k[6]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Customer",-1)),e("p",ga,a(m.orderDetails.customer_name),1)])]),e("div",ya,[e("div",ba,[r(l(Re),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),e("div",null,[k[7]||(k[7]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Date",-1)),e("p",fa,a(m.orderDetails.transaction_date),1)])]),e("div",va,[k[8]||(k[8]=e("p",{class:"text-[10px] sm:text-[11px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Grand Total",-1)),e("p",ha,a(m.formatCurrency(m.orderDetails.grand_total,m.orderDetails.currency)),1)])]),e("div",_a,[e("div",ka,[e("table",wa,[k[9]||(k[9]=e("thead",{class:"bg-gray-50 text-[9px] sm:text-[10px] uppercase font-bold text-gray-500"},[e("tr",null,[e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-left"},"Item"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Qty"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Rate"),e("th",{class:"px-3 sm:px-5 py-3 sm:py-4 text-right"},"Amount")])],-1)),e("tbody",$a,[(t(!0),s(q,null,Y(m.orderDetails.items,d=>(t(),s("tr",{key:d.name},[e("td",Ca,a(d.item_name),1),e("td",Sa,a(d.qty),1),e("td",Da,a(m.formatCurrency(d.rate,m.orderDetails.currency)),1),e("td",Pa,a(m.formatCurrency(d.amount,m.orderDetails.currency)),1)]))),128))])])])]),e("div",Fa,[m.orderDetails.docstatus===0?(t(),D(l($e),{key:0,variant:"solid",theme:"blue",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:k[0]||(k[0]=d=>H("order-action",m.orderDetails.name,"accept"))},{default:Q(()=>[...k[10]||(k[10]=[j("Accept Order",-1)])]),_:1},8,["loading"])):p("",!0),m.orderDetails.docstatus===1&&m.orderDetails.per_delivered<100&&!m.orderDetails.custom_subscription_refereance?(t(),D(l($e),{key:1,variant:"solid",theme:"gray",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:k[1]||(k[1]=d=>H("order-action",m.orderDetails.name,"deliver"))},{prefix:Q(()=>[r(l(Oe),{class:"w-4 h-4"})]),default:Q(()=>[k[11]||(k[11]=j(" Generate Delivery Note ",-1))]),_:1},8,["loading"])):p("",!0),m.orderDetails.per_delivered>=100&&m.orderDetails.per_billed<100?(t(),D(l($e),{key:2,variant:"solid",theme:"gray",size:"xl",loading:m.processingId===m.orderDetails.name,class:"w-full xs:w-auto",onClick:k[2]||(k[2]=d=>H("order-action",m.orderDetails.name,"invoice"))},{prefix:Q(()=>[r(l(qe),{class:"w-4 h-4"})]),default:Q(()=>[k[12]||(k[12]=j(" Generate Invoice ",-1))]),_:1},8,["loading"])):p("",!0)])])):(t(),s("div",ia,[r(l(xt),{class:"w-8 h-8 sm:w-10 sm:h-10 text-blue-500"})]))]),_:1},8,["modelValue"]))}}),Na={class:"space-y-4 sm:space-y-5"},Ia={class:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 md:gap-4"},ja={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-gray-100 shadow-sm"},Ra={class:"text-2xl sm:text-3xl font-black text-gray-900"},Aa={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-green-100 shadow-sm"},Ma={class:"text-2xl sm:text-3xl font-black text-gray-900"},La={class:"bg-white p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-blue-100 shadow-sm"},Ua={class:"text-2xl sm:text-3xl font-black text-gray-900"},Oa={class:"bg-blue-600 p-3 sm:p-4 rounded-xl sm:rounded-2xl shadow-sm"},qa={class:"text-xl sm:text-2xl font-black text-white"},Ea={class:"flex flex-col sm:flex-row gap-2 sm:gap-3"},Va={class:"relative flex-1"},za={class:"flex gap-2 sm:gap-3"},Ba=["value"],Ha={key:0,class:"flex justify-center py-16 sm:py-20"},Wa={key:1,class:"bg-gray-50 rounded-2xl sm:rounded-3xl border-2 border-dashed border-gray-200 py-16 sm:py-24 text-center px-4"},Ya={class:"text-xs sm:text-sm text-gray-400 mt-1"},Ga={key:2,class:"space-y-2 sm:space-y-3"},Qa=["onClick"],Ja={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},Xa={class:"h-9 w-9 sm:h-11 sm:w-11 rounded-lg sm:rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 text-white flex items-center justify-center font-black text-base sm:text-lg flex-shrink-0 shadow-sm"},Ka={class:"min-w-0 flex-1"},Za={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},el={class:"font-bold text-gray-900 text-xs sm:text-sm"},tl={class:"font-mono text-[9px] sm:text-[10px] text-gray-400 hidden xs:inline"},sl={key:0,class:"inline-flex items-center gap-1 bg-green-100 text-green-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-green-200"},al={key:1,class:"inline-flex items-center gap-1 bg-amber-100 text-amber-700 text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border border-amber-200"},ll={class:"flex items-center gap-2 sm:gap-3 mt-0.5 flex-wrap"},nl={key:0,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},ol={class:"truncate max-w-[110px] sm:max-w-none"},rl={key:1,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},il={key:2,class:"flex items-center gap-1 text-[9px] sm:text-[10px] text-gray-400"},dl={class:"flex items-center gap-3 sm:gap-4 flex-shrink-0"},cl={class:"text-right hidden md:block"},ul={class:"font-black text-gray-900"},xl={class:"text-right hidden md:block"},pl={class:"font-black text-gray-900 text-sm"},ml={key:0,class:"border-t border-gray-100 px-3 sm:px-4 pb-4 sm:pb-5 pt-3 sm:pt-4 space-y-3 sm:space-y-4 bg-gray-50/30"},gl={class:"flex gap-3 md:hidden"},yl={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},bl={class:"font-black text-gray-900 text-sm sm:text-base"},fl={class:"bg-white rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-gray-100 flex-1 text-center"},vl={class:"font-black text-gray-900 text-xs sm:text-sm"},hl={key:0},_l={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},kl={class:"space-y-2"},wl={class:"flex flex-col xs:flex-row xs:items-center justify-between gap-1 mb-2"},$l={class:"flex items-center gap-1.5 sm:gap-2 flex-wrap"},Cl={class:"font-mono text-[10px] sm:text-xs font-bold text-gray-700"},Sl={class:"text-[9px] sm:text-[10px] text-gray-400 whitespace-nowrap"},Dl={class:"text-[9px] sm:text-[10px] text-gray-500 font-semibold mb-1"},Pl={class:"flex gap-1 flex-wrap"},Fl={key:0,class:"opacity-80 text-[7px] sm:text-[8px]"},Tl={key:1,class:"text-center py-3 sm:py-4 text-[10px] sm:text-xs text-gray-400 bg-white rounded-lg sm:rounded-xl border border-dashed border-gray-200"},Nl={key:2},Il={class:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1.5"},jl={class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 overflow-hidden"},Rl={class:"overflow-x-auto"},Al={class:"w-full text-xs min-w-[360px]"},Ml={class:"divide-y divide-gray-50"},Ll={class:"px-2.5 sm:px-3 py-2 font-mono font-bold text-gray-700 text-[10px] sm:text-xs"},Ul={key:0,class:"ml-1 text-[8px] bg-blue-100 text-blue-600 px-1 py-0.5 rounded font-bold"},Ol={class:"px-2.5 sm:px-3 py-2 text-gray-500 text-[10px] sm:text-xs"},ql={class:"px-2.5 sm:px-3 py-2"},El={class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-800 text-[10px] sm:text-xs tabular-nums"},Vl=Ne({__name:"SellerCustomersTab",props:{seller:{}},setup(m){const B=m,T=U(""),H=U(null),L=U(""),P=ge({url:"my_frappe_app.api.get_seller_customers",onSuccess(){}});qt(()=>{B.seller&&P.fetch({seller:B.seller})});const k=V(()=>{var b;return((b=P.data)==null?void 0:b.customers)||[]}),d=V(()=>{var b;return((b=P.data)==null?void 0:b.pincodes)||[]}),x=V(()=>{let b=k.value;if(L.value&&(b=b.filter(I=>I.pincode===L.value)),T.value.trim()){const I=T.value.toLowerCase();b=b.filter(S=>{var oe,ye,z,E;return((oe=S.customer_name)==null?void 0:oe.toLowerCase().includes(I))||((ye=S.name)==null?void 0:ye.toLowerCase().includes(I))||((z=S.email)==null?void 0:z.toLowerCase().includes(I))||((E=S.mobile)==null?void 0:E.toLowerCase().includes(I))})}return b}),N=V(()=>{const b=k.value;return{total:b.length,withActiveSub:b.filter(I=>I.active_subs>0).length,totalOrders:b.reduce((I,S)=>I+(S.total_orders||0),0),totalRevenue:b.reduce((I,S)=>I+(S.total_revenue||0),0)}}),g=b=>{H.value=H.value===b?null:b},v=b=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(b),A={Active:"bg-green-100 text-green-700 border-green-200","Accept Pending":"bg-amber-100 text-amber-700 border-amber-200",Expired:"bg-gray-100 text-gray-500 border-gray-200",Cancelled:"bg-red-100 text-red-600 border-red-200"},ae=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],J={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},W={Monday:"monday_qty",Tuesday:"tuesday_qty",Wednesday:"wednesday_qty",Thursday:"thursday_qty",Friday:"friday_qty",Saturday:"saturday_qty",Sunday:"sunday_qty"};return(b,I)=>(t(),s("div",Na,[e("div",Ia,[e("div",ja,[I[3]||(I[3]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1"},"Total Customers",-1)),e("p",Ra,a(N.value.total),1)]),e("div",Aa,[I[4]||(I[4]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-green-500 uppercase tracking-widest mb-1"},"With Active Plan",-1)),e("p",Ma,a(N.value.withActiveSub),1)]),e("div",La,[I[5]||(I[5]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-500 uppercase tracking-widest mb-1"},"Total Orders",-1)),e("p",Ua,a(N.value.totalOrders),1)]),e("div",Oa,[I[6]||(I[6]=e("p",{class:"text-[9px] sm:text-[10px] font-bold text-blue-200 uppercase tracking-widest mb-1"},"Total Revenue",-1)),e("p",qa,a(v(N.value.totalRevenue)),1)])]),e("div",Ea,[e("div",Va,[r(l(He),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),pe(e("input",{"onUpdate:modelValue":I[0]||(I[0]=S=>T.value=S),type:"text",placeholder:"Search by name, email, mobile...",class:"w-full pl-9 pr-4 py-2.5 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[me,T.value]])]),e("div",za,[pe(e("select",{"onUpdate:modelValue":I[1]||(I[1]=S=>L.value=S),class:"flex-1 sm:flex-none border border-gray-200 rounded-xl px-3 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"},[I[7]||(I[7]=e("option",{value:""},"All Pincodes",-1)),(t(!0),s(q,null,Y(d.value,S=>(t(),s("option",{key:S,value:S},a(S),9,Ba))),128))],512),[[Ct,L.value]]),r(l($e),{variant:"outline",loading:l(P).loading,class:"text-xs sm:text-sm flex-shrink-0",onClick:I[2]||(I[2]=S=>l(P).fetch({seller:B.seller}))},{prefix:Q(()=>[r(l(ue),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:Q(()=>[I[8]||(I[8]=e("span",{class:"hidden sm:inline"},"Refresh",-1))]),_:1},8,["loading"])])]),l(P).loading?(t(),s("div",Ha,[r(l(xt),{class:"w-7 h-7 sm:w-8 sm:h-8 text-blue-600"})])):x.value.length===0?(t(),s("div",Wa,[r(l(St),{class:"w-9 h-9 sm:w-10 sm:h-10 text-gray-300 mx-auto mb-3"}),I[9]||(I[9]=e("h3",{class:"text-sm sm:text-base font-bold text-gray-700"},"No Customers Found",-1)),e("p",Ya,a(T.value||L.value?"Try different filters":"No customers in your area yet"),1)])):(t(),s("div",Ga,[(t(!0),s(q,null,Y(x.value,S=>{var oe,ye,z,E;return t(),s("div",{key:S.name,class:"bg-white rounded-xl sm:rounded-2xl border border-gray-100 overflow-hidden hover:shadow-md transition-shadow"},[e("div",{class:"flex items-center justify-between p-3 sm:p-4 gap-2 sm:gap-3 cursor-pointer",onClick:X=>g(S.name)},[e("div",Ja,[e("div",Xa,a(((ye=(oe=S.customer_name)==null?void 0:oe[0])==null?void 0:ye.toUpperCase())||"?"),1),e("div",Ka,[e("div",Za,[e("span",el,a(S.customer_name),1),e("span",tl,a(S.name),1),S.active_subs>0?(t(),s("span",sl,[r(l(Qe),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),j(" "+a(S.active_subs)+" Active ",1)])):S.pending_subs>0?(t(),s("span",al,[r(l(Ze),{class:"w-2 h-2 sm:w-2.5 sm:h-2.5"}),j(" "+a(S.pending_subs)+" Pending ",1)])):p("",!0)]),e("div",ll,[S.email?(t(),s("span",nl,[r(l(Xe),{class:"w-3 h-3 flex-shrink-0"}),e("span",ol,a(S.email),1)])):p("",!0),S.mobile?(t(),s("span",rl,[r(l(Xt),{class:"w-3 h-3 flex-shrink-0"}),j(" "+a(S.mobile),1)])):p("",!0),S.pincode?(t(),s("span",il,[r(l(Et),{class:"w-3 h-3 flex-shrink-0"}),j(" "+a(S.pincode),1)])):p("",!0)])])]),e("div",dl,[e("div",cl,[I[10]||(I[10]=e("p",{class:"text-xs text-gray-400 font-medium"},"Orders",-1)),e("p",ul,a(S.total_orders||0),1)]),e("div",xl,[I[11]||(I[11]=e("p",{class:"text-xs text-gray-400 font-medium"},"Revenue",-1)),e("p",pl,a(v(S.total_revenue||0)),1)]),H.value===S.name?(t(),D(l(Ft),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"})):(t(),D(l(We),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"}))])],8,Qa),H.value===S.name?(t(),s("div",ml,[e("div",gl,[e("div",yl,[I[12]||(I[12]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Orders",-1)),e("p",bl,a(S.total_orders||0),1)]),e("div",fl,[I[13]||(I[13]=e("p",{class:"text-[9px] sm:text-[10px] text-gray-400"},"Revenue",-1)),e("p",vl,a(v(S.total_revenue||0)),1)])]),((z=S.subscriptions)==null?void 0:z.length)>0?(t(),s("div",hl,[e("h4",_l,[r(l(Ue),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),I[14]||(I[14]=j(" Subscription Plans ",-1))]),e("div",kl,[(t(!0),s(q,null,Y(S.subscriptions,X=>(t(),s("div",{key:X.name,class:"bg-white rounded-lg sm:rounded-xl border border-gray-100 p-2.5 sm:p-3"},[e("div",wl,[e("div",$l,[e("span",Cl,a(X.name),1),e("span",{class:C(["text-[8px] sm:text-[9px] font-bold px-1.5 sm:px-2 py-0.5 rounded-full border",A[X.status]||"bg-gray-100 text-gray-500 border-gray-200"])},a(X.status),3)]),e("span",Sl,a(X.formatted_start)+" â†’ "+a(X.formatted_end),1)]),(t(!0),s(q,null,Y(X.schedule_items,Z=>(t(),s("div",{key:Z.item_code,class:"mt-2"},[e("p",Dl,a(Z.item_name),1),e("div",Pl,[(t(),s(q,null,Y(ae,te=>e("div",{key:te,class:C(["flex flex-col items-center px-1.5 sm:px-2 py-1 rounded-lg text-[8px] sm:text-[9px] font-bold min-w-[28px] sm:min-w-[32px] text-center",(Z[W[te]]||0)>0?"bg-blue-600 text-white":"bg-gray-100 text-gray-400"])},[e("span",null,a(J[te]),1),(Z[W[te]]||0)>0?(t(),s("span",Fl," Ã—"+a(Z[W[te]]),1)):p("",!0)],2)),64))])]))),128))]))),128))])])):(t(),s("div",Tl,[r(l(Ue),{class:"w-5 h-5 sm:w-6 sm:h-6 text-gray-200 mx-auto mb-1"}),I[15]||(I[15]=j(" No subscription plans yet ",-1))])),((E=S.recent_orders)==null?void 0:E.length)>0?(t(),s("div",Nl,[e("h4",Il,[r(l(nt),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),I[16]||(I[16]=j(" Recent Orders (last 5) ",-1))]),e("div",jl,[e("div",Rl,[e("table",Al,[I[17]||(I[17]=e("thead",{class:"bg-gray-50 border-b border-gray-100"},[e("tr",null,[e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Order"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Date"),e("th",{class:"px-2.5 sm:px-3 py-2 text-left font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Status"),e("th",{class:"px-2.5 sm:px-3 py-2 text-right font-bold text-gray-500 uppercase text-[9px] sm:text-xs"},"Amount")])],-1)),e("tbody",Ml,[(t(!0),s(q,null,Y(S.recent_orders,X=>(t(),s("tr",{key:X.name},[e("td",Ll,[j(a(X.name)+" ",1),X.custom_subscription_refereance?(t(),s("span",Ul,"SUB")):p("",!0)]),e("td",Ol,a(X.transaction_date),1),e("td",ql,[e("span",{class:C(["text-[8px] sm:text-[9px] font-bold px-1.5 py-0.5 rounded-full",X.docstatus===2?"bg-red-100 text-red-600":X.status==="Completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"])},a(X.status),3)]),e("td",El,a(v(X.grand_total)),1)]))),128))])])])])])):p("",!0)])):p("",!0)])}),128))]))]))}}),zl={class:"flex items-center gap-2 sm:gap-3"},Bl={class:"p-2 sm:p-2.5 bg-emerald-600 rounded-lg sm:rounded-xl text-white shadow-md flex-shrink-0"},Hl={class:"space-y-3"},Wl={key:0,class:"flex items-start gap-3 bg-red-50 border border-red-200 rounded-xl px-4 py-3 shadow-sm"},Yl={class:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0 mt-0.5"},Gl={class:"flex-1 min-w-0"},Ql={class:"text-xs text-red-600 mt-0.5 leading-relaxed"},Jl={key:1,class:"flex items-start gap-3 bg-amber-50 border border-amber-200 rounded-xl px-4 py-3 shadow-sm"},Xl={class:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0 mt-0.5"},Kl={class:"flex-1 min-w-0"},Zl={class:"text-[10px] text-amber-600 mt-0.5 font-mono break-all"},en={class:"filter-card"},tn={class:"filter-header"},sn={class:"filter-title-group"},an={class:"filter-icon-wrap"},ln={key:0,class:"filter-active-badge"},nn=["disabled"],on={class:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 mt-3"},rn={class:"filter-field"},dn=["max"],cn={class:"filter-field"},un=["min","max"],xn={class:"filter-field"},pn={value:""},mn=["value"],gn={class:"filter-pills-row"},yn={class:"pill pill-date"},bn={class:"pill-text"},fn={class:"pill-text"},vn={key:0,class:"pill pill-customer"},hn={class:"pill-text truncate max-w-[110px]"},_n={class:"pill pill-count ml-auto"},kn={class:"pill-count-num"},wn={class:"summary-table-wrapper border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},$n={class:"flex items-center gap-3 px-4 py-3.5 bg-gradient-to-r from-emerald-700 to-emerald-600 flex-shrink-0"},Cn={key:1,class:"flex items-center gap-1.5 bg-white/20 border border-white/20 rounded-full px-3 py-1 flex-shrink-0"},Sn={class:"text-[11px] font-black text-white"},Dn={key:0,class:"flex flex-col items-center justify-center gap-2 py-10 bg-white"},Pn={class:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center"},Fn={key:1,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},Tn={key:2,class:"flex flex-col items-center justify-center gap-2 py-8 bg-white"},Nn={class:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center"},In={key:3,class:"summary-scroll-area"},jn={class:"summary-table"},Rn=["title"],An=["title"],Mn={key:0,class:"cell-value"},Ln={key:1,class:"cell-empty"},Un={class:"col-total td-total-cell"},On={class:"total-amt"},qn={class:"total-qty"},En={class:"footer-row"},Vn={class:"col-total td-foot-amount"},zn={class:"border border-gray-200 rounded-2xl overflow-hidden shadow-sm"},Bn={class:"flex items-center gap-2.5 px-4 py-3 bg-gradient-to-r from-gray-700 to-gray-600"},Hn={key:0,class:"w-2.5 h-2.5 text-white",viewBox:"0 0 12 12",fill:"none"},Wn={key:1,class:"w-2 h-0.5 bg-white rounded-full"},Yn={class:"text-[10px] font-bold text-white whitespace-nowrap"},Gn={key:0,class:"flex flex-col items-center justify-center py-10 text-center bg-white px-4"},Qn={class:"w-12 h-12 rounded-2xl bg-gray-100 flex items-center justify-center mb-3"},Jn={key:1,class:"divide-y divide-gray-50 max-h-52 overflow-y-auto bg-white orders-scroll"},Xn=["onClick"],Kn={class:"hidden sm:grid items-center gap-2 px-4 py-3",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},Zn={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},eo={class:"text-[10px] text-gray-400 font-mono font-bold"},to={class:"min-w-0"},so={class:"flex items-center gap-1.5 flex-wrap"},ao={class:"font-bold font-mono text-[11px] text-gray-800 truncate"},lo={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold"},no={class:"text-[10px] text-gray-400 mt-0.5 truncate"},oo={class:"min-w-0"},ro={class:"font-mono text-[10px] text-gray-500 truncate block"},io={class:"text-right"},co={class:"text-[10px] font-bold text-emerald-700 bg-emerald-50 px-1.5 py-0.5 rounded-lg border border-emerald-100"},uo={class:"text-right"},xo={class:"text-[10px] font-bold text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded-lg border border-orange-100"},po={class:"font-black text-gray-800 font-mono text-xs text-right tabular-nums block"},mo={class:"flex sm:hidden items-center gap-3 px-4 py-3"},go={key:0,class:"w-3 h-3 text-white check-icon",viewBox:"0 0 12 12",fill:"none"},yo={class:"flex-1 min-w-0"},bo={class:"flex items-center gap-1"},fo={class:"font-bold font-mono text-[10px] text-gray-800 truncate"},vo={key:0,class:"text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},ho={class:"flex items-center gap-2 mt-0.5"},_o={class:"text-[9px] text-gray-400 truncate flex-1"},ko={class:"text-[9px] font-bold text-emerald-700 bg-emerald-50 px-1 py-0.5 rounded flex-shrink-0"},wo={class:"font-black text-gray-800 font-mono text-[11px] text-right tabular-nums flex-shrink-0"},$o={class:"flex flex-col xs:flex-row items-start xs:items-center w-full gap-3"},Co={class:"flex items-center gap-2 sm:gap-3 min-w-0"},So={class:"text-[10px] sm:text-xs text-gray-500 font-semibold whitespace-nowrap"},Do={class:"font-black text-gray-900 text-sm sm:text-base"},Po={class:"flex items-center gap-2 sm:gap-3 ml-auto flex-shrink-0"},Fo=Ne({__name:"SellerCreateInvoiceDialog",props:{modelValue:{type:Boolean},eligibleOrders:{},seller:{},formatCurrency:{type:Function}},emits:["update:modelValue","invoice-created"],setup(m,{emit:B}){const T=m,H=B,L=V({get:()=>T.modelValue,set:F=>H("update:modelValue",F)}),P=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],k={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},d=new Date().toISOString().split("T")[0],x=U(""),N=U(d),g=U(new Set),v=U(""),A=U(""),ae=U({}),J=U(!1),W=U(""),b=ge({url:"my_frappe_app.api.get_sales_order_items",onError(F){console.error("[InvoiceDialog] soItemsResource error:",F)}}),I=V(()=>{const F=new Map;return T.eligibleOrders.forEach(c=>{const y=c.customer||c.customer_name,n=c.customer_name||c.customer;y&&n&&F.set(y,n)}),Array.from(F.entries()).map(([c,y])=>({value:c,label:y}))}),S=V(()=>T.eligibleOrders.filter(F=>{const c=F.transaction_date;return!(x.value&&c<x.value||N.value&&c>N.value||A.value&&!(F.customer===A.value||F.customer_name===A.value))}));let oe=!0;je(S,F=>{oe&&(g.value=new Set(F.map(c=>c.name)),oe=!1)},{immediate:!0});const ye=()=>{x.value="",N.value=d,A.value="",g.value=new Set,v.value=""},z=V(()=>!!x.value||!!A.value||N.value!==d),E=V(()=>S.value.length>0&&S.value.every(F=>g.value.has(F.name))),X=V(()=>S.value.some(F=>g.value.has(F.name))&&!E.value),Z=()=>{const F=new Set(g.value);E.value?S.value.forEach(c=>F.delete(c.name)):S.value.forEach(c=>F.add(c.name)),g.value=F},te=F=>{const c=new Set(g.value);c.has(F)?c.delete(F):c.add(F),g.value=c,v.value=""},Se=V(()=>T.eligibleOrders.filter(F=>g.value.has(F.name))),fe=V(()=>Se.value.reduce((F,c)=>F+(c.grand_total||0),0));function be(F){return we(this,null,function*(){const c=F.filter(y=>!ae.value[y]);if(c.length){J.value=!0,W.value="";try{const y=yield b.submit({order_names:JSON.stringify(c)});if(!Array.isArray(y))throw new Error(`Unexpected response format. Got: ${JSON.stringify(y)}`);const n={};for(const _ of y)n[_.parent]||(n[_.parent]=[]),n[_.parent].push(_);for(const _ of c)ae.value[_]=n[_]||[]}catch(y){const n=(y==null?void 0:y.message)||(y==null?void 0:y.exception)||(y==null?void 0:y.exc_type)||String(y);W.value=n;for(const _ of c)ae.value[_]||(ae.value[_]=[])}finally{J.value=!1}}})}je(g,F=>we(this,null,function*(){F.size>0&&(yield be([...F]))}),{deep:!0});const O=V(()=>{const F=new Map;for(const c of Se.value){const y=c.transaction_date;if(!y)continue;const n=new Date(y+"T00:00:00").toLocaleDateString("en-US",{weekday:"long"}),_=ae.value[c.name]||[];for(const G of _){const re=G.item_code;if(!re)continue;F.has(re)||F.set(re,{item_name:G.item_name||re,days:{},total_qty:0,total_amt:0});const ie=F.get(re),xe=Number(G.qty)||0,ke=Number(G.rate)||0;ie.days[n]||(ie.days[n]={qty:0,price:0}),ie.days[n].qty+=xe,ke>0&&ie.days[n].price===0&&(ie.days[n].price=ke),ie.total_qty+=xe,ie.total_amt+=xe*ke}}return Array.from(F.entries()).map(([c,y])=>Ae({item_code:c},y))});function f(F,c){const y=String(F).padStart(3,"0"),n=Number.isInteger(c)?String(c):c.toFixed(2);return`${y}(${n})`}const $=ge({url:"my_frappe_app.api.create_invoice_from_sales_orders",onSuccess(F){v.value="",L.value=!1,H("invoice-created",F.invoice_name),ve()},onError(F){const c=((F==null?void 0:F.exception)||(F==null?void 0:F.message)||"").toLowerCase();if(c.includes("already been billed")||c.includes("billed amount"))v.value="This order has already been billed. Please select a different order.";else if(c.includes("not submitted")||c.includes("draft"))v.value="Order has not been submitted yet. Please submit the order first.";else if(c.includes("permission")||c.includes("not permitted"))v.value="You do not have permission to create this invoice.";else if(c.includes("no orders")||c.includes("select at least"))v.value="Please select at least one order.";else if(c.includes("delivery")&&c.includes("not"))v.value="Delivery has not been completed yet. Please confirm delivery first.";else if(c.includes("customer")&&c.includes("match"))v.value="All selected orders must belong to the same customer.";else if(c.includes("internal server error")||c.includes("operationalerror")||c.includes("traceback"))v.value="A server error occurred. Please try again later or contact the admin.";else{const y=((F==null?void 0:F.exception)||(F==null?void 0:F.message)||"").replace(/<[^>]+>/g,"").replace(/^[\w.]+Error:\s*/i,"").replace(/Traceback[\s\S]*/i,"").trim();v.value=y||"An error occurred while creating the invoice. Please try again."}}}),ce=V(()=>$.loading),ee=()=>{g.value.size!==0&&(v.value="",$.submit({sales_orders:[...g.value]}))},ve=()=>{x.value="",N.value=d,g.value=new Set,v.value="",A.value="",ae.value={},W.value="",oe=!0};return je(L,F=>{F||ve()}),(F,c)=>(t(),D(l(Nt),{modelValue:L.value,"onUpdate:modelValue":c[9]||(c[9]=y=>L.value=y),options:{size:"5xl"}},{"body-title":Q(()=>[e("div",zl,[e("div",Bl,[r(l(Ie),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),c[10]||(c[10]=e("div",null,[e("h3",{class:"text-base sm:text-xl font-black leading-none text-gray-900"},"Create Invoice"),e("p",{class:"text-[10px] sm:text-sm text-gray-400 font-medium mt-0.5"}," Select delivered orders to generate a combined invoice ")],-1))])]),"body-content":Q(()=>{var y;return[e("div",Hl,[v.value?(t(),s("div",Wl,[e("div",Yl,[r(l(Le),{class:"w-4 h-4 text-red-500"})]),e("div",Gl,[c[11]||(c[11]=e("p",{class:"text-sm text-red-800 font-bold"},"Invoice Could Not Be Created",-1)),e("p",Ql,a(v.value),1)]),e("button",{onClick:c[0]||(c[0]=n=>v.value=""),class:"text-red-300 hover:text-red-500 transition-colors mt-0.5"},[r(l(Fe),{class:"w-4 h-4"})])])):p("",!0),W.value?(t(),s("div",Jl,[e("div",Xl,[r(l(Le),{class:"w-4 h-4 text-amber-500"})]),e("div",Kl,[c[12]||(c[12]=e("p",{class:"text-xs text-amber-800 font-bold"},"Could not load item details",-1)),e("p",Zl,a(W.value),1)]),e("button",{onClick:c[1]||(c[1]=n=>W.value=""),class:"text-amber-300 hover:text-amber-500 transition-colors"},[r(l(Fe),{class:"w-3.5 h-3.5"})])])):p("",!0),e("div",en,[e("div",tn,[e("div",sn,[e("div",an,[r(l(Gt),{class:"w-3.5 h-3.5 text-indigo-600"})]),c[13]||(c[13]=e("span",{class:"filter-title"},"Filters",-1)),z.value?(t(),s("span",ln,a((x.value?1:0)+(A.value?1:0)+(N.value!==l(d)?1:0))+" active ",1)):p("",!0)]),e("button",{onClick:ye,disabled:!z.value,class:C(["clear-btn",z.value?"clear-btn-active":"clear-btn-disabled"])},[r(l(Fe),{class:"w-3 h-3"}),c[14]||(c[14]=e("span",null,"Clear Filters",-1))],10,nn)]),e("div",on,[e("div",rn,[c[15]||(c[15]=e("label",{class:"filter-label"},"From Date",-1)),e("div",{class:C(["filter-input-wrap",x.value?"input-active":""])},[r(l(Re),{class:"filter-input-icon"}),pe(e("input",{type:"date","onUpdate:modelValue":c[2]||(c[2]=n=>x.value=n),max:N.value||l(d),class:"filter-input"},null,8,dn),[[me,x.value]]),x.value?(t(),s("button",{key:0,onClick:c[3]||(c[3]=le(n=>x.value="",["stop"])),class:"input-clear-btn"},[r(l(Fe),{class:"w-3 h-3"})])):p("",!0)],2)]),e("div",cn,[c[16]||(c[16]=e("label",{class:"filter-label"},"To Date",-1)),e("div",{class:C(["filter-input-wrap",N.value!==l(d)?"input-active":""])},[r(l(Re),{class:"filter-input-icon"}),pe(e("input",{type:"date","onUpdate:modelValue":c[4]||(c[4]=n=>N.value=n),min:x.value,max:l(d),class:"filter-input"},null,8,un),[[me,N.value]]),N.value!==l(d)?(t(),s("button",{key:0,onClick:c[5]||(c[5]=le(n=>N.value=l(d),["stop"])),class:"input-clear-btn"},[r(l(Fe),{class:"w-3 h-3"})])):p("",!0)],2)]),e("div",xn,[c[18]||(c[18]=e("label",{class:"filter-label"},"Customer",-1)),e("div",{class:C(["filter-input-wrap",A.value?"input-active":""])},[r(l(dt),{class:"filter-input-icon",style:{"z-index":"2"}}),pe(e("select",{"onUpdate:modelValue":c[6]||(c[6]=n=>A.value=n),class:"filter-input filter-select"},[e("option",pn,"All Customers ("+a(I.value.length)+")",1),(t(!0),s(q,null,Y(I.value,n=>(t(),s("option",{key:n.value,value:n.value},a(n.label),9,mn))),128))],512),[[Ct,A.value]]),c[17]||(c[17]=e("svg",{class:"absolute right-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1))],2)])]),e("div",gn,[e("div",yn,[e("span",{class:C(["pill-dot",z.value?"pill-dot-active":"pill-dot-idle"])},null,2),e("span",bn,a(x.value||"Any"),1),r(l(Ye),{class:"w-3 h-3 opacity-40"}),e("span",fn,a(N.value||l(d)),1)]),A.value?(t(),s("div",vn,[r(l(dt),{class:"w-2.5 h-2.5"}),e("span",hn,a((y=I.value.find(n=>n.value===A.value))==null?void 0:y.label),1),e("button",{onClick:c[7]||(c[7]=n=>{A.value="",g.value=new Set}),class:"pill-remove"},[r(l(Fe),{class:"w-2.5 h-2.5"})])])):p("",!0),e("div",_n,[e("span",kn,a(S.value.length),1),c[19]||(c[19]=e("span",{class:"pill-count-label"},"orders found",-1))])])]),e("div",wn,[e("div",$n,[c[21]||(c[21]=e("div",{class:"w-8 h-8 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0 shadow-inner"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7"})])],-1)),c[22]||(c[22]=e("div",{class:"flex-1 min-w-0"},[e("p",{class:"text-sm font-black text-white leading-tight tracking-tight"},"Day-wise Item Summary"),e("p",{class:"text-[11px] text-emerald-200 mt-0.5 font-semibold"},"qty(â‚¹rate) â€” e.g. 002(35)")],-1)),J.value?(t(),D(l(rt),{key:0,class:"w-4 h-4 text-white/80 animate-spin flex-shrink-0"})):(t(),s("div",Cn,[e("span",Sn,a(O.value.length),1),c[20]||(c[20]=e("span",{class:"text-[11px] text-emerald-200 font-semibold"},"items",-1))]))]),J.value&&O.value.length===0?(t(),s("div",Dn,[e("div",Pn,[r(l(rt),{class:"w-5 h-5 text-emerald-500 animate-spin"})]),c[23]||(c[23]=e("p",{class:"text-xs font-semibold text-gray-400"},"Fetching item details...",-1))])):g.value.size===0?(t(),s("div",Fn,[...c[24]||(c[24]=[e("div",{class:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1),e("p",{class:"text-xs font-semibold text-gray-400"},"Select orders below to see item summary",-1)])])):!J.value&&O.value.length===0?(t(),s("div",Tn,[e("div",Nn,[r(l(Le),{class:"w-5 h-5 text-amber-400"})]),c[25]||(c[25]=e("p",{class:"text-xs font-semibold text-gray-400"},"No item data found for selected orders",-1)),c[26]||(c[26]=e("p",{class:"text-[10px] text-gray-300"},"Check browser console (F12) for details",-1))])):(t(),s("div",In,[e("table",jn,[e("thead",null,[e("tr",null,[c[27]||(c[27]=e("th",{class:"col-item th-item"},[e("span",{class:"th-label"},"Item")],-1)),(t(),s(q,null,Y(P,n=>e("th",{key:n,class:C(["col-day th-day",n==="Saturday"||n==="Sunday"?"th-weekend":""])},a(k[n]),3)),64)),c[28]||(c[28]=e("th",{class:"col-total th-total"},[e("span",{class:"th-label"},"Total")],-1))])]),e("tbody",null,[(t(!0),s(q,null,Y(O.value,(n,_)=>(t(),s("tr",{key:n.item_code,class:C(["data-row",_%2===1?"row-alt":"row-base"])},[e("td",{class:C(["col-item td-item",_%2===1?"td-item-alt":"td-item-base"])},[e("div",{class:"item-name",title:n.item_name},a(n.item_name),9,Rn),e("div",{class:"item-code",title:n.item_code},a(n.item_code),9,An)],2),(t(),s(q,null,Y(P,G=>e("td",{key:G,class:C(["col-day td-day",G==="Saturday"||G==="Sunday"?"td-weekend":""])},[n.days[G]&&n.days[G].qty>0?(t(),s("span",Mn,a(f(n.days[G].qty,n.days[G].price)),1)):(t(),s("span",Ln,"Â·"))],2)),64)),e("td",Un,[e("div",On,a(m.formatCurrency(n.total_amt)),1),e("div",qn,"qty: "+a(n.total_qty),1)])],2))),128))]),e("tfoot",null,[e("tr",En,[c[29]||(c[29]=e("td",{class:"col-item td-foot-label"},"Grand Total",-1)),(t(),s(q,null,Y(P,n=>e("td",{key:n,class:C(["col-day td-foot-day",n==="Saturday"||n==="Sunday"?"td-foot-weekend":""])},null,2)),64)),e("td",Vn,a(m.formatCurrency(fe.value)),1)])])])]))]),e("div",zn,[e("div",Bn,[c[31]||(c[31]=e("div",{class:"w-7 h-7 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),c[32]||(c[32]=e("div",{class:"flex-1"},[e("p",{class:"text-sm font-black text-white leading-none"},"Select Orders"),e("p",{class:"text-[10px] text-gray-300 mt-0.5"},"Click to select/deselect orders for invoicing")],-1)),e("button",{onClick:Z,class:"flex items-center gap-1.5 bg-white/15 hover:bg-white/25 transition-colors rounded-lg px-2.5 py-1.5 flex-shrink-0"},[e("div",{class:C(["checkbox-circle-sm",E.value?"checkbox-sm-selected":X.value?"checkbox-sm-indeterminate":"checkbox-sm-unselected"])},[E.value?(t(),s("svg",Hn,[...c[30]||(c[30]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):X.value?(t(),s("div",Wn)):p("",!0)],2),e("span",Yn,a(E.value?"Deselect All":"Select All"),1)])]),c[37]||(c[37]=e("div",{class:"hidden sm:grid items-center gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100",style:{"grid-template-columns":"24px 24px 1fr 1fr 72px 72px 90px"}},[e("span"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"#"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Sales Order"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest"},"Delivery Note"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Delivered"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Billed"),e("span",{class:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-right"},"Amount")],-1)),S.value.length===0?(t(),s("div",Gn,[e("div",Qn,[r(l(Le),{class:"w-6 h-6 text-gray-300"})]),c[33]||(c[33]=e("p",{class:"text-sm font-bold text-gray-400"},"No eligible orders found",-1)),c[34]||(c[34]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting the date range or customer filter",-1))])):(t(),s("div",Jn,[(t(!0),s(q,null,Y(S.value,(n,_)=>(t(),s("div",{key:n.name,onClick:G=>te(n.name),class:C(["order-row cursor-pointer select-none transition-all duration-100",g.value.has(n.name)?"order-row-selected":"order-row-unselected"])},[e("div",Kn,[e("div",{class:C(["checkbox-circle",g.value.has(n.name)?"checkbox-selected":"checkbox-unselected"])},[g.value.has(n.name)?(t(),s("svg",Zn,[...c[35]||(c[35]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):p("",!0)],2),e("span",eo,a(_+1),1),e("div",to,[e("div",so,[e("span",ao,a(n.name),1),n.custom_subscription_refereance?(t(),s("span",lo,"Sub")):p("",!0)]),e("p",no,a(n.customer_name),1)]),e("div",oo,[e("span",ro,a(n.delivery_note||"â€”"),1)]),e("div",io,[e("span",co,a(n.per_delivered)+"% ",1)]),e("div",uo,[e("span",xo,a(n.per_billed)+"% ",1)]),e("span",po,a(m.formatCurrency(n.grand_total,n.currency)),1)]),e("div",mo,[e("div",{class:C(["checkbox-circle",g.value.has(n.name)?"checkbox-selected":"checkbox-unselected"])},[g.value.has(n.name)?(t(),s("svg",go,[...c[36]||(c[36]=[e("path",{d:"M2 6l3 3 5-5",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):p("",!0)],2),e("div",yo,[e("div",bo,[e("span",fo,a(n.name),1),n.custom_subscription_refereance?(t(),s("span",vo,"Sub")):p("",!0)]),e("div",ho,[e("p",_o,a(n.customer_name),1),e("span",ko,a(n.per_delivered)+"%",1)])]),e("span",wo,a(m.formatCurrency(n.grand_total,n.currency)),1)])],10,Xn))),128))]))])])]}),actions:Q(()=>[e("div",$o,[e("div",Co,[g.value.size>0?(t(),s(q,{key:0},[e("span",So,a(g.value.size)+" orders ",1),c[38]||(c[38]=e("div",{class:"h-4 w-px bg-gray-200 flex-shrink-0"},null,-1)),e("span",Do,a(m.formatCurrency(fe.value)),1)],64)):p("",!0)]),e("div",Po,[r(l($e),{variant:"outline",class:"text-xs sm:text-sm",onClick:c[8]||(c[8]=y=>L.value=!1)},{default:Q(()=>[...c[39]||(c[39]=[j("Cancel",-1)])]),_:1}),r(l($e),{variant:"solid",theme:"green",loading:ce.value,disabled:g.value.size===0,class:"text-xs sm:text-sm",onClick:ee},{prefix:Q(()=>[r(l(Ie),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4"})]),default:Q(()=>[c[40]||(c[40]=j(" Create Invoice ",-1))]),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"]))}}),To=Dt(Fo,[["__scopeId","data-v-bf1c7c7e"]]),No={class:"w-full min-w-0"},Io={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},jo={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0 shadow-lg"},Ro={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},Ao={class:"flex-1 min-w-0"},Mo={class:"text-sm font-black text-white truncate"},Lo={key:0,class:"text-[10px] text-gray-400 font-medium"},Uo={class:"text-blue-400"},Oo={class:"flex items-center gap-2 flex-shrink-0"},qo={key:0,class:"flex-1 flex items-center justify-center"},Eo={class:"flex flex-col items-center gap-4"},Vo={class:"relative"},zo={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},Bo={key:1,class:"flex-1 flex items-center justify-center p-6"},Ho={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},Wo={class:"w-12 h-12 rounded-2xl bg-red-500/20 flex items-center justify-center mx-auto"},Yo={class:"text-xs text-red-500 mt-1 break-words"},Go=["src"],Qo={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},Jo={class:"flex items-start gap-3"},Xo={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},Ko={class:"text-sm font-black text-gray-900"},Zo={class:"text-xs text-gray-500 mt-1 leading-relaxed"},er={class:"flex gap-2 justify-end"},tr={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},sr={class:"flex items-start gap-3"},ar={class:"p-2 bg-red-50 rounded-xl flex-shrink-0"},lr={class:"flex-1 min-w-0"},nr={class:"text-xs text-red-600 mt-1 leading-relaxed break-words"},or={class:"flex justify-end"},rr={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},ir={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},dr={class:"text-sm sm:text-base font-black leading-tight"},cr={class:"bg-gradient-to-br from-orange-500 to-amber-400 rounded-xl p-3 text-white"},ur={class:"text-sm sm:text-base font-black leading-tight"},xr={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},pr={class:"text-sm sm:text-base font-black leading-tight"},mr={class:"bg-gradient-to-br from-gray-500 to-gray-400 rounded-xl p-3 text-white"},gr={class:"text-sm sm:text-base font-black leading-tight"},yr={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},br={class:"flex flex-wrap items-center gap-2"},fr={class:"flex items-center gap-2 flex-1 min-w-0"},vr={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},hr={class:"min-w-0"},_r={class:"text-[10px] text-gray-400 font-medium mt-0.5"},kr={key:0,class:"text-blue-500"},wr={class:"relative"},$r={class:"flex flex-wrap gap-2 items-center"},Cr={class:"flex gap-1 flex-wrap"},Sr=["onClick"],Dr={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Pr=["max"],Fr={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Tr=["min"],Nr={key:0,class:"p-6 space-y-3"},Ir={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},jr={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Rr={key:2},Ar={class:"divide-y divide-gray-100/80"},Mr=["onClick"],Lr={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},Ur={class:"flex items-center gap-2 flex-wrap"},Or={class:"text-xs font-black text-gray-900 truncate"},qr={class:"text-[10px] text-gray-500 font-medium truncate"},Er={class:"flex items-center gap-2 flex-wrap mt-0.5"},Vr={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},zr={class:"text-[10px] font-black text-gray-800"},Br={key:0,class:"text-[9px] text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded font-semibold"},Hr={class:"hidden sm:block text-xs font-black text-gray-900 truncate"},Wr={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},Yr={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},Gr={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},Qr={class:"hidden sm:flex justify-center"},Jr={class:"flex justify-center text-gray-400"},Xr={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},Kr={key:0,class:"space-y-2"},Zr={key:1,class:"space-y-4"},ei={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},ti={class:"col-span-2 sm:col-span-1 bg-white rounded-xl p-3 border border-gray-100"},si={class:"text-xs font-black text-blue-700 truncate"},ai={class:"bg-white rounded-xl p-3 border border-gray-100"},li={class:"text-xs font-black text-gray-800"},ni={class:"bg-white rounded-xl p-3 border border-gray-100"},oi={class:"text-xs font-black text-gray-800"},ri={class:"bg-white rounded-xl p-3 border border-gray-100"},ii={class:"text-xs font-black text-gray-800"},di={class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},ci={class:"bg-white rounded-xl p-3 border border-gray-100"},ui={class:"text-xs font-black text-gray-800 truncate"},xi={class:"bg-white rounded-xl p-3 border border-gray-100"},pi={class:"text-xs font-black text-gray-800"},mi={class:"bg-white rounded-xl p-3 border border-gray-100"},gi={class:"text-xs font-black text-gray-800"},yi={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},bi={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},fi={class:"min-w-0"},vi={class:"text-xs font-semibold text-gray-800 truncate"},hi={class:"text-[9px] text-gray-400 truncate"},_i={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},ki={class:"text-xs text-gray-600 text-center font-medium"},wi={class:"text-xs text-gray-600 text-center"},$i={class:"text-xs font-black text-gray-900 text-right"},Ci={class:"border-t border-gray-200 px-4 py-3 flex justify-between items-center"},Si={key:0,class:"text-xs text-gray-500"},Di={class:"text-right ml-auto"},Pi={class:"text-sm font-black text-gray-900"},Fi={class:"flex flex-wrap gap-2 justify-end pt-1"},Ti=["onClick"],Ni=["onClick","disabled"],Ii=["onClick","disabled"],ji=["onClick","disabled"],Ri=["onClick","disabled"],Ai={key:2,class:"space-y-2"},Mi={key:0,class:"flex justify-center py-4"},Li=Ne({__name:"Deliverynote",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(m){const B=m,T=U(""),H=U(""),L=U(""),P=U("all"),k=U(null),d=U(null),x=U(""),N=U(""),g=U({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),v=U({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),A=U({show:!1,message:""}),ae=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Submitted",label:"Submitted"},{key:"Cancelled",label:"Cancelled"}],J=Ke({doctype:"Delivery Note",fields:["name","customer","customer_name","status","posting_date","grand_total","currency","docstatus","lr_no","lr_date","per_billed","per_returned","set_warehouse","shipping_address_name"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),W=ge({url:"frappe.client.get",makeParams:y=>({doctype:"Delivery Note",name:y.name}),onSuccess(y){d.value=y}}),b=ge({url:"frappe.client.submit",onSuccess(){x.value="",N.value="",J.reload(),k.value&&W.fetch({name:k.value})},onError(y){x.value="",N.value="",be((y==null?void 0:y.message)||(y==null?void 0:y.exc_type)||"Submit failed")}}),I=ge({url:"frappe.client.cancel",onSuccess(){x.value="",N.value="",J.reload(),k.value&&W.fetch({name:k.value})},onError(y){x.value="",N.value="",be((y==null?void 0:y.message)||(y==null?void 0:y.exc_type)||"Cancel failed")}}),S=ge({url:"frappe.client.delete",onSuccess(){x.value="",N.value="",k.value=null,d.value=null,J.reload()},onError(y){x.value="",N.value="",be((y==null?void 0:y.message)||(y==null?void 0:y.exc_type)||"Delete failed")}});je(()=>[B.customer,B.seller],([y])=>{const n=[];y&&n.push(["customer","=",y]),J.update({filters:n}),J.reload()},{immediate:!0});const oe=V(()=>{let y=J.data||[];if(P.value!=="all"&&(y=y.filter(n=>P.value==="Draft"?n.docstatus===0:P.value==="Submitted"?n.docstatus===1:P.value==="Cancelled"?n.docstatus===2:!0)),H.value&&(y=y.filter(n=>n.posting_date>=H.value)),L.value&&(y=y.filter(n=>n.posting_date<=L.value)),T.value.trim()){const n=T.value.toLowerCase();y=y.filter(_=>{var G,re;return((G=_.name)==null?void 0:G.toLowerCase().includes(n))||((re=_.customer_name)==null?void 0:re.toLowerCase().includes(n))})}return y}),ye=V(()=>H.value!==""||L.value!==""),z=V(()=>J.loading),E=V(()=>(J.data||[]).length>0),X=V(()=>{const y=J.data||[];return{total:y.length,draft:y.filter(n=>n.docstatus===0).length,submitted:y.filter(n=>n.docstatus===1).length,cancelled:y.filter(n=>n.docstatus===2).length}});function Z(){H.value="",L.value="",P.value="all",T.value=""}function te(y){return y.docstatus===2?{label:"Cancelled",theme:"gray",icon:Be}:y.docstatus===0?{label:"Draft",theme:"orange",icon:Ze}:y.per_billed>=100?{label:"Completed",theme:"green",icon:mt}:y.per_billed>0?{label:"Partly Billed",theme:"blue",icon:Le}:{label:"To Bill",theme:"purple",icon:pt}}const Se={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function fe(y){k.value===y?(k.value=null,d.value=null):(k.value=y,d.value=null,W.fetch({name:y}))}function be(y){const n=y.replace(/<[^>]*>/g,"").trim().split(`
`)[0];A.value={show:!0,message:n}}function O(y){return we(this,null,function*(){var n,_;try{const G=yield fetch(`/api/method/frappe.client.get_value?doctype=Property+Setter&filters=${encodeURIComponent(JSON.stringify([["doc_type","=",y],["property","=","default_print_format"]]))}&fieldname=value`,{credentials:"include"});if(G.ok){const re=yield G.json(),ie=(n=re==null?void 0:re.message)==null?void 0:n.value;if(ie&&ie.trim())return ie.trim()}}catch(G){}try{const G=yield fetch(`/api/resource/Print+Format?filters=${encodeURIComponent(JSON.stringify([["doc_type","=",y],["disabled","=",0]]))}&fields=${encodeURIComponent(JSON.stringify(["name","default_format"]))}&order_by=modified+desc&limit=50`,{credentials:"include"});if(G.ok){const re=yield G.json(),ie=(re==null?void 0:re.data)||[],xe=ie.find(ke=>ke.default_format===1);if(xe!=null&&xe.name)return xe.name;if((_=ie[0])!=null&&_.name)return ie[0].name}}catch(G){}return"Standard"})}function f(y){return we(this,null,function*(){g.value={show:!0,loading:!0,blobUrl:"",docName:y,printFormat:"",error:""};try{const n=yield O("Delivery Note");g.value.printFormat=n;const _=`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(y)}&format=${encodeURIComponent(n)}&no_letterhead=0&letterhead=No+Letterhead`,G=yield fetch(_,{credentials:"include"});if(!G.ok){if(n!=="Standard"){const xe=yield fetch(`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent("Delivery Note")}&name=${encodeURIComponent(y)}&format=Standard&no_letterhead=0`,{credentials:"include"});if(!xe.ok)throw new Error(`HTTP ${xe.status} â€” PDF generation failed`);const ke=yield xe.blob(),ne=URL.createObjectURL(ke);g.value={show:!0,loading:!1,blobUrl:ne,docName:y,printFormat:"Standard (fallback)",error:""};return}throw new Error(`HTTP ${G.status} â€” PDF generation failed`)}const re=yield G.blob(),ie=URL.createObjectURL(re);g.value={show:!0,loading:!1,blobUrl:ie,docName:y,printFormat:n,error:""}}catch(n){const _=(n==null?void 0:n.message)||"Could not load PDF";g.value={show:!0,loading:!1,blobUrl:"",docName:y,printFormat:"",error:_}}})}function $(){g.value.blobUrl&&URL.revokeObjectURL(g.value.blobUrl),g.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function ce(){if(!g.value.blobUrl)return;const y=document.createElement("a");y.href=g.value.blobUrl,y.download=`${g.value.docName}.pdf`,y.click()}function ee(y){v.value=Ae({show:!0},y)}function ve(y){d.value&&ee({title:"Submit Delivery Note",message:`Submit ${y}? Stock entries will be posted and cannot be easily undone.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{v.value.show=!1,x.value=y,N.value="submit",b.fetch({doc:d.value})}})}function F(y){ee({title:"Cancel Delivery Note",message:`Cancel ${y}? Stock entries will be reversed.`,confirmLabel:"Cancel DN",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{v.value.show=!1,x.value=y,N.value="cancel",I.fetch({doctype:"Delivery Note",name:y})}})}function c(y){ee({title:"Delete Delivery Note",message:`Permanently delete ${y}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{v.value.show=!1,x.value=y,N.value="delete",S.fetch({doctype:"Delivery Note",name:y})}})}return(y,n)=>(t(),s("div",No,[(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>[g.value.show?(t(),s("div",Io,[e("div",jo,[e("div",Ro,[r(l(Ve),{class:"w-4 h-4 text-white"})]),e("div",Ao,[e("p",Mo,a(g.value.docName),1),g.value.printFormat?(t(),s("p",Lo,[n[12]||(n[12]=j(" Format: ",-1)),e("span",Uo,a(g.value.printFormat),1)])):p("",!0)]),e("div",Oo,[g.value.blobUrl?(t(),s("button",{key:0,onClick:ce,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[r(l(It),{class:"w-3.5 h-3.5"}),n[13]||(n[13]=e("span",{class:"hidden sm:inline"},"Download",-1))])):p("",!0),e("button",{onClick:$,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[r(l(Fe),{class:"w-4 h-4"})])])]),g.value.loading?(t(),s("div",qo,[e("div",Eo,[e("div",Vo,[e("div",zo,[r(l(Ve),{class:"w-7 h-7 text-white/60"})]),n[14]||(n[14]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-blue-400 border-t-transparent animate-spin"},null,-1))]),n[15]||(n[15]=e("div",{class:"text-center"},[e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Detecting default print format")],-1))])])):g.value.error?(t(),s("div",Bo,[e("div",Ho,[e("div",Wo,[r(l(Te),{class:"w-6 h-6 text-red-400"})]),e("div",null,[n[16]||(n[16]=e("p",{class:"text-sm font-black text-red-300"},"PDF Load Failed",-1)),e("p",Yo,a(g.value.error),1)]),e("button",{onClick:$,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl transition-colors"}," Close ")])])):g.value.blobUrl?(t(),s("iframe",{key:2,src:g.value.blobUrl,class:"flex-1 w-full border-0",title:"Print Preview"},null,8,Go)):p("",!0)])):p("",!0)]),_:1})])),(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:Q(()=>[v.value.show?(t(),s("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:n[2]||(n[2]=le(_=>v.value.show=!1,["self"]))},[e("div",Qo,[e("div",Jo,[e("div",Xo,[r(l(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",Ko,a(v.value.title),1),e("p",Zo,a(v.value.message),1)])]),e("div",er,[e("button",{onClick:n[0]||(n[0]=_=>v.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"}," Go Back "),e("button",{onClick:n[1]||(n[1]=_=>v.value.onConfirm()),class:C(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",v.value.confirmClass])},a(v.value.confirmLabel),3)])])])):p("",!0)]),_:1})])),(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>[A.value.show?(t(),s("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:n[4]||(n[4]=le(_=>A.value.show=!1,["self"]))},[e("div",tr,[e("div",sr,[e("div",ar,[r(l(Te),{class:"w-5 h-5 text-red-500"})]),e("div",lr,[n[17]||(n[17]=e("h3",{class:"text-sm font-black text-gray-900"},"Action Failed",-1)),e("p",nr,a(A.value.message),1)])]),e("div",or,[e("button",{onClick:n[3]||(n[3]=_=>A.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-gray-700 transition-colors"}," OK ")])])])):p("",!0)]),_:1})])),e("div",rr,[e("div",ir,[n[18]||(n[18]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total DNs",-1)),e("p",dr,a(X.value.total),1)]),e("div",cr,[n[19]||(n[19]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Draft",-1)),e("p",ur,a(X.value.draft),1)]),e("div",xr,[n[20]||(n[20]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Submitted",-1)),e("p",pr,a(X.value.submitted),1)]),e("div",mr,[n[21]||(n[21]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Cancelled",-1)),e("p",gr,a(X.value.cancelled),1)])]),e("div",yr,[e("div",br,[e("div",fr,[e("div",vr,[r(l(Oe),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",hr,[n[22]||(n[22]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Delivery Notes",-1)),e("p",_r,[j(a(oe.value.length)+" record"+a(oe.value.length!==1?"s":"")+" ",1),ye.value||P.value!=="all"||T.value?(t(),s("span",kr," (filtered)")):p("",!0)])])]),e("button",{onClick:n[5]||(n[5]=_=>l(J).reload()),class:C(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",z.value?"opacity-60 pointer-events-none":""])},[r(l(ue),{class:C(["w-3.5 h-3.5",z.value?"animate-spin":""])},null,8,["class"]),n[23]||(n[23]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",wr,[r(l(He),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),pe(e("input",{"onUpdate:modelValue":n[6]||(n[6]=_=>T.value=_),type:"text",placeholder:"Search by DN #, customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[me,T.value]]),T.value?(t(),s("button",{key:0,onClick:n[7]||(n[7]=_=>T.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[r(l(he),{class:"w-3.5 h-3.5"})])):p("",!0)]),e("div",$r,[e("div",Cr,[(t(),s(q,null,Y(ae,_=>e("button",{key:_.key,onClick:G=>P.value=_.key,class:C(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",P.value===_.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},a(_.label),11,Sr)),64))]),e("div",Dr,[n[24]||(n[24]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),pe(e("input",{type:"date","onUpdate:modelValue":n[8]||(n[8]=_=>H.value=_),max:L.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Pr),[[me,H.value]]),H.value?(t(),s("button",{key:0,onClick:n[9]||(n[9]=_=>H.value=""),class:"text-gray-300 hover:text-red-400"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),e("div",Fr,[n[25]||(n[25]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),pe(e("input",{type:"date","onUpdate:modelValue":n[10]||(n[10]=_=>L.value=_),min:H.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Tr),[[me,L.value]]),L.value?(t(),s("button",{key:0,onClick:n[11]||(n[11]=_=>L.value=""),class:"text-gray-300 hover:text-red-400"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),ye.value||P.value!=="all"||T.value?(t(),s("button",{key:0,onClick:Z,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[r(l(he),{class:"w-3 h-3"}),n[26]||(n[26]=j(" Clear All ",-1))])):p("",!0)])]),z.value&&!E.value?(t(),s("div",Nr,[(t(),s(q,null,Y(5,_=>e("div",{key:_,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!z.value&&oe.value.length===0?(t(),s("div",Ir,[e("div",jr,[r(l(Oe),{class:"w-10 h-10 text-gray-300"})]),n[27]||(n[27]=e("p",{class:"text-sm font-black text-gray-300"},"No Delivery Notes Found",-1)),n[28]||(n[28]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),s("div",Rr,[n[43]||(n[43]=e("div",{class:"hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"DN #"),e("span",null,"Customer"),e("span",null,"Date"),e("span",{class:"text-right"},"Amount"),e("span",{class:"text-center"},"Status"),e("span")],-1)),e("div",Ar,[(t(!0),s(q,null,Y(oe.value,_=>{var G;return t(),s("div",{key:_.name},[e("div",{onClick:re=>fe(_.name),class:"grid grid-cols-[1fr_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.6fr_36px] gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5 hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none"},[e("div",Lr,[e("div",Ur,[e("span",Or,a(_.name),1),e("span",{class:C(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",Se[te(_).theme]])},[(t(),D(Ce(te(_).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+a(te(_).label),1)],2)]),e("span",qr,a(_.customer_name),1),e("div",Er,[e("span",Vr,[r(l(Re),{class:"w-2.5 h-2.5"}),j(a(_.posting_date),1)]),e("span",zr,a(m.formatCurrency(_.grand_total,_.currency)),1),_.per_billed>0&&_.per_billed<100?(t(),s("span",Br,a((G=_.per_billed)==null?void 0:G.toFixed(0))+"% billed ",1)):p("",!0)])]),e("span",Hr,a(_.name),1),e("span",Wr,a(_.customer_name),1),e("span",Yr,[r(l(Re),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),j(a(_.posting_date),1)]),e("span",Gr,a(m.formatCurrency(_.grand_total,_.currency)),1),e("span",Qr,[e("span",{class:C(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",Se[te(_).theme]])},[(t(),D(Ce(te(_).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+a(te(_).label),1)],2)]),e("div",Jr,[k.value===_.name?(t(),D(l(We),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),D(l(Ye),{key:1,class:"w-4 h-4"}))])],8,Mr),r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>{var re,ie,xe,ke;return[k.value===_.name?(t(),s("div",Xr,[l(W).loading&&!d.value?(t(),s("div",Kr,[(t(),s(q,null,Y(4,ne=>e("div",{key:ne,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):d.value&&d.value.name===_.name?(t(),s("div",Zr,[e("div",ei,[e("div",ti,[n[29]||(n[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Against Sales Order",-1)),e("p",si,a(((re=d.value.items)==null?void 0:re.map(ne=>ne.against_sales_order).filter(Boolean).filter((ne,M,h)=>h.indexOf(ne)===M).join(", "))||"â€”"),1)]),e("div",ai,[n[30]||(n[30]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Number",-1)),e("p",li,a(d.value.lr_no||"â€”"),1)]),e("div",ni,[n[31]||(n[31]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"LR Date",-1)),e("p",oi,a(d.value.lr_date||"â€”"),1)]),e("div",ri,[n[32]||(n[32]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Billed %",-1)),e("p",ii,a((ie=d.value.per_billed)!=null?ie:0)+"%",1)])]),e("div",di,[e("div",ci,[n[33]||(n[33]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Warehouse",-1)),e("p",ui,a(d.value.set_warehouse||"â€”"),1)]),e("div",xi,[n[34]||(n[34]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"% Returned",-1)),e("p",pi,a((xe=d.value.per_returned)!=null?xe:0)+"%",1)]),e("div",mi,[n[35]||(n[35]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Vehicle No",-1)),e("p",gi,a(d.value.vehicle_no||"â€”"),1)])]),(ke=d.value.items)!=null&&ke.length?(t(),s("div",yi,[n[37]||(n[37]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",bi,[(t(!0),s(q,null,Y(d.value.items,ne=>(t(),s("div",{key:ne.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",fi,[e("p",vi,a(ne.item_name),1),e("p",hi,a(ne.item_code),1),ne.against_sales_order?(t(),s("p",_i," SO: "+a(ne.against_sales_order),1)):p("",!0)]),e("span",ki,a(ne.qty)+" "+a(ne.uom),1),e("span",wi,a(m.formatCurrency(ne.rate,d.value.currency)),1),e("span",$i,a(m.formatCurrency(ne.amount,d.value.currency)),1)]))),128))]),e("div",Ci,[d.value.total_taxes_and_charges?(t(),s("div",Si," Tax: "+a(m.formatCurrency(d.value.total_taxes_and_charges,d.value.currency)),1)):p("",!0),e("div",Di,[n[36]||(n[36]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase"},"Grand Total",-1)),e("p",Pi,a(m.formatCurrency(d.value.grand_total,d.value.currency)),1)])])])):p("",!0),e("div",Fi,[e("button",{onClick:le(ne=>f(_.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[r(l(Ve),{class:"w-3.5 h-3.5"}),n[38]||(n[38]=j(" Print / PDF ",-1))],8,Ti),d.value.docstatus===0?(t(),s("button",{key:0,onClick:le(ne=>ve(_.name),["stop"]),disabled:x.value===_.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[x.value===_.name&&N.value==="submit"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(gt),{key:1,class:"w-3.5 h-3.5"})),n[39]||(n[39]=j(" Submit ",-1))],8,Ni)):p("",!0),d.value.docstatus===0?(t(),s("button",{key:1,onClick:le(ne=>c(_.name),["stop"]),disabled:x.value===_.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[x.value===_.name&&N.value==="delete"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(ze),{key:1,class:"w-3.5 h-3.5"})),n[40]||(n[40]=j(" Delete ",-1))],8,Ii)):p("",!0),d.value.docstatus===1?(t(),s("button",{key:2,onClick:le(ne=>F(_.name),["stop"]),disabled:x.value===_.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[x.value===_.name&&N.value==="cancel"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(Be),{key:1,class:"w-3.5 h-3.5"})),n[41]||(n[41]=j(" Cancel ",-1))],8,ji)):p("",!0),d.value.docstatus===2?(t(),s("button",{key:3,onClick:le(ne=>c(_.name),["stop"]),disabled:x.value===_.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[x.value===_.name&&N.value==="delete"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(ze),{key:1,class:"w-3.5 h-3.5"})),n[42]||(n[42]=j(" Delete ",-1))],8,Ri)):p("",!0)])])):(t(),s("div",Ai,[(t(),s(q,null,Y(3,ne=>e("div",{key:ne,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):p("",!0)]}),_:2},1024)])}),128))]),z.value&&E.value?(t(),s("div",Mi,[r(l(ue),{class:"w-5 h-5 text-gray-400 animate-spin"})])):p("",!0)]))]))}}),Ui={class:"bg-white w-full sm:max-w-md sm:rounded-2xl rounded-t-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]"},Oi={class:"flex items-center justify-between px-5 py-4 border-b border-gray-100 flex-shrink-0"},qi={class:"flex items-center gap-3 min-w-0"},Ei={class:"p-2 bg-green-50 rounded-xl flex-shrink-0"},Vi={class:"min-w-0"},zi={class:"text-sm font-black text-gray-900"},Bi={class:"text-[10px] text-gray-400 font-medium mt-0.5 truncate"},Hi={key:0,class:"ml-1.5 bg-amber-100 text-amber-700 px-1.5 py-0.5 rounded-full text-[9px] font-bold"},Wi={class:"px-5 py-4 space-y-4 overflow-y-auto flex-1"},Yi={key:0,class:"bg-blue-50 border border-blue-100 rounded-xl px-4 py-3"},Gi={key:1,class:"bg-amber-50 border border-amber-100 rounded-xl px-4 py-3"},Qi={key:2,class:"flex items-start gap-3 bg-red-50 border border-red-200 rounded-xl px-4 py-3"},Ji={class:"flex-1 min-w-0"},Xi={class:"text-xs text-red-600 leading-relaxed break-words"},Ki={key:3,class:"space-y-3"},Zi={class:"flex items-center gap-3 bg-green-50 border border-green-200 rounded-xl px-4 py-3"},ed={class:"p-1.5 bg-green-100 rounded-lg flex-shrink-0"},td={class:"flex-1 min-w-0"},sd={class:"text-[10px] text-green-600 mt-0.5"},ad={class:"bg-gray-50 rounded-xl border border-gray-100 overflow-hidden"},ld={class:"divide-y divide-gray-100"},nd={class:"flex items-center gap-3 px-4 py-3"},od={class:"flex-1 min-w-0"},rd={class:"text-xs text-gray-700 mt-0.5 break-all"},id={class:"flex items-center gap-3 px-4 py-3"},dd={class:"flex-1 min-w-0"},cd={class:"text-xs text-gray-600 mt-0.5"},ud={class:"text-gray-400"},xd={key:0,class:"flex items-center gap-3 px-4 py-3 bg-amber-50/50"},pd={class:"text-[10px] text-amber-700 font-medium"},md={class:"flex items-center gap-2 px-5 py-4 border-t border-gray-100 bg-gray-50/80 flex-shrink-0"},gd=["disabled"],yd=["disabled"],bd=Ne({__name:"PaymentRequestModal",props:{invoiceName:{},show:{type:Boolean}},emits:["close","sent"],setup(m,{emit:B}){const T=m,H=B,L=U(!1),P=U(null),k=U(""),d=U(0);je(()=>[T.show,T.invoiceName],([W])=>{W&&(L.value=!1,P.value=null,k.value="",d.value=0)});const x=ge({url:"my_frappe_app.payment_utils.api_send_payment_request",onSuccess(W){L.value=!1,P.value=W,k.value="",d.value++,H("sent",W)},onError(W){L.value=!1,k.value=J(W)}});function N(){L.value=!0,k.value="",x.fetch({invoice_name:T.invoiceName,send_count:d.value+1})}function g(){H("close")}const v=V(()=>{var W;return((W=P.value)==null?void 0:W.status)==="success"}),A=V(()=>L.value?"Sendingâ€¦":v.value?"Resend Email":"Send Email"),ae=V(()=>L.value?rt:v.value?Kt:gt);function J(W){if(!W)return"Unknown error";let b=(W==null?void 0:W.message)||(W==null?void 0:W.exc)||"";if(b=b.replace(/<[^>]*>/g,"").trim(),b.includes("Traceback")||b.includes("\\n")){const I=b.split("\\n").map(S=>S.trim()).filter(S=>S.length>0&&!S.startsWith("Traceback")&&!S.startsWith('File "')&&!S.startsWith("During handling")&&!/^\\s{2,}/.test(S));b=I[I.length-1]||b.split("\\n")[0]}return b.includes("does not exist")?"Invoice not found. Please refresh and try again.":b.includes("not submitted")?"Invoice must be submitted before sending payment request.":b.includes("fully paid")?"This invoice is already fully paid.":b.includes("No email found")?b:b.includes("wkhtmltopdf")||b.includes("PDF")?"PDF generation failed. Please check server configuration.":b.includes("SMTP")||b.includes("smtp")||b.includes("sendmail")?"Email sending failed. Check outgoing email configuration in ERPNext.":b||"Something went wrong. Check ERPNext Error Log for details."}return(W,b)=>(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:Q(()=>[m.show?(t(),s("div",{key:0,class:"fixed inset-0 z-[999] flex items-end sm:items-center justify-center sm:p-4 bg-black/50 backdrop-blur-sm",onClick:le(g,["self"])},[e("div",Ui,[e("div",Oi,[e("div",qi,[e("div",Ei,[r(l(Xe),{class:"w-4 h-4 text-green-600"})]),e("div",Vi,[e("h3",zi,a(v.value?"Resend Payment Request":"Payment Request Email"),1),e("p",Bi,[j(a(m.invoiceName)+" ",1),v.value&&d.value>0?(t(),s("span",Hi," Sent "+a(d.value)+"x ",1)):p("",!0)])])]),e("button",{onClick:g,class:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 transition-colors flex-shrink-0 ml-2"},[r(l(Fe),{class:"w-4 h-4"})])]),e("div",Wi,[v.value?p("",!0):(t(),s("div",Yi,[...b[0]||(b[0]=[e("p",{class:"text-xs text-blue-700 leading-relaxed"},[j(" The invoice PDF will be emailed to the customer with a "),e("strong",null,"UPI QR Code"),j(" for instant payment via GPay, PhonePe, or any UPI app. ")],-1)])])),v.value&&!k.value?(t(),s("div",Gi,[...b[1]||(b[1]=[e("p",{class:"text-xs text-amber-700 leading-relaxed"},[e("strong",null,"Resend"),j(" will send a "),e("span",{class:"bg-amber-200 text-amber-800 px-1.5 py-0.5 rounded font-bold text-[10px]"}," PAYMENT REMINDER "),j(" email with the same invoice PDF. The customer will see it marked as a reminder. ")],-1)])])):p("",!0),k.value?(t(),s("div",Qi,[r(l(Zt),{class:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),e("div",Ji,[b[2]||(b[2]=e("p",{class:"text-xs font-black text-red-700 mb-1.5"}," Failed to send email ",-1)),e("p",Xi,a(k.value),1),b[3]||(b[3]=e("div",{class:"mt-2 pt-2 border-t border-red-100"},[e("p",{class:"text-[10px] text-red-400"},' ðŸ“„ Check: ERPNext â†’ Error Log â†’ search "PaymentRequest" ')],-1))])])):p("",!0),v.value?(t(),s("div",Ki,[e("div",Zi,[e("div",ed,[r(l(Ee),{class:"w-4 h-4 text-green-600"})]),e("div",td,[b[4]||(b[4]=e("p",{class:"text-sm font-black text-green-800"}," Email sent successfully! ",-1)),e("p",sd,a(P.value.customer),1)])]),e("div",ad,[e("div",ld,[e("div",nd,[r(l(Xe),{class:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}),e("div",od,[b[5]||(b[5]=e("p",{class:"text-[10px] font-bold text-gray-500 uppercase tracking-wide"}," Sent to ",-1)),e("p",rd,a(P.value.email),1)]),b[6]||(b[6]=e("span",{class:"text-[9px] font-black px-2 py-0.5 rounded-full bg-green-50 text-green-600 flex-shrink-0"}," âœ“ Delivered ",-1))]),e("div",id,[r(l(Ie),{class:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}),e("div",dd,[b[7]||(b[7]=e("p",{class:"text-[10px] font-bold text-gray-500 uppercase tracking-wide"}," PDF Attached ",-1)),e("p",cd,[j(" Invoice_"+a(P.value.invoice)+".pdf ",1),e("span",ud,"â€” "+a(P.value.pdf_kb)+" KB",1)])]),r(l(Ee),{class:"w-3.5 h-3.5 text-green-500 flex-shrink-0"})]),P.value.is_reminder?(t(),s("div",xd,[r(l(Te),{class:"w-3.5 h-3.5 text-amber-500 flex-shrink-0"}),e("p",pd," Sent as Reminder #"+a(P.value.send_count),1)])):p("",!0)])])])):p("",!0)]),e("div",md,[e("button",{onClick:g,disabled:L.value,class:"px-4 py-2.5 rounded-xl bg-gray-100 hover:bg-gray-200 disabled:opacity-50 text-xs font-bold text-gray-600 transition-colors"},a(v.value?"Done":"Cancel"),9,gd),b[8]||(b[8]=e("div",{class:"flex-1"},null,-1)),e("button",{onClick:N,disabled:L.value,class:C(["flex items-center gap-2 px-5 py-2.5 rounded-xl text-xs font-bold","transition-all shadow-sm disabled:opacity-50",v.value?"bg-amber-500 hover:bg-amber-600 text-white":"bg-green-600 hover:bg-green-700 text-white"])},[(t(),D(Ce(ae.value),{class:C(["w-3.5 h-3.5",L.value?"animate-spin":""])},null,8,["class"])),j(" "+a(A.value),1)],10,yd)])])])):p("",!0)]),_:1})]))}}),fd={class:"w-full min-w-0"},vd={class:"fixed top-4 right-4 z-[2000] flex flex-col gap-2 pointer-events-none max-w-xs w-full"},hd={class:"text-xs font-semibold leading-snug flex-1"},_d={class:"bg-white w-full sm:max-w-md sm:rounded-2xl rounded-t-2xl shadow-2xl overflow-hidden flex flex-col max-h-[92vh]"},kd={class:"flex items-center justify-between px-5 py-4 border-b border-gray-100 flex-shrink-0"},wd={class:"flex items-center gap-3 min-w-0"},$d={class:"p-2 bg-violet-50 rounded-xl flex-shrink-0"},Cd={class:"min-w-0"},Sd={class:"text-[10px] text-gray-400 font-medium truncate mt-0.5"},Dd={key:0,class:"ml-1.5 text-gray-400 font-semibold animate-pulse"},Pd={key:1,class:"ml-1.5 text-red-500 font-black"},Fd={key:0,class:"flex-1 flex flex-col items-center justify-center gap-3 p-8"},Td={key:1,class:"flex-1 flex flex-col items-center justify-center gap-4 p-8 text-center"},Nd={class:"p-4 bg-green-50 rounded-2xl"},Id={class:"text-xs text-gray-500"},jd={class:"font-black text-gray-800"},Rd={class:"flex-1 overflow-y-auto px-5 py-4 space-y-4"},Ad={class:"grid grid-cols-3 gap-2"},Md=["onClick"],Ld={class:"text-[11px] font-black"},Ud={class:"grid grid-cols-2 gap-3"},Od=["max"],qd={key:0,class:"space-y-3"},Ed={class:"flex items-center gap-2 text-violet-600 mb-1"},Vd={key:1,class:"space-y-3"},zd={class:"flex items-center gap-2 text-blue-600 mb-1"},Bd={class:"grid grid-cols-2 gap-3"},Hd={key:2,class:"bg-green-50 border border-green-100 rounded-xl px-4 py-3"},Wd={class:"flex items-center gap-2 text-green-700"},Yd={key:3,class:"flex items-start gap-2 bg-red-50 border border-red-200 rounded-xl px-3 py-3"},Gd={class:"text-xs text-red-700 font-medium leading-relaxed"},Qd={class:"flex items-center gap-2 px-5 py-4 border-t border-gray-100 bg-gray-50/80 flex-shrink-0"},Jd=["disabled"],Xd=["disabled"],Kd={key:0,class:"fixed inset-0 z-[1000] flex flex-col bg-gray-950"},Zd={class:"flex items-center gap-3 bg-gray-900 px-4 py-3 border-b border-white/10 flex-shrink-0"},ec={class:"p-1.5 bg-white/10 rounded-lg flex-shrink-0"},tc={class:"flex-1 min-w-0"},sc={class:"text-sm font-black text-white truncate"},ac={class:"text-emerald-400"},lc={class:"flex items-center gap-2 flex-shrink-0"},nc={key:0,class:"flex-1 flex items-center justify-center"},oc={class:"flex flex-col items-center gap-4"},rc={class:"relative"},ic={class:"w-14 h-14 rounded-2xl bg-white/10 flex items-center justify-center"},dc={key:1,class:"flex-1 flex items-center justify-center p-6"},cc={class:"bg-red-950/50 border border-red-800 rounded-2xl p-6 max-w-sm w-full text-center space-y-4"},uc={class:"text-xs text-red-500 break-words"},xc=["src"],pc={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-5 space-y-4"},mc={class:"flex items-start gap-3"},gc={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},yc={class:"text-sm font-black text-gray-900"},bc={class:"text-xs text-gray-500 mt-1 leading-relaxed"},fc={class:"flex gap-2 justify-end"},vc={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 px-3 sm:px-5 pt-3 pb-2"},hc={class:"bg-gradient-to-br from-gray-900 to-gray-700 rounded-xl p-3 text-white"},_c={class:"text-sm sm:text-base font-black leading-tight"},kc={class:"bg-gradient-to-br from-blue-600 to-blue-500 rounded-xl p-3 text-white"},wc={class:"text-sm sm:text-base font-black leading-tight"},$c={class:"bg-gradient-to-br from-green-600 to-green-500 rounded-xl p-3 text-white"},Cc={class:"text-sm sm:text-base font-black leading-tight"},Sc={class:"bg-gradient-to-br from-red-500 to-red-400 rounded-xl p-3 text-white"},Dc={class:"text-sm sm:text-base font-black leading-tight"},Pc={class:"border-b border-gray-100 bg-gray-50/60 space-y-2.5 px-3 sm:px-5 pt-2 pb-3"},Fc={class:"flex flex-wrap items-center gap-2"},Tc={class:"flex items-center gap-2 flex-1 min-w-0"},Nc={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},Ic={class:"min-w-0"},jc={class:"text-[10px] text-gray-400 font-medium mt-0.5"},Rc={key:0,class:"text-blue-500"},Ac={class:"relative"},Mc={class:"flex flex-wrap gap-2 items-center"},Lc={class:"flex gap-1 flex-wrap"},Uc=["onClick"],Oc={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},qc=["max"],Ec={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2 py-1.5 flex-shrink-0"},Vc=["min"],zc={key:0,class:"p-6 space-y-3"},Bc={key:1,class:"flex flex-col items-center justify-center py-20 text-center px-4"},Hc={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Wc={key:2},Yc={class:"divide-y divide-gray-100/80"},Gc=["onClick"],Qc={class:"sm:hidden flex flex-col gap-0.5 min-w-0"},Jc={class:"flex items-center gap-2 flex-wrap"},Xc={class:"text-xs font-black text-gray-900"},Kc={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold"},Zc={class:"text-[10px] text-gray-500 font-medium truncate"},e0={class:"flex items-center gap-3 flex-wrap mt-0.5"},t0={class:"text-[9px] text-gray-400 flex items-center gap-0.5"},s0={class:"text-[10px] font-black text-gray-900"},a0={key:0,class:"text-[9px] font-bold text-red-500"},l0={key:0,class:"mt-1.5 w-full bg-gray-200 rounded-full h-1"},n0={class:"hidden sm:flex items-center gap-1.5 min-w-0"},o0={class:"text-xs font-black text-gray-900 truncate"},r0={key:0,class:"text-[9px] bg-violet-100 text-violet-700 px-1.5 py-0.5 rounded-full font-bold flex-shrink-0"},i0={class:"hidden sm:block text-xs text-gray-600 font-medium truncate"},d0={class:"hidden sm:flex items-center gap-1 text-xs text-gray-500"},c0={class:"hidden sm:block text-xs font-black text-gray-900 text-right"},u0={class:"hidden sm:flex flex-col items-end gap-1"},x0={key:0,class:"w-16 bg-gray-200 rounded-full h-1"},p0={class:"hidden sm:flex justify-center"},m0=["onClick"],g0={key:1,class:"w-6 sm:w-8"},y0={class:"flex justify-center text-gray-400"},b0={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},f0={key:0,class:"space-y-2"},v0={key:1,class:"space-y-4"},h0={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},_0={class:"bg-white rounded-xl p-3 border border-gray-100"},k0={class:"bg-white rounded-xl p-3 border border-gray-100"},w0={class:"text-xs font-black text-green-700"},$0={class:"bg-white rounded-xl p-3 border border-gray-100"},C0={class:"text-xs font-black text-gray-800"},S0={class:"bg-white rounded-xl p-3 border border-gray-100"},D0={class:"text-xs font-black text-gray-800 truncate"},P0={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},F0={class:"divide-y divide-gray-100/80 max-h-52 overflow-y-auto overscroll-contain"},T0={class:"min-w-0"},N0={class:"text-xs font-semibold text-gray-800 truncate"},I0={class:"text-[9px] text-gray-400 truncate"},j0={key:0,class:"text-[9px] text-blue-500 font-semibold truncate"},R0={class:"text-xs text-gray-600 text-center font-medium"},A0={class:"text-xs text-gray-600 text-center"},M0={class:"text-xs font-black text-gray-900 text-right"},L0={class:"border-t border-gray-200 px-4 py-3 space-y-1.5"},U0={key:0,class:"flex justify-between text-xs text-gray-500"},O0={class:"flex justify-between items-center"},q0={class:"text-sm font-black text-gray-900"},E0={key:1,class:"flex justify-between items-center"},V0={class:"text-sm font-black text-red-600"},z0={key:1,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},B0={class:"divide-y divide-gray-100 max-h-36 overflow-y-auto"},H0={class:"text-xs text-gray-600 flex-shrink-0"},W0={class:"text-xs font-bold text-gray-500 truncate"},Y0={class:"text-xs font-black text-gray-900 flex-shrink-0"},G0={class:"flex flex-wrap gap-2 justify-end pt-1"},Q0=["onClick"],J0=["onClick"],X0=["onClick","disabled"],K0=["onClick","disabled"],Z0=["onClick","disabled"],eu=["onClick","disabled"],tu={key:2,class:"space-y-2"},su={key:0,class:"flex justify-center py-4"},au=Ne({__name:"SalesInvoiceList",props:{seller:{},customer:{},formatCurrency:{type:Function}},setup(m){const B=m,T=U([]);let H=0;function L(i,o="success"){const u=++H;T.value.push({id:u,message:i,type:o}),setTimeout(()=>{T.value=T.value.filter(R=>R.id!==u)},3500)}const P=U(""),k=U(""),d=U(""),x=U("all"),N=U(null),g=U(null),v=U(""),A=U(""),ae=U(!1),J=U("");function W(i){J.value=i,ae.value=!0}const b=U({show:!1,invoiceName:"",outstandingAmount:0,currency:"INR",loading:!1,fetchingFresh:!1,paymentMode:"UPI",amount:0,paymentDate:"",upiTransactionId:"",chequeNo:"",chequeDate:"",bankName:"",createdEntry:"",error:""});function I(){try{const i=document.cookie.match(/csrftoken=([^;]+)/);return i?i[1]:""}catch(i){return""}}function S(i){return we(this,null,function*(){const o=new Date().toISOString().split("T")[0];b.value={show:!0,invoiceName:i.name,outstandingAmount:i.outstanding_amount,currency:i.currency||"INR",loading:!1,fetchingFresh:!0,paymentMode:"UPI",amount:i.outstanding_amount,paymentDate:o,upiTransactionId:"",chequeNo:"",chequeDate:o,bankName:"",createdEntry:"",error:""};try{const u=yield fetch("/api/method/my_frappe_app.payment_utils.get_invoice_outstanding",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":I()},body:JSON.stringify({invoice_name:i.name})});if(u.ok){const R=yield u.json(),de=R==null?void 0:R.message;if(de){if(de.is_paid||de.outstanding_amount<=0){b.value.show=!1,L(`Invoice ${i.name} already fully paid. Please refresh.`,"error"),Z.reload();return}b.value.outstandingAmount=de.outstanding_amount,b.value.amount=de.outstanding_amount,b.value.currency=de.currency||"INR"}}}catch(u){console.warn("Fresh outstanding fetch failed, using cached data:",u)}finally{b.value.fetchingFresh=!1}})}function oe(){b.value.show=!1}const ye=[{key:"UPI",label:"UPI",icon:it,color:"violet"},{key:"Cheque",label:"Cheque",icon:qe,color:"blue"},{key:"Cash",label:"Cash",icon:ot,color:"green"}],z=U({show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}),E=U({show:!1,title:"",message:"",confirmLabel:"",confirmClass:"",onConfirm:()=>{}}),X=[{key:"all",label:"All"},{key:"Draft",label:"Draft"},{key:"Unpaid",label:"Unpaid"},{key:"Paid",label:"Paid"},{key:"Overdue",label:"Overdue"},{key:"Cancelled",label:"Cancelled"}],Z=Ke({doctype:"Sales Invoice",fields:["name","customer","customer_name","status","posting_date","grand_total","outstanding_amount","currency","docstatus","due_date","paid_amount","discount_amount","taxes_and_charges","is_return","return_against","debit_to","company"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),te=ge({url:"frappe.client.get",makeParams:i=>({doctype:"Sales Invoice",name:i.name}),onSuccess(i){g.value=i}}),Se=ge({url:"frappe.client.submit",onSuccess(){v.value="",A.value="",L("Invoice submitted successfully!","success"),Z.reload(),N.value&&te.fetch({name:N.value})},onError(i){v.value="",A.value="",L(G(i),"error")}}),fe=ge({url:"frappe.client.cancel",onSuccess(){v.value="",A.value="",L("Invoice cancelled.","info"),Z.reload(),N.value&&te.fetch({name:N.value})},onError(i){v.value="",A.value="",L(G(i),"error")}}),be=ge({url:"frappe.client.delete",onSuccess(){v.value="",A.value="",N.value=null,g.value=null,L("Invoice deleted.","info"),Z.reload()},onError(i){v.value="",A.value="",L(G(i),"error")}}),O=ge({url:"my_frappe_app.payment_utils.create_payment_entry",onSuccess(i){b.value.loading=!1,b.value.createdEntry=i.name,L(`Payment recorded! Entry: ${i.name}`,"success"),Z.reload(),N.value&&te.fetch({name:N.value})},onError(i){b.value.loading=!1;const o=G(i);b.value.error=o,o.toLowerCase().includes("already")&&o.toLowerCase().includes("paid")?(L("Invoice already paid. Refreshing...","info"),setTimeout(()=>{oe(),Z.reload()},1500)):L("Payment entry creation failed.","error")}});je(()=>[B.customer,B.seller],([i])=>{const o=[];i&&o.push(["customer","=",i]),Z.update({filters:o}),Z.reload()},{immediate:!0});const f=V(()=>{let i=Z.data||[];if(x.value!=="all"&&(x.value==="Draft"?i=i.filter(o=>o.docstatus===0):x.value==="Cancelled"?i=i.filter(o=>o.docstatus===2):i=i.filter(o=>o.status===x.value)),k.value&&(i=i.filter(o=>o.posting_date>=k.value)),d.value&&(i=i.filter(o=>o.posting_date<=d.value)),P.value.trim()){const o=P.value.toLowerCase();i=i.filter(u=>{var R,de;return((R=u.name)==null?void 0:R.toLowerCase().includes(o))||((de=u.customer_name)==null?void 0:de.toLowerCase().includes(o))})}return i}),$=V(()=>k.value!==""||d.value!==""),ce=V(()=>Z.loading),ee=V(()=>(Z.data||[]).length>0),ve=V(()=>{const o=(Z.data||[]).filter(u=>u.docstatus===1);return{total:o.reduce((u,R)=>u+(R.grand_total||0),0),outstanding:o.reduce((u,R)=>u+(R.outstanding_amount||0),0),paid:o.reduce((u,R)=>u+(R.paid_amount||0),0),overdue:o.filter(u=>u.status==="Overdue").length}});function F(){k.value="",d.value="",x.value="all",P.value=""}function c(i){return i.docstatus===2?{label:"Cancelled",theme:"gray",icon:Be}:i.docstatus===0?{label:"Draft",theme:"orange",icon:Ze}:i.status==="Paid"?{label:"Paid",theme:"green",icon:mt}:i.status==="Overdue"?{label:"Overdue",theme:"red",icon:Le}:i.status==="Unpaid"?{label:"Unpaid",theme:"blue",icon:Je}:i.status==="Partly Paid"?{label:"Part Paid",theme:"purple",icon:zt}:{label:i.status||"Unknown",theme:"gray",icon:Ie}}const y={gray:"bg-gray-100 text-gray-600",blue:"bg-blue-50 text-blue-700",green:"bg-green-50 text-green-700",red:"bg-red-50 text-red-700",orange:"bg-orange-50 text-orange-700",purple:"bg-violet-50 text-violet-700"};function n(i){return i.grand_total?Math.round(i.outstanding_amount/i.grand_total*100):0}function _(i){N.value===i?(N.value=null,g.value=null):(N.value=i,g.value=null,te.fetch({name:i}))}function G(i){if(!i)return"Unknown error";let o=(i==null?void 0:i.message)||(i==null?void 0:i.exc)||"";if(o=o.replace(/<[^>]*>/g,"").trim(),o.includes("Traceback")||o.includes(`
`)){const u=o.split(`
`).map(R=>R.trim()).filter(R=>R.length>0&&!R.startsWith("Traceback")&&!R.startsWith('File "')&&!R.startsWith("During handling")&&!/^\s{2,}/.test(R));o=u[u.length-1]||o.split(`
`)[0]}return o||"Backend error â€” check Frappe Error Log"}function re(i,o){return we(this,null,function*(){try{const u=yield fetch("/api/method/my_frappe_app.payment_utils.get_payment_account",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":I()},body:JSON.stringify({mode_of_payment:i,company:o})});if(u.ok){const R=yield u.json();return(R==null?void 0:R.message)||""}}catch(u){}return""})}function ie(i,o){return we(this,null,function*(){try{const u=yield fetch("/api/method/my_frappe_app.payment_utils.get_receivable_account",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":I()},body:JSON.stringify({company:i})});if(u.ok){const R=yield u.json();return(R==null?void 0:R.message)||""}}catch(u){}return""})}function xe(i,o){return we(this,null,function*(){try{const u=yield fetch("/api/method/my_frappe_app.payment_utils.get_company_account",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":I()},body:JSON.stringify({company:i,fieldname:o})});if(u.ok){const R=yield u.json();return(R==null?void 0:R.message)||""}}catch(u){}return""})}function ke(){return we(this,null,function*(){const i=b.value;if(i.error="",i.fetchingFresh){i.error="Please wait, loading latest invoice data...";return}if(!i.amount||i.amount<=0){i.error="Amount must be greater than 0";return}if(i.amount>i.outstandingAmount){i.error=`Amount cannot exceed outstanding â‚¹${i.outstandingAmount.toFixed(2)}`;return}if(!i.paymentDate){i.error="Payment date is required";return}if(i.paymentMode==="UPI"&&!i.upiTransactionId.trim()){i.error="UPI Transaction ID is required";return}if(i.paymentMode==="Cheque"){if(!i.chequeNo.trim()){i.error="Cheque number is required";return}if(!i.chequeDate){i.error="Cheque date is required";return}}i.loading=!0;const o={UPI:"UPI",Cheque:"Cheque",Cash:"Cash"},u=(Z.data||[]).find(st=>st.name===i.invoiceName),R=(u==null?void 0:u.company)||"",de=(u==null?void 0:u.customer)||"",K=(u==null?void 0:u.debit_to)||"",tt=o[i.paymentMode];let Ge=yield re(tt,R);if(!Ge){const st=i.paymentMode==="Cash"?"default_cash_account":"default_bank_account";Ge=yield xe(R,st)}const bt=K||(yield ie(R));if(!bt){i.loading=!1,i.error="Could not determine receivable account. Please check company settings.";return}if(!Ge){i.loading=!1,i.error=`Could not determine ${i.paymentMode} account. Please set default account for "${tt}" mode of payment.`;return}const Pe={doctype:"Payment Entry",payment_type:"Receive",mode_of_payment:tt,party_type:"Customer",party:de,party_name:(u==null?void 0:u.customer_name)||"",posting_date:i.paymentDate,paid_amount:i.amount,received_amount:i.amount,company:R,paid_from:bt,paid_to:Ge,references:[{reference_doctype:"Sales Invoice",reference_name:i.invoiceName,allocated_amount:i.amount}]};i.paymentMode==="UPI"?(Pe.reference_no=i.upiTransactionId,Pe.reference_date=i.paymentDate,Pe.remarks=`UPI Payment for ${i.invoiceName}. Transaction ID: ${i.upiTransactionId}`):i.paymentMode==="Cheque"?(Pe.reference_no=i.chequeNo,Pe.reference_date=i.chequeDate,Pe.remarks=`Cheque Payment for ${i.invoiceName}. Cheque No: ${i.chequeNo}${i.bankName?` | Bank: ${i.bankName}`:""}`):(Pe.reference_no=`CASH-${i.paymentDate}`,Pe.reference_date=i.paymentDate,Pe.remarks=`Cash Payment for ${i.invoiceName}`),O.fetch({doc:JSON.stringify(Pe)})})}function ne(){return we(this,null,function*(){try{const i=yield fetch("/api/method/my_frappe_app.payment_utils.get_print_format",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":I()},body:JSON.stringify({})});if(!i.ok)return null;const o=yield i.json();return(o==null?void 0:o.message)||null}catch(i){return null}})}function M(i){return we(this,null,function*(){z.value={show:!0,loading:!0,blobUrl:"",docName:i,printFormat:"Detectingâ€¦",error:""};try{const o=yield ne();z.value.printFormat=o!=null?o:"Server Default";const u=yield h(i,o);z.value={show:!0,loading:!1,blobUrl:URL.createObjectURL(u),docName:i,printFormat:o!=null?o:"Server Default",error:""}}catch(o){z.value={show:!0,loading:!1,blobUrl:"",docName:i,printFormat:"",error:(o==null?void 0:o.message)||"Failed to load PDF"}}})}function h(i,o){return we(this,null,function*(){const u=de=>{const K={doctype:"Sales Invoice",name:i,no_letterhead:"0",letterhead:"No Letterhead"};return de&&(K.format=de),"/api/method/frappe.utils.print_format.download_pdf?"+new URLSearchParams(K)};if(o){const de=yield fetch(u(o),{credentials:"include"});if(de.ok){const K=yield de.blob();if(K.size>500)return K}}const R=yield fetch(u(),{credentials:"include"});if(R.ok){const de=yield R.blob();if(de.size>500)return de}throw new Error(`PDF generation failed â€” HTTP ${R.status}`)})}function w(){z.value.blobUrl&&URL.revokeObjectURL(z.value.blobUrl),z.value={show:!1,loading:!1,blobUrl:"",docName:"",printFormat:"",error:""}}function _e(){if(!z.value.blobUrl)return;const i=document.createElement("a");i.href=z.value.blobUrl,i.download=`${z.value.docName}.pdf`,i.click()}function et(i){E.value=Ae({show:!0},i)}function jt(i){g.value&&et({title:"Submit Sales Invoice",message:`Submit ${i}? Accounting entries will be posted.`,confirmLabel:"Submit",confirmClass:"bg-blue-600 hover:bg-blue-700 text-white",onConfirm:()=>{E.value.show=!1,v.value=i,A.value="submit",Se.fetch({doc:g.value})}})}function Rt(i){et({title:"Cancel Sales Invoice",message:`Cancel ${i}? All accounting entries will be reversed.`,confirmLabel:"Cancel Invoice",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{E.value.show=!1,v.value=i,A.value="cancel",fe.fetch({doctype:"Sales Invoice",name:i})}})}function yt(i){et({title:"Delete Sales Invoice",message:`Permanently delete ${i}? This cannot be undone.`,confirmLabel:"Delete",confirmClass:"bg-red-700 hover:bg-red-800 text-white",onConfirm:()=>{E.value.show=!1,v.value=i,A.value="delete",be.fetch({doctype:"Sales Invoice",name:i})}})}return(i,o)=>(t(),s("div",fd,[(t(),D(Me,{to:"body"},[e("div",vd,[r(Pt,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 translate-x-8 scale-95","enter-to-class":"opacity-100 translate-x-0 scale-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 translate-x-8"},{default:Q(()=>[(t(!0),s(q,null,Y(T.value,u=>(t(),s("div",{key:u.id,class:C(["flex items-center gap-3 px-4 py-3 rounded-2xl shadow-xl pointer-events-auto","border backdrop-blur-sm",u.type==="success"?"bg-green-50 border-green-200 text-green-800":u.type==="error"?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"])},[e("div",{class:C(["p-1 rounded-lg flex-shrink-0",u.type==="success"?"bg-green-100":u.type==="error"?"bg-red-100":"bg-blue-100"])},[u.type==="success"?(t(),D(l(Ee),{key:0,class:"w-3.5 h-3.5"})):u.type==="error"?(t(),D(l(Te),{key:1,class:"w-3.5 h-3.5"})):(t(),D(l(Le),{key:2,class:"w-3.5 h-3.5"}))],2),e("p",hd,a(u.message),1)],2))),128))]),_:1})])])),r(bd,{"invoice-name":J.value,show:ae.value,onClose:o[0]||(o[0]=u=>ae.value=!1),onSent:o[1]||(o[1]=u=>L("Payment request email sent!","success"))},null,8,["invoice-name","show"]),(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:Q(()=>{var u;return[b.value.show?(t(),s("div",{key:0,class:"fixed inset-0 z-[999] flex items-end sm:items-center justify-center sm:p-4 bg-black/50 backdrop-blur-sm",onClick:le(oe,["self"])},[e("div",_d,[e("div",kd,[e("div",wd,[e("div",$d,[r(l(lt),{class:"w-4 h-4 text-violet-600"})]),e("div",Cd,[o[20]||(o[20]=e("h3",{class:"text-sm font-black text-gray-900"},"Record Payment",-1)),e("p",Sd,[j(a(b.value.invoiceName)+" ",1),b.value.fetchingFresh?(t(),s("span",Dd," Loading latest amount... ")):(t(),s("span",Pd," â‚¹"+a((u=b.value.outstandingAmount)==null?void 0:u.toLocaleString("en-IN",{minimumFractionDigits:2}))+" due ",1))])])]),e("button",{onClick:oe,class:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 transition-colors flex-shrink-0 ml-2"},[r(l(Fe),{class:"w-4 h-4"})])]),b.value.fetchingFresh?(t(),s("div",Fd,[r(l(ue),{class:"w-8 h-8 text-violet-400 animate-spin"}),o[21]||(o[21]=e("p",{class:"text-xs text-gray-500 font-semibold"},"Verifying invoice status...",-1))])):b.value.createdEntry?(t(),s("div",Td,[e("div",Nd,[r(l(Ee),{class:"w-10 h-10 text-green-600"})]),e("div",null,[o[23]||(o[23]=e("p",{class:"text-base font-black text-gray-900 mb-1"},"Payment Recorded!",-1)),e("p",Id,[o[22]||(o[22]=j(" Entry created and submitted: ",-1)),e("span",jd,a(b.value.createdEntry),1)])]),e("button",{onClick:oe,class:"mt-2 px-6 py-2.5 bg-gray-900 hover:bg-gray-700 text-white text-xs font-black rounded-xl transition-colors"}," Done ")])):(t(),s(q,{key:2},[e("div",Rd,[e("div",null,[o[24]||(o[24]=e("p",{class:"text-[10px] font-black text-gray-500 uppercase tracking-wide mb-2"},"Payment Mode",-1)),e("div",Ad,[(t(),s(q,null,Y(ye,R=>e("button",{key:R.key,onClick:de=>b.value.paymentMode=R.key,class:C(["flex flex-col items-center gap-1.5 py-3 px-2 rounded-xl border-2 transition-all",b.value.paymentMode===R.key?R.color==="violet"?"border-violet-500 bg-violet-50 text-violet-700":R.color==="blue"?"border-blue-500 bg-blue-50 text-blue-700":"border-green-500 bg-green-50 text-green-700":"border-gray-200 bg-white text-gray-500 hover:border-gray-300"])},[(t(),D(Ce(R.icon),{class:"w-5 h-5"})),e("span",Ld,a(R.label),1)],10,Md)),64))])]),e("div",Ud,[e("div",null,[o[25]||(o[25]=e("label",{class:"block text-[10px] font-black text-gray-500 uppercase tracking-wide mb-1.5"}," Amount (â‚¹) ",-1)),pe(e("input",{"onUpdate:modelValue":o[2]||(o[2]=R=>b.value.amount=R),type:"number",step:"0.01",max:b.value.outstandingAmount,class:"w-full px-3 py-2.5 text-sm font-black text-gray-900 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:border-gray-400 focus:bg-white transition-colors",placeholder:"0.00"},null,8,Od),[[me,b.value.amount,void 0,{number:!0}]])]),e("div",null,[o[26]||(o[26]=e("label",{class:"block text-[10px] font-black text-gray-500 uppercase tracking-wide mb-1.5"}," Payment Date ",-1)),pe(e("input",{"onUpdate:modelValue":o[3]||(o[3]=R=>b.value.paymentDate=R),type:"date",class:"w-full px-3 py-2.5 text-sm font-semibold text-gray-700 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:border-gray-400 focus:bg-white transition-colors cursor-pointer"},null,512),[[me,b.value.paymentDate]])])]),b.value.paymentMode==="UPI"?(t(),s("div",qd,[e("div",Ed,[r(l(it),{class:"w-4 h-4"}),o[27]||(o[27]=e("span",{class:"text-xs font-black"},"UPI Transaction Details",-1))]),e("div",null,[o[28]||(o[28]=e("label",{class:"block text-[10px] font-black text-gray-500 uppercase tracking-wide mb-1.5"}," UPI Transaction ID * ",-1)),pe(e("input",{"onUpdate:modelValue":o[4]||(o[4]=R=>b.value.upiTransactionId=R),type:"text",class:"w-full px-3 py-2.5 text-sm font-mono text-gray-900 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:border-violet-400 focus:bg-white transition-colors",placeholder:"e.g. 123456789012"},null,512),[[me,b.value.upiTransactionId]]),o[29]||(o[29]=e("p",{class:"text-[10px] text-gray-400 mt-1"}," Transaction ID from GPay / PhonePe / Paytm confirmation screen ",-1))])])):p("",!0),b.value.paymentMode==="Cheque"?(t(),s("div",Vd,[e("div",zd,[r(l(qe),{class:"w-4 h-4"}),o[30]||(o[30]=e("span",{class:"text-xs font-black"},"Cheque Details",-1))]),e("div",Bd,[e("div",null,[o[31]||(o[31]=e("label",{class:"block text-[10px] font-black text-gray-500 uppercase tracking-wide mb-1.5"}," Cheque No * ",-1)),pe(e("input",{"onUpdate:modelValue":o[5]||(o[5]=R=>b.value.chequeNo=R),type:"text",class:"w-full px-3 py-2.5 text-sm font-mono text-gray-900 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:border-blue-400 focus:bg-white transition-colors",placeholder:"123456"},null,512),[[me,b.value.chequeNo]])]),e("div",null,[o[32]||(o[32]=e("label",{class:"block text-[10px] font-black text-gray-500 uppercase tracking-wide mb-1.5"}," Cheque Date * ",-1)),pe(e("input",{"onUpdate:modelValue":o[6]||(o[6]=R=>b.value.chequeDate=R),type:"date",class:"w-full px-3 py-2.5 text-sm font-semibold text-gray-700 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:border-blue-400 focus:bg-white transition-colors cursor-pointer"},null,512),[[me,b.value.chequeDate]])])]),e("div",null,[o[33]||(o[33]=e("label",{class:"block text-[10px] font-black text-gray-500 uppercase tracking-wide mb-1.5"}," Bank Name (optional) ",-1)),pe(e("input",{"onUpdate:modelValue":o[7]||(o[7]=R=>b.value.bankName=R),type:"text",class:"w-full px-3 py-2.5 text-sm text-gray-900 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:border-blue-400 focus:bg-white transition-colors",placeholder:"e.g. HDFC Bank"},null,512),[[me,b.value.bankName]])])])):p("",!0),b.value.paymentMode==="Cash"?(t(),s("div",Hd,[e("div",Wd,[r(l(ot),{class:"w-4 h-4 flex-shrink-0"}),o[34]||(o[34]=e("p",{class:"text-xs font-semibold leading-relaxed"}," Cash payment entry will be created with today's date. Confirm the amount above and click Record Payment. ",-1))])])):p("",!0),b.value.error?(t(),s("div",Yd,[r(l(Te),{class:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),e("p",Gd,a(b.value.error),1)])):p("",!0)]),e("div",Qd,[e("button",{onClick:oe,disabled:b.value.loading,class:"px-4 py-2.5 rounded-xl bg-gray-100 hover:bg-gray-200 disabled:opacity-50 text-xs font-bold text-gray-600 transition-colors"}," Cancel ",8,Jd),o[35]||(o[35]=e("div",{class:"flex-1"},null,-1)),e("button",{onClick:ke,disabled:b.value.loading||b.value.fetchingFresh,class:"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-violet-600 hover:bg-violet-700 disabled:opacity-50 text-white text-xs font-black transition-colors shadow-sm"},[b.value.loading||b.value.fetchingFresh?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(Ee),{key:1,class:"w-3.5 h-3.5"})),j(" "+a(b.value.loading?"Processingâ€¦":b.value.fetchingFresh?"Verifying...":"Record Payment"),1)],8,Xd)])],64))])])):p("",!0)]}),_:1})])),(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-250 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>[z.value.show?(t(),s("div",Kd,[e("div",Zd,[e("div",ec,[r(l(Ve),{class:"w-4 h-4 text-white"})]),e("div",tc,[e("p",sc,a(z.value.docName),1),e("p",{class:C(["text-[10px] font-medium",z.value.loading?"text-gray-500 animate-pulse":"text-gray-400"])},[o[36]||(o[36]=j(" Format: ",-1)),e("span",ac,a(z.value.printFormat||"â€¦"),1)],2)]),e("div",lc,[z.value.blobUrl?(t(),s("button",{key:0,onClick:_e,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white text-xs font-bold transition-colors"},[r(l(It),{class:"w-3.5 h-3.5"}),o[37]||(o[37]=e("span",{class:"hidden sm:inline"},"Download",-1))])):p("",!0),e("button",{onClick:w,class:"flex items-center justify-center w-9 h-9 rounded-xl bg-white/10 hover:bg-red-500 text-white transition-colors"},[r(l(Fe),{class:"w-4 h-4"})])])]),z.value.loading?(t(),s("div",nc,[e("div",oc,[e("div",rc,[e("div",ic,[r(l(Ie),{class:"w-7 h-7 text-white/60"})]),o[38]||(o[38]=e("div",{class:"absolute inset-0 rounded-2xl border-2 border-emerald-400 border-t-transparent animate-spin"},null,-1))]),o[39]||(o[39]=e("p",{class:"text-sm font-bold text-white"},"Preparing PDFâ€¦",-1))])])):z.value.error?(t(),s("div",dc,[e("div",cc,[r(l(Te),{class:"w-8 h-8 text-red-400 mx-auto"}),o[40]||(o[40]=e("p",{class:"text-sm font-black text-red-300"},"PDF Load Failed",-1)),e("p",uc,a(z.value.error),1),e("button",{onClick:w,class:"w-full py-2 bg-red-700 hover:bg-red-600 text-white text-xs font-bold rounded-xl"},"Close")])])):z.value.blobUrl?(t(),s("iframe",{key:2,src:z.value.blobUrl,class:"flex-1 w-full border-0"},null,8,xc)):p("",!0)])):p("",!0)]),_:1})])),(t(),D(Me,{to:"body"},[r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0 scale-95"},{default:Q(()=>[E.value.show?(t(),s("div",{key:0,class:"fixed inset-0 z-[999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o[10]||(o[10]=le(u=>E.value.show=!1,["self"]))},[e("div",pc,[e("div",mc,[e("div",gc,[r(l(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",yc,a(E.value.title),1),e("p",bc,a(E.value.message),1)])]),e("div",fc,[e("button",{onClick:o[8]||(o[8]=u=>E.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"},"Go Back"),e("button",{onClick:o[9]||(o[9]=u=>E.value.onConfirm()),class:C(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",E.value.confirmClass])},a(E.value.confirmLabel),3)])])])):p("",!0)]),_:1})])),e("div",vc,[e("div",hc,[o[41]||(o[41]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Total Billed",-1)),e("p",_c,a(m.formatCurrency(ve.value.total)),1)]),e("div",kc,[o[42]||(o[42]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Outstanding",-1)),e("p",wc,a(m.formatCurrency(ve.value.outstanding)),1)]),e("div",$c,[o[43]||(o[43]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Collected",-1)),e("p",Cc,a(m.formatCurrency(ve.value.paid)),1)]),e("div",Sc,[o[44]||(o[44]=e("p",{class:"text-[9px] font-bold uppercase tracking-wider opacity-70 mb-1"},"Overdue",-1)),e("p",Dc,a(ve.value.overdue)+" invoice"+a(ve.value.overdue!==1?"s":""),1)])]),e("div",Pc,[e("div",Fc,[e("div",Tc,[e("div",Nc,[r(l(Ie),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",Ic,[o[45]||(o[45]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Invoices",-1)),e("p",jc,[j(a(f.value.length)+" record"+a(f.value.length!==1?"s":"")+" ",1),$.value||x.value!=="all"||P.value?(t(),s("span",Rc," (filtered)")):p("",!0)])])]),e("button",{onClick:o[11]||(o[11]=u=>l(Z).reload()),class:C(["flex items-center gap-1.5 px-2.5 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",ce.value?"opacity-60 pointer-events-none":""])},[r(l(ue),{class:C(["w-3.5 h-3.5",ce.value?"animate-spin":""])},null,8,["class"]),o[46]||(o[46]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),e("div",Ac,[r(l(He),{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"}),pe(e("input",{"onUpdate:modelValue":o[12]||(o[12]=u=>P.value=u),type:"text",placeholder:"Search invoice # or customerâ€¦",class:"w-full pl-8 pr-8 py-2 text-xs sm:text-sm bg-white border border-gray-200 rounded-lg outline-none focus:border-gray-400 transition-colors"},null,512),[[me,P.value]]),P.value?(t(),s("button",{key:0,onClick:o[13]||(o[13]=u=>P.value=""),class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-400"},[r(l(he),{class:"w-3.5 h-3.5"})])):p("",!0)]),e("div",Mc,[e("div",Lc,[(t(),s(q,null,Y(X,u=>e("button",{key:u.key,onClick:R=>x.value=u.key,class:C(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold transition-all whitespace-nowrap",x.value===u.key?"bg-gray-900 text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"])},a(u.label),11,Uc)),64))]),e("div",Oc,[o[47]||(o[47]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"From",-1)),pe(e("input",{type:"date","onUpdate:modelValue":o[14]||(o[14]=u=>k.value=u),max:d.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,qc),[[me,k.value]]),k.value?(t(),s("button",{key:0,onClick:o[15]||(o[15]=u=>k.value=""),class:"text-gray-300 hover:text-red-400"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),e("div",Ec,[o[48]||(o[48]=e("span",{class:"text-[9px] font-bold text-gray-400 uppercase select-none whitespace-nowrap"},"To",-1)),pe(e("input",{type:"date","onUpdate:modelValue":o[16]||(o[16]=u=>d.value=u),min:k.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Vc),[[me,d.value]]),d.value?(t(),s("button",{key:0,onClick:o[17]||(o[17]=u=>d.value=""),class:"text-gray-300 hover:text-red-400"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),$.value||x.value!=="all"||P.value?(t(),s("button",{key:0,onClick:F,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[r(l(he),{class:"w-3 h-3"}),o[49]||(o[49]=j(" Clear All ",-1))])):p("",!0)])]),ce.value&&!ee.value?(t(),s("div",zc,[(t(),s(q,null,Y(5,u=>e("div",{key:u,class:"h-16 bg-gray-100 rounded-xl animate-pulse"})),64))])):!ce.value&&f.value.length===0?(t(),s("div",Bc,[e("div",Hc,[r(l(Ie),{class:"w-10 h-10 text-gray-300"})]),o[50]||(o[50]=e("p",{class:"text-sm font-black text-gray-300"},"No Invoices Found",-1)),o[51]||(o[51]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters",-1))])):(t(),s("div",Wc,[o[69]||(o[69]=ut('<div class="hidden sm:grid grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_auto_36px] gap-2 px-5 py-2.5 border-b border-gray-100 bg-gray-50/40 text-[10px] font-black text-gray-400 uppercase tracking-widest"><span>Invoice #</span><span>Customer</span><span>Date</span><span class="text-right">Grand Total</span><span class="text-right">Outstanding</span><span class="text-center">Status</span><span class="text-center">Payment</span><span></span></div>',1)),e("div",Yc,[(t(!0),s(q,null,Y(f.value,u=>(t(),s("div",{key:u.name},[e("div",{onClick:R=>_(u.name),class:C(["grid gap-2 items-center px-3 sm:px-5 py-3 sm:py-3.5","grid-cols-[1fr_auto_36px] sm:grid-cols-[1fr_1.4fr_0.8fr_0.8fr_0.8fr_0.6fr_auto_36px]","hover:bg-gray-50/60 active:bg-gray-100/70 transition-colors cursor-pointer select-none",u.status==="Overdue"?"bg-red-50/30":""])},[e("div",Qc,[e("div",Jc,[e("span",Xc,a(u.name),1),u.is_return?(t(),s("span",Kc,"Return")):p("",!0),e("span",{class:C(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold",y[c(u).theme]])},[(t(),D(Ce(c(u).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+a(c(u).label),1)],2)]),e("span",Zc,a(u.customer_name),1),e("div",e0,[e("span",t0,[r(l(Re),{class:"w-2.5 h-2.5"}),j(a(u.posting_date),1)]),e("span",s0,a(m.formatCurrency(u.grand_total,u.currency)),1),u.outstanding_amount>0?(t(),s("span",a0,"Due: "+a(m.formatCurrency(u.outstanding_amount,u.currency)),1)):p("",!0)]),u.docstatus===1&&u.grand_total>0?(t(),s("div",l0,[e("div",{style:_t({width:`${100-n(u)}%`}),class:C(["h-1 rounded-full",u.status==="Paid"?"bg-green-500":u.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):p("",!0)]),e("div",n0,[e("span",o0,a(u.name),1),u.is_return?(t(),s("span",r0,"Return")):p("",!0)]),e("span",i0,a(u.customer_name),1),e("span",d0,[r(l(Re),{class:"w-3 h-3 flex-shrink-0 text-gray-400"}),j(a(u.posting_date),1)]),e("span",c0,a(m.formatCurrency(u.grand_total,u.currency)),1),e("div",u0,[e("span",{class:C(["text-xs font-black",u.outstanding_amount>0?"text-red-600":"text-gray-400"])},a(u.outstanding_amount>0?m.formatCurrency(u.outstanding_amount,u.currency):"â€”"),3),u.docstatus===1&&u.grand_total>0?(t(),s("div",x0,[e("div",{style:_t({width:`${100-n(u)}%`}),class:C(["h-1 rounded-full",u.status==="Paid"?"bg-green-500":u.status==="Overdue"?"bg-red-400":"bg-blue-400"])},null,6)])):p("",!0)]),e("span",p0,[e("span",{class:C(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold whitespace-nowrap",y[c(u).theme]])},[(t(),D(Ce(c(u).icon),{class:"w-2.5 h-2.5 flex-shrink-0"})),j(" "+a(c(u).label),1)],2)]),e("div",{class:"flex justify-center",onClick:o[18]||(o[18]=le(()=>{},["stop"]))},[u.docstatus===1&&u.outstanding_amount>0?(t(),s("button",{key:0,onClick:le(R=>S(u),["stop"]),class:"flex items-center gap-1 px-2 py-1.5 rounded-lg bg-violet-600 hover:bg-violet-700 active:bg-violet-800 text-white text-[10px] font-black transition-colors whitespace-nowrap shadow-sm",title:"Record Payment"},[r(l(lt),{class:"w-3 h-3 flex-shrink-0"}),o[52]||(o[52]=e("span",{class:"hidden sm:inline"},"Payment",-1))],8,m0)):(t(),s("span",g0))]),e("div",y0,[N.value===u.name?(t(),D(l(We),{key:0,class:"w-4 h-4 text-gray-700"})):(t(),D(l(Ye),{key:1,class:"w-4 h-4"}))])],10,Gc),r(De,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>{var R,de;return[N.value===u.name?(t(),s("div",b0,[l(te).loading&&!g.value?(t(),s("div",f0,[(t(),s(q,null,Y(4,K=>e("div",{key:K,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):g.value&&g.value.name===u.name?(t(),s("div",v0,[e("div",h0,[e("div",_0,[o[53]||(o[53]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Due Date",-1)),e("p",{class:C(["text-xs font-black",g.value.status==="Overdue"?"text-red-600":"text-gray-800"])},a(g.value.due_date||"â€”"),3)]),e("div",k0,[o[54]||(o[54]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid Amount",-1)),e("p",w0,a(m.formatCurrency(g.value.paid_amount||0,g.value.currency)),1)]),e("div",$0,[o[55]||(o[55]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Discount",-1)),e("p",C0,a(m.formatCurrency(g.value.discount_amount||0,g.value.currency)),1)]),e("div",S0,[o[56]||(o[56]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Tax Template",-1)),e("p",D0,a(g.value.taxes_and_charges||"â€”"),1)])]),(R=g.value.items)!=null&&R.length?(t(),s("div",P0,[o[60]||(o[60]=e("div",{class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest"},[e("span",null,"Item"),e("span",{class:"text-center"},"Qty"),e("span",{class:"text-center"},"Rate"),e("span",{class:"text-right"},"Amount")],-1)),e("div",F0,[(t(!0),s(q,null,Y(g.value.items,K=>(t(),s("div",{key:K.name,class:"grid grid-cols-[1fr_0.5fr_0.5fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",T0,[e("p",N0,a(K.item_name),1),e("p",I0,a(K.item_code),1),K.delivery_note?(t(),s("p",j0,"DN: "+a(K.delivery_note),1)):p("",!0)]),e("span",R0,a(K.qty)+" "+a(K.uom),1),e("span",A0,a(m.formatCurrency(K.rate,g.value.currency)),1),e("span",M0,a(m.formatCurrency(K.amount,g.value.currency)),1)]))),128))]),e("div",L0,[g.value.total_taxes_and_charges?(t(),s("div",U0,[o[57]||(o[57]=e("span",null,"Taxes",-1)),e("span",null,a(m.formatCurrency(g.value.total_taxes_and_charges,g.value.currency)),1)])):p("",!0),e("div",O0,[o[58]||(o[58]=e("span",{class:"text-xs font-black text-gray-500 uppercase tracking-wide"},"Grand Total",-1)),e("span",q0,a(m.formatCurrency(g.value.grand_total,g.value.currency)),1)]),g.value.outstanding_amount>0?(t(),s("div",E0,[o[59]||(o[59]=e("span",{class:"text-xs font-bold text-red-500 uppercase tracking-wide"},"Outstanding",-1)),e("span",V0,a(m.formatCurrency(g.value.outstanding_amount,g.value.currency)),1)])):p("",!0)])])):p("",!0),(de=g.value.payment_schedule)!=null&&de.length?(t(),s("div",z0,[o[61]||(o[61]=e("div",{class:"px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[10px] font-black text-gray-500 uppercase tracking-widest"},"Payment Schedule",-1)),e("div",B0,[(t(!0),s(q,null,Y(g.value.payment_schedule,K=>(t(),s("div",{key:K.name,class:"flex items-center justify-between gap-2 px-4 py-2.5"},[e("span",H0,a(K.due_date),1),e("span",W0,a(K.payment_term),1),e("span",Y0,a(m.formatCurrency(K.payment_amount,g.value.currency)),1),e("span",{class:C(["text-[9px] font-bold px-1.5 py-0.5 rounded-full flex-shrink-0",K.outstanding>0?"bg-red-50 text-red-600":"bg-green-50 text-green-600"])},a(K.outstanding>0?"Due":"Paid"),3)]))),128))])])):p("",!0),e("div",G0,[e("button",{onClick:le(K=>M(u.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-gray-900 hover:bg-gray-700 text-white text-xs font-bold transition-colors shadow-sm"},[r(l(Ve),{class:"w-3.5 h-3.5"}),o[62]||(o[62]=j("Print / PDF ",-1))],8,Q0),g.value.docstatus===1&&g.value.outstanding_amount>0?(t(),s("button",{key:0,onClick:o[19]||(o[19]=le(K=>S(g.value),["stop"])),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-violet-600 hover:bg-violet-700 text-white text-xs font-bold transition-colors shadow-sm"},[r(l(lt),{class:"w-3.5 h-3.5"}),o[63]||(o[63]=j(" Payment Received ",-1))])):p("",!0),g.value.docstatus===1&&g.value.outstanding_amount>0?(t(),s("button",{key:1,onClick:le(K=>W(u.name),["stop"]),class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-xs font-bold transition-colors shadow-sm"},[r(l(Xe),{class:"w-3.5 h-3.5"}),o[64]||(o[64]=j(" Send Payment Request ",-1))],8,J0)):p("",!0),g.value.docstatus===0?(t(),s("button",{key:2,onClick:le(K=>jt(u.name),["stop"]),disabled:v.value===u.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 disabled:opacity-60 text-white text-xs font-bold transition-colors"},[v.value===u.name&&A.value==="submit"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(gt),{key:1,class:"w-3.5 h-3.5"})),o[65]||(o[65]=j("Submit ",-1))],8,X0)):p("",!0),g.value.docstatus===0?(t(),s("button",{key:3,onClick:le(K=>yt(u.name),["stop"]),disabled:v.value===u.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[v.value===u.name&&A.value==="delete"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(ze),{key:1,class:"w-3.5 h-3.5"})),o[66]||(o[66]=j("Delete ",-1))],8,K0)):p("",!0),g.value.docstatus===1?(t(),s("button",{key:4,onClick:le(K=>Rt(u.name),["stop"]),disabled:v.value===u.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[v.value===u.name&&A.value==="cancel"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(Be),{key:1,class:"w-3.5 h-3.5"})),o[67]||(o[67]=j("Cancel ",-1))],8,Z0)):p("",!0),g.value.docstatus===2?(t(),s("button",{key:5,onClick:le(K=>yt(u.name),["stop"]),disabled:v.value===u.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[v.value===u.name&&A.value==="delete"?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(ze),{key:1,class:"w-3.5 h-3.5"})),o[68]||(o[68]=j("Delete ",-1))],8,eu)):p("",!0)])])):(t(),s("div",tu,[(t(),s(q,null,Y(3,K=>e("div",{key:K,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):p("",!0)]}),_:2},1024)]))),128))]),ce.value&&ee.value?(t(),s("div",su,[r(l(ue),{class:"w-5 h-5 text-gray-400 animate-spin"})])):p("",!0)]))]))}}),lu={class:"relative min-h-[200px]"},nu={class:"fixed top-4 right-4 z-[200] flex flex-col gap-2 pointer-events-none"},ou={class:"max-w-xs"},ru={key:0,class:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm"},iu={class:"bg-white rounded-2xl shadow-2xl w-full max-w-sm mx-auto p-6"},du={class:"flex items-start gap-3 mb-4"},cu={class:"p-2 bg-orange-50 rounded-xl flex-shrink-0"},uu={class:"text-sm font-black text-gray-900 mb-1"},xu={class:"text-xs text-gray-500 leading-relaxed"},pu={class:"flex gap-2 justify-end"},mu={class:"border-b border-gray-100 bg-gray-50/60"},gu={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pt-3 pb-2"},yu={class:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0"},bu={class:"p-1.5 sm:p-2 bg-violet-600 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},fu={class:"min-w-0"},vu={class:"text-[10px] sm:text-xs text-gray-400 font-medium"},hu={key:0},_u={key:0,class:"grid grid-cols-2 gap-2 px-3 sm:px-5 pb-2.5"},ku={class:"bg-green-50 border border-green-100 rounded-xl px-3 py-2.5 flex items-center gap-2"},wu={class:"min-w-0"},$u={class:"text-xs sm:text-sm font-black text-green-700 truncate"},Cu={class:"ml-auto text-[9px] font-black text-green-400 bg-green-100 px-1.5 py-0.5 rounded-full"},Su={class:"bg-red-50 border border-red-100 rounded-xl px-3 py-2.5 flex items-center gap-2"},Du={class:"min-w-0"},Pu={class:"text-xs sm:text-sm font-black text-red-600 truncate"},Fu={class:"ml-auto text-[9px] font-black text-red-400 bg-red-100 px-1.5 py-0.5 rounded-full"},Tu={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pb-3"},Nu={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-1 min-w-[140px] max-w-[260px]"},Iu={class:"flex items-center gap-1 bg-white border border-gray-200 rounded-lg p-1 flex-shrink-0"},ju=["onClick"],Ru={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},Au=["max"],Mu={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},Lu=["min"],Uu={key:0,class:"divide-y divide-gray-100"},Ou={key:1,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-6"},qu={class:"p-4 bg-violet-50 rounded-2xl mb-4"},Eu={key:2,class:"flex flex-col items-center justify-center py-16 text-center px-6"},Vu={key:3,class:"divide-y divide-gray-100/80"},zu=["onClick"],Bu={class:"flex-1 min-w-0"},Hu={class:"flex items-center gap-1.5 flex-wrap"},Wu={class:"text-xs sm:text-sm font-black text-gray-900 truncate"},Yu={class:"flex items-center gap-1.5 mt-0.5 flex-wrap"},Gu={class:"text-[10px] text-gray-400 font-medium"},Qu={key:0,class:"text-[10px] text-gray-300"},Ju={key:1,class:"text-[10px] text-gray-400 font-medium truncate"},Xu={key:2,class:"text-[10px] text-gray-300"},Ku={key:3,class:"text-[10px] text-violet-500 font-semibold truncate"},Zu={class:"text-right flex-shrink-0"},ex={key:0,class:"border-t border-gray-100 bg-gray-50/70 px-3 sm:px-6 py-4"},tx={key:0,class:"space-y-2"},sx={key:1,class:"space-y-4"},ax={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},lx={class:"bg-white rounded-xl p-3 border border-gray-100"},nx={class:"text-xs font-black text-gray-800 truncate"},ox={class:"bg-white rounded-xl p-3 border border-gray-100"},rx={class:"text-xs font-black text-gray-800"},ix={class:"bg-white rounded-xl p-3 border border-gray-100"},dx={class:"text-xs font-black text-violet-600 truncate"},cx={class:"bg-white rounded-xl p-3 border border-gray-100"},ux={class:"text-xs font-black text-gray-800"},xx={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},px={class:"bg-white rounded-xl p-3 border border-gray-100"},mx={class:"text-xs font-semibold text-gray-700 truncate"},gx={class:"bg-white rounded-xl p-3 border border-gray-100"},yx={class:"text-xs font-semibold text-gray-700 truncate"},bx={key:0,class:"bg-white border border-gray-100 rounded-xl overflow-hidden"},fx={class:"px-4 py-2.5 bg-gray-50 border-b border-gray-100 text-[10px] font-black text-gray-500 uppercase tracking-widest flex items-center gap-2"},vx={class:"divide-y divide-gray-100/80 max-h-44 overflow-y-auto overscroll-contain"},hx={class:"min-w-0"},_x={class:"text-xs font-semibold text-gray-800 truncate"},kx={class:"text-[9px] text-gray-400 truncate"},wx={class:"text-center"},$x={class:"text-xs font-black text-red-500"},Cx={class:"text-right"},Sx={class:"text-xs font-black text-green-700"},Dx={key:1,class:"bg-amber-50 border border-amber-100 rounded-xl px-4 py-3"},Px={class:"text-xs text-amber-800 font-medium leading-relaxed"},Fx={class:"flex flex-wrap gap-2 justify-end pt-1"},Tx=["onClick","disabled"],Nx=["onClick","disabled"],Ix={key:2,class:"space-y-2"},jx={key:4,class:"flex justify-center py-4"},Rx=Ne({__name:"PaymentEntryList",props:{customer:{},seller:{},formatCurrency:{type:Function}},setup(m){const B=m,T=U([]);let H=0;function L(O,f="success"){const $=++H;T.value.push({id:$,message:O,type:f}),setTimeout(()=>{T.value=T.value.filter(ce=>ce.id!==$)},3500)}const P=U(""),k=U(""),d=U(""),x=U("all"),N=U(null),g=U(null),v=U(""),A=U({show:!1,title:"",message:"",confirmLabel:"Confirm",confirmClass:"",onConfirm:()=>{}});function ae(O){A.value=Ae(ht(Ae({},A.value),{show:!0}),O)}const J=Ke({doctype:"Payment Entry",fields:["name","party","party_name","payment_type","mode_of_payment","paid_amount","received_amount","docstatus","posting_date","reference_no","reference_date","remarks","paid_from","paid_to","company"],filters:[],orderBy:"posting_date desc",pageLength:200,auto:!1}),W=ge({url:"frappe.client.get",makeParams:O=>({doctype:"Payment Entry",name:O.name}),onSuccess(O){g.value=O}}),b=ge({url:"frappe.client.cancel",onSuccess(){v.value="",L("Payment Entry cancelled successfully!","success"),J.reload(),N.value&&W.fetch({name:N.value})},onError(O){v.value="",L(S(O),"error")}}),I=ge({url:"frappe.client.delete",onSuccess(){v.value="",L("Payment Entry deleted!","success"),N.value=null,g.value=null,J.reload()},onError(O){v.value="",L(S(O),"error")}});function S(O){try{const f=(O==null?void 0:O.exc)||(O==null?void 0:O.message)||"";return(String(f).split(`
`).filter(Boolean).at(-1)||"").replace(/^[A-Za-z.]+:\s*/,"").slice(0,120)||"Something went wrong"}catch(f){return"Something went wrong"}}function oe(O){const f=(O||"").toLowerCase();return f.includes("upi")||f.includes("phone")||f.includes("mobile")?it:f.includes("cheque")||f.includes("check")?qe:f.includes("bank")||f.includes("transfer")||f.includes("neft")||f.includes("rtgs")?Ht:f.includes("wallet")?ts:ot}const ye=V(()=>k.value!==""||d.value!==""),z=V(()=>{let O=J.data||[];if(x.value!=="all"&&(O=O.filter(f=>f.payment_type===x.value)),k.value&&(O=O.filter(f=>f.posting_date>=k.value)),d.value&&(O=O.filter(f=>f.posting_date<=d.value)),P.value.trim()){const f=P.value.toLowerCase();O=O.filter($=>($.name||"").toLowerCase().includes(f)||($.party_name||"").toLowerCase().includes(f)||($.mode_of_payment||"").toLowerCase().includes(f)||($.reference_no||"").toLowerCase().includes(f))}return O}),E=V(()=>{const f=(J.data||[]).filter(ee=>ee.docstatus===1),$=f.filter(ee=>ee.payment_type==="Receive"),ce=f.filter(ee=>ee.payment_type==="Pay");return{totalReceived:$.reduce((ee,ve)=>ee+Number(ve.received_amount||0),0),totalPaid:ce.reduce((ee,ve)=>ee+Number(ve.paid_amount||0),0),countReceived:$.length,countPaid:ce.length,currency:"INR"}}),X=V(()=>J.loading),Z=V(()=>(J.data||[]).length>0);je(()=>B.customer,O=>{O&&(J.update({filters:[["party_type","=","Customer"],["party","=",O]]}),J.reload())},{immediate:!0});function te(O){N.value===O?(N.value=null,g.value=null):(N.value=O,g.value=null,W.fetch({name:O}))}function Se(O){ae({title:"Cancel Payment Entry",message:`Are you sure you want to cancel ${O}? This will reverse the accounting entries.`,confirmLabel:"Yes, Cancel",confirmClass:"bg-orange-600 hover:bg-orange-700 text-white",onConfirm:()=>{A.value.show=!1,v.value=O,b.submit({doctype:"Payment Entry",name:O})}})}function fe(O){ae({title:"Delete Payment Entry",message:`Delete ${O} permanently? This cannot be undone.`,confirmLabel:"Yes, Delete",confirmClass:"bg-red-600 hover:bg-red-700 text-white",onConfirm:()=>{A.value.show=!1,v.value=O,I.submit({doctype:"Payment Entry",name:O})}})}function be(){k.value="",d.value="",P.value="",x.value="all"}return(O,f)=>(t(),s("div",lu,[e("div",nu,[r(Pt,{name:"toast"},{default:Q(()=>[(t(!0),s(q,null,Y(T.value,$=>(t(),s("div",{key:$.id,class:C(["flex items-center gap-2 px-4 py-3 rounded-2xl shadow-xl text-sm font-semibold pointer-events-auto",$.type==="success"?"bg-green-600 text-white":$.type==="error"?"bg-red-600 text-white":"bg-gray-800 text-white"])},[$.type==="success"?(t(),D(l(mt),{key:0,class:"w-4 h-4 flex-shrink-0"})):$.type==="error"?(t(),D(l(Te),{key:1,class:"w-4 h-4 flex-shrink-0"})):(t(),D(l(Qt),{key:2,class:"w-4 h-4 flex-shrink-0"})),e("span",ou,a($.message),1)],2))),128))]),_:1})]),r(De,{name:"fade"},{default:Q(()=>[A.value.show?(t(),s("div",ru,[e("div",iu,[e("div",du,[e("div",cu,[r(l(Te),{class:"w-5 h-5 text-orange-500"})]),e("div",null,[e("h3",uu,a(A.value.title),1),e("p",xu,a(A.value.message),1)])]),e("div",pu,[e("button",{onClick:f[0]||(f[0]=$=>A.value.show=!1),class:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-xs font-bold text-gray-600 transition-colors"}," Cancel "),e("button",{onClick:f[1]||(f[1]=$=>A.value.onConfirm()),class:C(["px-4 py-2 rounded-xl text-xs font-bold transition-colors",A.value.confirmClass])},a(A.value.confirmLabel),3)])])])):p("",!0)]),_:1}),e("div",mu,[e("div",gu,[e("div",yu,[e("div",bu,[r(l(Je),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",fu,[f[9]||(f[9]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Payment Entries",-1)),e("p",vu,[j(a(z.value.length)+" entries ",1),x.value!=="all"?(t(),s("span",hu," Â· "+a(x.value==="Receive"?"Received only":"Paid only"),1)):p("",!0)])])]),e("button",{onClick:f[2]||(f[2]=$=>l(J).reload()),class:C(["flex items-center gap-1.5 px-2.5 sm:px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-600 transition-all",X.value?"opacity-60 pointer-events-none":""])},[r(l(ue),{class:C(["w-3.5 h-3.5 flex-shrink-0",X.value?"animate-spin":""])},null,8,["class"]),f[10]||(f[10]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)]),Z.value?(t(),s("div",_u,[e("div",ku,[r(l(Wt),{class:"w-4 h-4 text-green-500 flex-shrink-0"}),e("div",wu,[f[11]||(f[11]=e("p",{class:"text-[9px] font-bold text-green-500 uppercase tracking-wide"},"Total Received",-1)),e("p",$u,a(B.formatCurrency(E.value.totalReceived,E.value.currency)),1)]),e("span",Cu,a(E.value.countReceived),1)]),e("div",Su,[r(l(Yt),{class:"w-4 h-4 text-red-400 flex-shrink-0"}),e("div",Du,[f[12]||(f[12]=e("p",{class:"text-[9px] font-bold text-red-400 uppercase tracking-wide"},"Total Paid",-1)),e("p",Pu,a(B.formatCurrency(E.value.totalPaid,E.value.currency)),1)]),e("span",Fu,a(E.value.countPaid),1)])])):p("",!0),e("div",Tu,[e("div",Nu,[r(l(He),{class:"w-3.5 h-3.5 text-gray-300 flex-shrink-0"}),pe(e("input",{"onUpdate:modelValue":f[3]||(f[3]=$=>P.value=$),placeholder:"Search entriesâ€¦",class:"text-[10px] sm:text-xs text-gray-700 bg-transparent outline-none border-none w-full min-w-0 font-medium placeholder-gray-300"},null,512),[[me,P.value]]),P.value?(t(),s("button",{key:0,onClick:f[4]||(f[4]=$=>P.value=""),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),e("div",Iu,[(t(),s(q,null,Y([{key:"all",label:"All"},{key:"Receive",label:"Received"},{key:"Pay",label:"Paid"}],$=>e("button",{key:$.key,onClick:ce=>x.value=$.key,class:C(["px-2.5 py-1 rounded-md text-[10px] font-bold transition-all whitespace-nowrap",x.value===$.key?$.key==="Receive"?"bg-green-600 text-white shadow-sm":$.key==="Pay"?"bg-red-500 text-white shadow-sm":"bg-gray-900 text-white shadow-sm":"text-gray-400 hover:text-gray-600"])},a($.label),11,ju)),64))]),e("div",Ru,[f[13]||(f[13]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"From",-1)),pe(e("input",{type:"date","onUpdate:modelValue":f[5]||(f[5]=$=>k.value=$),max:d.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Au),[[me,k.value]]),k.value?(t(),s("button",{key:0,onClick:f[6]||(f[6]=$=>k.value=""),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),e("div",Mu,[f[14]||(f[14]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"To",-1)),pe(e("input",{type:"date","onUpdate:modelValue":f[7]||(f[7]=$=>d.value=$),min:k.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,Lu),[[me,d.value]]),d.value?(t(),s("button",{key:0,onClick:f[8]||(f[8]=$=>d.value=""),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),ye.value||P.value||x.value!=="all"?(t(),s("button",{key:0,onClick:be,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[r(l(he),{class:"w-3 h-3"}),f[15]||(f[15]=j(" Clear ",-1))])):p("",!0)])]),X.value&&!Z.value?(t(),s("div",Uu,[(t(),s(q,null,Y(5,$=>e("div",{key:$,class:"flex items-center gap-3 px-4 sm:px-6 py-4"},[...f[16]||(f[16]=[ut('<div class="w-8 h-8 bg-gray-100 rounded-xl animate-pulse flex-shrink-0" data-v-c9d2b67c></div><div class="flex-1 space-y-1.5" data-v-c9d2b67c><div class="h-3 bg-gray-100 rounded-md animate-pulse w-2/5" data-v-c9d2b67c></div><div class="h-2.5 bg-gray-100 rounded-md animate-pulse w-3/5" data-v-c9d2b67c></div></div><div class="h-3 bg-gray-100 rounded-md animate-pulse w-20" data-v-c9d2b67c></div>',3)])])),64))])):!X.value&&!Z.value?(t(),s("div",Ou,[e("div",qu,[r(l(Je),{class:"w-10 h-10 text-violet-200"})]),f[17]||(f[17]=e("p",{class:"text-sm font-black text-gray-400"},"No Payment Entries",-1)),f[18]||(f[18]=e("p",{class:"text-xs text-gray-300 mt-1.5 max-w-xs leading-relaxed"}," Payment entries for this customer will appear here once recorded. ",-1))])):!X.value&&Z.value&&z.value.length===0?(t(),s("div",Eu,[r(l(He),{class:"w-8 h-8 text-gray-200 mb-3"}),f[19]||(f[19]=e("p",{class:"text-sm font-black text-gray-400"},"No results",-1)),f[20]||(f[20]=e("p",{class:"text-xs text-gray-300 mt-1"},"Try adjusting your filters.",-1)),e("button",{onClick:be,class:"mt-3 text-xs font-bold text-violet-600 hover:underline"},"Clear filters")])):(t(),s("div",Vu,[(t(!0),s(q,null,Y(z.value,$=>(t(),s("div",{key:$.name},[e("div",{onClick:ce=>te($.name),class:C(["flex items-center gap-2 sm:gap-3 px-3 sm:px-5 py-3 cursor-pointer transition-all select-none",N.value===$.name?"bg-violet-50/40":"hover:bg-gray-50/70 active:bg-gray-100/60"])},[e("div",{class:C(["w-8 h-8 sm:w-9 sm:h-9 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm",$.payment_type==="Receive"?"bg-green-100 text-green-600":$.payment_type==="Pay"?"bg-red-100 text-red-500":"bg-gray-100 text-gray-500"])},[(t(),D(Ce(oe($.mode_of_payment)),{class:"w-4 h-4 sm:w-4.5 sm:h-4.5"}))],2),e("div",Bu,[e("div",Hu,[e("span",Wu,a($.name),1),e("span",{class:C(["text-[9px] font-black px-1.5 py-0.5 rounded-full leading-none whitespace-nowrap",$.payment_type==="Receive"?"bg-green-100 text-green-700":"bg-red-100 text-red-600"])},a($.payment_type==="Receive"?"â†“ Received":"â†‘ Paid"),3),e("span",{class:C(["text-[9px] font-bold px-1.5 py-0.5 rounded-full leading-none whitespace-nowrap",$.docstatus===1?"bg-emerald-50 text-emerald-600":$.docstatus===2?"bg-gray-100 text-gray-400":"bg-orange-50 text-orange-500"])},a($.docstatus===1?"Submitted":$.docstatus===2?"Cancelled":"Draft"),3)]),e("div",Yu,[r(l(Re),{class:"w-2.5 h-2.5 text-gray-300 flex-shrink-0"}),e("span",Gu,a($.posting_date),1),$.mode_of_payment?(t(),s("span",Qu,"Â·")):p("",!0),$.mode_of_payment?(t(),s("span",Ju,a($.mode_of_payment),1)):p("",!0),$.reference_no?(t(),s("span",Xu,"Â·")):p("",!0),$.reference_no?(t(),s("span",Ku,"Ref: "+a($.reference_no),1)):p("",!0)])]),e("div",Zu,[e("p",{class:C(["text-xs sm:text-sm font-black",$.payment_type==="Receive"?"text-green-700":"text-red-600"])},a(B.formatCurrency(Number($.received_amount||$.paid_amount||0),"INR")),3)]),(t(),D(Ce(N.value===$.name?l(We):l(Ye)),{class:"w-4 h-4 text-gray-300 flex-shrink-0 transition-transform"}))],10,zu),r(De,{"enter-active-class":"transition-all duration-200 ease-out","leave-active-class":"transition-all duration-150 ease-in","enter-from-class":"opacity-0 -translate-y-1","leave-to-class":"opacity-0 -translate-y-1"},{default:Q(()=>{var ce;return[N.value===$.name?(t(),s("div",ex,[l(W).loading&&!g.value?(t(),s("div",tx,[(t(),s(q,null,Y(4,ee=>e("div",{key:ee,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))])):g.value&&g.value.name===$.name?(t(),s("div",sx,[e("div",ax,[e("div",lx,[f[21]||(f[21]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Mode",-1)),e("p",nx,a(g.value.mode_of_payment||"â€”"),1)]),e("div",ox,[f[22]||(f[22]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid Amount",-1)),e("p",rx,a(B.formatCurrency(Number(g.value.paid_amount||0),g.value.currency)),1)]),e("div",ix,[f[23]||(f[23]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Ref No.",-1)),e("p",dx,a(g.value.reference_no||"â€”"),1)]),e("div",cx,[f[24]||(f[24]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Ref Date",-1)),e("p",ux,a(g.value.reference_date||"â€”"),1)])]),e("div",xx,[e("div",px,[f[25]||(f[25]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid From",-1)),e("p",mx,a(g.value.paid_from||"â€”"),1)]),e("div",gx,[f[26]||(f[26]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-1"},"Paid To",-1)),e("p",yx,a(g.value.paid_to||"â€”"),1)])]),(ce=g.value.references)!=null&&ce.length?(t(),s("div",bx,[e("div",fx,[r(l(qe),{class:"w-3 h-3"}),f[27]||(f[27]=j(" Invoice References ",-1))]),e("div",vx,[(t(!0),s(q,null,Y(g.value.references,ee=>(t(),s("div",{key:ee.name,class:"grid grid-cols-[1fr_0.6fr_0.7fr] gap-2 px-4 py-2.5 items-center"},[e("div",hx,[e("p",_x,a(ee.reference_name),1),e("p",kx,a(ee.reference_doctype),1)]),e("div",wx,[f[28]||(f[28]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-0.5"},"Outstanding",-1)),e("p",$x,a(B.formatCurrency(Number(ee.outstanding_amount||0),g.value.currency)),1)]),e("div",Cx,[f[29]||(f[29]=e("p",{class:"text-[9px] text-gray-400 font-bold uppercase tracking-wide mb-0.5"},"Allocated",-1)),e("p",Sx,a(B.formatCurrency(Number(ee.allocated_amount||0),g.value.currency)),1)])]))),128))])])):p("",!0),g.value.remarks?(t(),s("div",Dx,[f[30]||(f[30]=e("p",{class:"text-[9px] text-amber-600 font-bold uppercase tracking-wide mb-1"},"Remarks",-1)),e("p",Px,a(g.value.remarks),1)])):p("",!0),e("div",Fx,[g.value.docstatus===1?(t(),s("button",{key:0,onClick:le(ee=>Se($.name),["stop"]),disabled:v.value===$.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-orange-50 hover:bg-orange-100 disabled:opacity-60 text-orange-600 text-xs font-bold border border-orange-200 transition-colors"},[v.value===$.name?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(Be),{key:1,class:"w-3.5 h-3.5"})),f[31]||(f[31]=j(" Cancel ",-1))],8,Tx)):p("",!0),g.value.docstatus===0||g.value.docstatus===2?(t(),s("button",{key:1,onClick:le(ee=>fe($.name),["stop"]),disabled:v.value===$.name,class:"flex items-center gap-1.5 px-3 py-2 rounded-xl bg-red-50 hover:bg-red-100 disabled:opacity-60 text-red-600 text-xs font-bold border border-red-200 transition-colors"},[v.value===$.name?(t(),D(l(ue),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(t(),D(l(ze),{key:1,class:"w-3.5 h-3.5"})),f[32]||(f[32]=j(" Delete ",-1))],8,Nx)):p("",!0)])])):(t(),s("div",Ix,[(t(),s(q,null,Y(3,ee=>e("div",{key:ee,class:"h-8 bg-gray-200/60 rounded-lg animate-pulse"})),64))]))])):p("",!0)]}),_:2},1024)]))),128))])),X.value&&Z.value?(t(),s("div",jx,[r(l(ue),{class:"w-5 h-5 text-gray-400 animate-spin"})])):p("",!0)]))}}),Ax=Dt(Rx,[["__scopeId","data-v-c9d2b67c"]]),Mx={class:"w-full min-w-0 max-w-7xl mx-auto font-sans text-gray-900 px-0 sm:px-4 md:px-6 pt-[env(safe-area-inset-top,0px)] pb-[calc(120px+env(safe-area-inset-bottom,0px))] sm:pb-[env(safe-area-inset-bottom,16px)] space-y-3 sm:space-y-4 md:space-y-5"},Lx={class:"hidden sm:flex items-center justify-between gap-2 pt-1 flex-wrap"},Ux={class:"flex gap-1 bg-gray-100 p-1 rounded-xl"},Ox=["onClick"],qx={class:"px-2 sm:px-0"},Ex={class:"bg-white border-y sm:border border-gray-100 sm:rounded-2xl shadow-sm overflow-hidden w-full min-w-0"},Vx={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24 text-center px-6"},zx={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Bx={class:"hidden sm:block border-b border-gray-100 overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden"},Hx={class:"flex min-w-max"},Wx=["onClick"],Yx={key:0,class:"absolute bottom-0 left-0 right-0 h-[2.5px] bg-gray-900 rounded-t-full"},Gx={key:0,class:"sm:hidden flex items-center gap-2 px-3 py-2.5 border-b border-gray-100 bg-gray-50/60"},Qx={class:"text-sm font-black text-gray-800"},Jx={key:1,class:"flex flex-col items-center justify-center py-16 sm:py-24 text-center px-6"},Xx={class:"p-4 bg-gray-100 rounded-2xl mb-4"},Kx={key:2,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},Zx={class:"w-full flex justify-end px-3 pb-4"},ep={class:"p-4 bg-gray-100 rounded-2xl mb-4"},tp={class:"border-b border-gray-100 bg-gray-50/60"},sp={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pt-3 pb-2"},ap={class:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0"},lp={class:"p-1.5 sm:p-2 bg-gray-900 rounded-lg sm:rounded-xl text-white shadow flex-shrink-0"},np={class:"min-w-0"},op={class:"flex items-center gap-1.5 flex-wrap mt-0.5"},rp={class:"text-[10px] sm:text-xs text-gray-400 font-medium"},ip={key:0},dp={key:1},cp={key:2},up={key:3},xp={class:"flex items-center gap-1.5 flex-shrink-0 flex-wrap justify-end"},pp={class:"flex items-center justify-center w-5 h-5 bg-white/20 rounded-md flex-shrink-0"},mp=["disabled","title"],gp={class:"flex flex-wrap items-center gap-2 px-3 sm:px-5 pb-3"},yp={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},bp=["max"],fp={class:"flex items-center gap-1.5 bg-white border border-gray-200 rounded-lg px-2.5 py-1.5 flex-shrink-0"},vp=["min"],hp={key:1,class:"text-[10px] text-gray-400 font-semibold"},_p={key:7,class:"flex flex-col items-center justify-center py-20 sm:py-28 text-center px-4"},kp={class:"w-full flex justify-end px-3 pb-4"},wp={class:"p-4 bg-gray-100 rounded-2xl mb-4"},$p={key:1,class:"px-2 sm:px-0"},Cp={class:"sm:hidden fixed bottom-0 left-0 right-0 z-50 bg-white/96 backdrop-blur-xl border-t border-gray-200 pb-[env(safe-area-inset-bottom,0px)] shadow-[0_-4px_32px_rgba(0,0,0,0.10)]",style:{"will-change":"transform"}},Sp={class:"flex border-b border-gray-100"},Dp=["onClick"],Pp={key:0,class:"flex overflow-x-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden overscroll-x-contain"},Fp=["onClick"],Tp={key:0,class:"absolute top-0 left-1/2 -translate-x-1/2 w-6 h-[2px] bg-gray-900 rounded-b-full"},Np={class:"leading-tight text-center whitespace-nowrap"},Ip={key:1,class:"flex items-center justify-center py-2 px-4"},Mp=Ne({__name:"SellerHomeComponent",props:{filters:{}},emits:["dialog-open"],setup(m,{emit:B}){const T=m,H=Vt("showToast"),L=B,P=U("dashboard"),k=[{key:"dashboard",label:"Dashboard",icon:Jt},{key:"customers",label:"My Customers",icon:St}],d=U(null),x=[{key:"quotation",label:"Quotation",shortLabel:"Quote",icon:kt},{key:"salesorder",label:"Sales Order",shortLabel:"SO",icon:at},{key:"delivery",label:"Delivery Note",shortLabel:"Delivery",icon:Oe},{key:"invoice",label:"Sales Invoice",shortLabel:"Invoice",icon:Ie},{key:"payment",label:"Payment",shortLabel:"Payment",icon:Je},{key:"customer_ledger",label:"Customer Ledger",shortLabel:"Ledger",icon:wt}],N=V(()=>d.value?x.find(M=>M.key===d.value):null),g=V(()=>!!T.filters.customer),v=U("all"),A=U(""),ae=U(""),J=V(()=>A.value!==""||ae.value!=="");function W(){A.value="",ae.value=""}const b=U(!1),I=U(!1),S=U(""),oe=U(""),ye=U(null),z=U(null);je([b,I],([M,h])=>{L("dialog-open",M||h)});const E=Ke({doctype:"Sales Order",fields:["name","customer","customer_name","status","grand_total","currency","docstatus","per_delivered","per_billed","transaction_date","custom_subscription_refereance"],filters:{},orderBy:"transaction_date desc",pageLength:200,auto:!0}),X=ge({url:"frappe.client.get",makeParams:M=>({doctype:"Sales Order",name:M.name}),onSuccess(M){z.value=M}}),Z=ge({url:"my_frappe_app.api.process_order_workflow",auto:!1}),te=ge({url:"my_frappe_app.api.get_seller_subscriptions"}),Se=ge({url:"my_frappe_app.api.process_subscription",onSuccess(M){oe.value="",M.status==="success"?(H(M.message,"success"),te.fetch({seller:fe.value})):H(M.message||"Operation failed","error")},onError(M){oe.value="",H((M==null?void 0:M.message)||"Error","error")}}),fe=V(()=>T.filters.seller||""),be=V(()=>T.filters.customer||""),O=V(()=>{const M=(T.filters.category||"").toLowerCase();return M.includes("newspaper")||M.includes("news paper")}),f=V(()=>{var h;return!be.value||!O.value?[]:(((h=te.data)==null?void 0:h.subscriptions)||[]).filter(w=>w.customer===be.value||w.customer_name===be.value)}),$=V(()=>{const M=E.data||[];return J.value?M.filter(h=>{const w=h.transaction_date||"";return!(A.value&&w<A.value||ae.value&&w>ae.value)}):M}),ce=V(()=>{const M=[],h=O.value&&!!be.value;if(h&&(v.value==="all"||v.value==="subscription_pending"))for(const w of f.value)v.value==="subscription_pending"&&w.status!=="Accept Pending"||M.push(Ae({row_type:"subscription"},w));if(v.value!=="subscription_pending")for(const w of $.value){const _e=!!w.custom_subscription_refereance;_e&&!h||v.value==="daily"&&!_e||v.value==="normal"&&_e||M.push(Ae({row_type:"order"},w))}return M}),ee=V(()=>ce.value.filter(M=>M.row_type==="order").length),ve=V(()=>{const M=f.value,h=E.data||[];return{subPending:M.filter(w=>w.status==="Accept Pending").length,subActive:M.filter(w=>w.status==="Active").length,orderPending:h.filter(w=>Number(w.docstatus)===0&&!w.custom_subscription_refereance).length,toDeliver:h.filter(w=>{var _e;return Number(w.docstatus)===1&&Number((_e=w.per_delivered)!=null?_e:0)<100}).length,completed:h.filter(w=>{var _e;return Number((_e=w.per_delivered)!=null?_e:0)>=100}).length}}),F=V(()=>(E.data||[]).filter(M=>{var h,w;return Number(M.docstatus)===1&&Number((h=M.per_delivered)!=null?h:0)>0&&Number((w=M.per_billed)!=null?w:100)<100})),c=V(()=>d.value==="salesorder"?te.loading||E.loading:!1);je(()=>[T.filters.customer,T.filters.seller],([M,h])=>{M&&(E.update({filters:{customer:M}}),E.reload()),h&&te.fetch({seller:h})},{immediate:!0});function y(M){return["Completed","To Bill","To Deliver"].includes(M)?"green":M==="Draft"?"red":M==="Cancelled"?"gray":"orange"}function n(M,h="INR"){return new Intl.NumberFormat("en-IN",{style:"currency",currency:h}).format(M)}function _(M){z.value=null,b.value=!0,X.fetch({name:M.name})}function G(M,h){return we(this,null,function*(){S.value=M;try{const w=yield Z.submit({order_id:M,action:h});(w==null?void 0:w.status)==="success"?(H(w.message,"success"),yield E.reload(),b.value&&X.fetch({name:M})):H((w==null?void 0:w.message)||"Operation Failed","error")}catch(w){H((w==null?void 0:w.message)||"System Error","error")}finally{S.value=""}})}function re(M,h){oe.value=M,Se.fetch({sub_name:M,action:h})}function ie(M){ye.value=ye.value===M?null:M}function xe(){d.value=null,te.fetch({seller:fe.value}),E.reload()}function ke(M){H(`Invoice ${M} created successfully!`,"success"),E.reload()}function ne(){}return(M,h)=>(t(),s(q,null,[e("div",Mx,[e("div",Lx,[e("div",Ux,[(t(),s(q,null,Y(k,w=>e("button",{key:w.key,onClick:_e=>P.value=w.key,class:C(["flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-bold transition-all whitespace-nowrap",P.value===w.key?"bg-gray-900 text-white shadow-sm":"text-gray-500 hover:text-gray-700"])},[(t(),D(Ce(w.icon),{class:"w-4 h-4 flex-shrink-0"})),j(" "+a(w.label),1)],10,Ox)),64))]),r(l($e),{variant:"outline",size:"sm",loading:l(te).loading||l(E).loading,class:"text-sm",onClick:xe},{prefix:Q(()=>[r(l(ue),{class:"w-4 h-4"})]),default:Q(()=>[h[10]||(h[10]=j(" Refresh ",-1))]),_:1},8,["loading"])]),P.value==="dashboard"?(t(),s(q,{key:0},[e("div",qx,[r(ms,{stats:ve.value,"active-filter":v.value,"onUpdate:activeFilter":h[0]||(h[0]=w=>v.value=w)},null,8,["stats","active-filter"])]),e("div",Ex,[g.value?(t(),s(q,{key:1},[e("div",Bx,[e("div",Hx,[(t(),s(q,null,Y(x,w=>e("button",{key:w.key,onClick:_e=>d.value=w.key,class:C(["relative flex items-center gap-2 px-5 md:px-7 py-3.5 text-sm font-bold transition-all whitespace-nowrap",d.value===w.key?"text-gray-900 bg-gray-50/80":"text-gray-400 hover:text-gray-600 hover:bg-gray-50/40"])},[d.value===w.key?(t(),s("span",Yx)):p("",!0),(t(),D(Ce(w.icon),{class:"w-4 h-4 flex-shrink-0"})),j(" "+a(w.label),1)],10,Wx)),64))])]),N.value?(t(),s("div",Gx,[(t(),D(Ce(N.value.icon),{class:"w-4 h-4 text-gray-700 flex-shrink-0"})),e("span",Qx,a(N.value.label),1)])):p("",!0),d.value===null?(t(),s("div",Jx,[e("div",Xx,[r(l(at),{class:"w-10 h-10 text-gray-300"})]),h[13]||(h[13]=e("p",{class:"text-sm font-black text-gray-400"},"Select a Tab",-1)),h[14]||(h[14]=e("p",{class:"text-xs text-gray-300 mt-1.5"},"Choose a section above to get started.",-1))])):d.value==="quotation"?(t(),s("div",Kx,[e("div",Zx,[e("button",{onClick:xe,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[r(l(ue),{class:"w-3.5 h-3.5"}),h[15]||(h[15]=j(" Refresh ",-1))])]),e("div",ep,[r(l(kt),{class:"w-10 h-10 text-gray-300"})]),h[16]||(h[16]=e("p",{class:"text-base font-black text-gray-300"},"Quotation",-1)),h[17]||(h[17]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):d.value==="salesorder"?(t(),s(q,{key:3},[e("div",tp,[e("div",sp,[e("div",ap,[e("div",lp,[r(l(at),{class:"w-4 h-4 sm:w-5 sm:h-5"})]),e("div",np,[h[18]||(h[18]=e("h2",{class:"text-sm sm:text-base font-black tracking-tight leading-tight"},"Sales Orders",-1)),e("div",op,[e("span",rp,[v.value==="all"?(t(),s("span",ip,"All â€” Subscriptions & Orders")):v.value==="subscription_pending"?(t(),s("span",dp,"Subscription Requests")):v.value==="daily"?(t(),s("span",cp,"Daily Auto-Orders")):v.value==="normal"?(t(),s("span",up,"Normal Orders")):p("",!0)])])])]),e("div",xp,[e("button",{onClick:ne,class:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-colors whitespace-nowrap shadow-sm"},[e("span",pp,[r(l(Bt),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})]),h[19]||(h[19]=e("span",{class:"hidden sm:inline"},"Create Sales Order",-1)),h[20]||(h[20]=e("span",{class:"sm:hidden"},"New SO",-1))]),e("button",{onClick:h[1]||(h[1]=w=>F.value.length>0?I.value=!0:void 0),disabled:F.value.length===0,class:C(["flex items-center gap-1.5 sm:gap-2 font-bold px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm transition-all whitespace-nowrap shadow-sm",F.value.length>0?"bg-green-600 hover:bg-green-700 active:bg-green-800 text-white cursor-pointer":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"]),title:F.value.length===0?"No eligible orders to invoice":`${F.value.length} orders eligible`},[e("span",{class:C(["flex items-center justify-center w-5 h-5 rounded-md flex-shrink-0",F.value.length>0?"bg-white/20":"bg-gray-300/50"])},[r(l(Ie),{class:"w-3 h-3 sm:w-3.5 sm:h-3.5"})],2),h[21]||(h[21]=e("span",{class:"hidden sm:inline"},"Create Invoice",-1)),h[22]||(h[22]=e("span",{class:"sm:hidden"},"Invoice",-1)),e("span",{class:C(["text-[10px] font-black px-1.5 py-0.5 rounded-full leading-none",F.value.length>0?"bg-white/25 text-white":"bg-gray-300 text-gray-500"])},a(F.value.length),3)],10,mp),v.value!=="all"?(t(),s("button",{key:0,onClick:h[2]||(h[2]=w=>v.value="all"),class:"flex items-center gap-1 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-gray-600 text-xs font-semibold px-2.5 py-2 rounded-lg transition-all whitespace-nowrap"},[r(l(he),{class:"w-3.5 h-3.5 flex-shrink-0"}),h[23]||(h[23]=j(" Clear ",-1))])):p("",!0),e("button",{onClick:xe,class:C(["flex items-center gap-1.5 px-2.5 sm:px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-xs font-semibold text-gray-600 transition-all",c.value?"opacity-60 pointer-events-none":""])},[r(l(ue),{class:C(["w-3.5 h-3.5 flex-shrink-0",c.value?"animate-spin":""])},null,8,["class"]),h[24]||(h[24]=e("span",{class:"hidden sm:inline"},"Refresh",-1))],2)])]),e("div",gp,[e("div",yp,[h[25]||(h[25]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"From",-1)),pe(e("input",{type:"date","onUpdate:modelValue":h[3]||(h[3]=w=>A.value=w),max:ae.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,bp),[[me,A.value]]),A.value?(t(),s("button",{key:0,onClick:h[4]||(h[4]=le(w=>A.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),e("div",fp,[h[26]||(h[26]=e("span",{class:"text-[9px] sm:text-[10px] font-bold text-gray-400 uppercase tracking-wide whitespace-nowrap select-none"},"To",-1)),pe(e("input",{type:"date","onUpdate:modelValue":h[5]||(h[5]=w=>ae.value=w),min:A.value||void 0,class:"text-[10px] sm:text-xs font-semibold text-gray-700 bg-transparent outline-none border-none w-[108px] sm:w-[122px] cursor-pointer"},null,8,vp),[[me,ae.value]]),ae.value?(t(),s("button",{key:0,onClick:h[6]||(h[6]=le(w=>ae.value="",["prevent"])),class:"text-gray-300 hover:text-red-400 transition-colors flex-shrink-0 ml-0.5"},[r(l(he),{class:"w-3 h-3"})])):p("",!0)]),J.value?(t(),s("button",{key:0,onClick:W,class:"flex items-center gap-1 text-[10px] font-bold text-red-500 bg-red-50 border border-red-100 px-2 py-1.5 rounded-lg hover:bg-red-100 transition-all whitespace-nowrap"},[r(l(he),{class:"w-3 h-3"}),h[27]||(h[27]=j(" Clear Dates ",-1))])):p("",!0),J.value?(t(),s("span",hp,a(ee.value)+" orders ",1)):p("",!0)])]),r(ea,{"combined-rows":ce.value,loading:l(te).loading||l(E).loading,"active-filter":v.value,"expanded-sub-id":ye.value,"processing-sub-id":oe.value,"processing-id":S.value,"format-currency":n,"get-status-theme":y,onToggleSubExpand:ie,onSubAction:re,onOpenOrderDetail:_,onOrderAction:G,onShowAll:h[7]||(h[7]=w=>v.value="all")},null,8,["combined-rows","loading","active-filter","expanded-sub-id","processing-sub-id","processing-id"])],64)):d.value==="delivery"?(t(),D(Li,{key:4,customer:be.value,seller:fe.value,"format-currency":n},null,8,["customer","seller"])):d.value==="invoice"?(t(),D(au,{key:5,customer:be.value,seller:fe.value,"format-currency":n},null,8,["customer","seller"])):d.value==="payment"?(t(),D(Ax,{key:6,customer:be.value,seller:fe.value,"format-currency":n},null,8,["customer","seller"])):d.value==="customer_ledger"?(t(),s("div",_p,[e("div",kp,[e("button",{onClick:xe,class:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-xs font-semibold text-gray-500 transition-all"},[r(l(ue),{class:"w-3.5 h-3.5"}),h[28]||(h[28]=j(" Refresh ",-1))])]),e("div",wp,[r(l(wt),{class:"w-10 h-10 text-gray-300"})]),h[29]||(h[29]=e("p",{class:"text-base font-black text-gray-300"},"Customer Ledger",-1)),h[30]||(h[30]=e("p",{class:"text-xs text-gray-300 mt-1"},"Coming soon",-1))])):p("",!0)],64)):(t(),s("div",Vx,[e("div",zx,[r(l(es),{class:"w-10 h-10 text-gray-300"})]),h[11]||(h[11]=e("p",{class:"text-sm font-black text-gray-400"},"No Customer Selected",-1)),h[12]||(h[12]=e("p",{class:"text-xs text-gray-300 mt-1.5 max-w-xs leading-relaxed"}," Select a customer from the sidebar to view their selling cycle â€” quotations, orders, deliveries, invoices and more. ",-1))]))])],64)):p("",!0),P.value==="customers"?(t(),s("div",$p,[r(Vl,{seller:fe.value},null,8,["seller"])])):p("",!0),r(Ta,{modelValue:b.value,"onUpdate:modelValue":h[8]||(h[8]=w=>b.value=w),"order-details":z.value,"processing-id":S.value,"format-currency":n,"get-status-theme":y,onOrderAction:G},null,8,["modelValue","order-details","processing-id"]),r(To,{modelValue:I.value,"onUpdate:modelValue":h[9]||(h[9]=w=>I.value=w),"eligible-orders":F.value,seller:fe.value,"format-currency":n,onInvoiceCreated:ke},null,8,["modelValue","eligible-orders","seller"])]),e("nav",Cp,[e("div",Sp,[(t(),s(q,null,Y(k,w=>e("button",{key:w.key,onClick:_e=>P.value=w.key,class:C(["flex-1 flex flex-col items-center justify-center gap-0.5 py-2 px-1 text-[10px] font-bold transition-all active:scale-95",P.value===w.key?"text-gray-900":"text-gray-400"])},[e("div",{class:C(["p-1.5 rounded-xl transition-all",P.value===w.key?"bg-gray-900 text-white":"text-gray-400"])},[(t(),D(Ce(w.icon),{class:"w-4 h-4"}))],2),j(" "+a(w.label),1)],10,Dp)),64))]),P.value==="dashboard"&&g.value?(t(),s("div",Pp,[(t(),s(q,null,Y(x,w=>e("button",{key:w.key,onClick:_e=>d.value=w.key,class:C(["relative flex-shrink-0 flex flex-col items-center justify-center gap-0.5","px-3 py-2 min-w-[58px] text-[9px] font-bold transition-all active:scale-95",d.value===w.key?"text-gray-900":"text-gray-400"])},[d.value===w.key?(t(),s("span",Tp)):p("",!0),(t(),D(Ce(w.icon),{class:C(["w-[18px] h-[18px] transition-all",d.value===w.key?"text-gray-900":"text-gray-400"])},null,8,["class"])),e("span",Np,a(w.shortLabel),1)],10,Fp)),64))])):P.value==="dashboard"&&!g.value?(t(),s("div",Ip,[...h[31]||(h[31]=[e("p",{class:"text-[9px] text-gray-300 font-medium"},"Select a customer to view selling cycle",-1)])])):p("",!0)])],64))}});export{Mp as default};
